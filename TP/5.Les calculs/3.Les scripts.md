# Atelier 4 CORRIGÃ‰ : Scripts et SCOPE



> UTILISATION CORRECTE

**Les SCOPE s'utilisent :**

1. **MDX dans SSMS** (requÃªtes complexes)
2. **Excel** (glisser-dÃ©poser aprÃ¨s connexion)
3. **Power BI** (import depuis SSAS)

**PAS dans le Browser SSAS/SSDT !**

---

## Partie 3 : Script 1 - Remises par Volume

### ImplÃ©mentation (Identique)

```mdx
/* ================================================================
   SCRIPT 1 : REMISES AUTOMATIQUES PAR VOLUME
================================================================ */

CREATE MEMBER CURRENTCUBE.[Measures].[Prix Unitaire RemisÃ©]
AS [Measures].[Prix Unitaire],
FORMAT_STRING = "Currency",
VISIBLE = 1,
DISPLAY_FOLDER = "Tarification";

-- Scope quantitÃ©s 100-499 (-5%)
SCOPE(
    [Measures].[Prix Unitaire RemisÃ©],
    {[Measures].[Quantite] >= 100 AND [Measures].[Quantite] < 500}
);
    THIS = [Measures].[Prix Unitaire] * 0.95;
END SCOPE;

-- Scope quantitÃ©s 500-999 (-10%)
SCOPE(
    [Measures].[Prix Unitaire RemisÃ©],
    {[Measures].[Quantite] >= 500 AND [Measures].[Quantite] < 1000}
);
    THIS = [Measures].[Prix Unitaire] * 0.90;
END SCOPE;

-- Scope quantitÃ©s 1000+ (-15%)
SCOPE(
    [Measures].[Prix Unitaire RemisÃ©],
    {[Measures].[Quantite] >= 1000}
);
    THIS = [Measures].[Prix Unitaire] * 0.85;
END SCOPE;

CREATE MEMBER CURRENTCUBE.[Measures].[CA Remise Volume]
AS [Measures].[Prix Unitaire RemisÃ©] * [Measures].[Quantite],
FORMAT_STRING = "Currency",
VISIBLE = 1,
DISPLAY_FOLDER = "Tarification";
```

### âœ… Test CORRECT Option 1 : MDX dans SSMS

```
1. Deploy + Process Full
2. SSMS > Connexion Analysis Services
3. New Query > MDX
4. Copier requÃªte:
```

```mdx
-- Test Remises Volume
SELECT 
  {
    [Measures].[Quantite],
    [Measures].[Prix Unitaire],
    [Measures].[Prix Unitaire RemisÃ©],
    [Measures].[CA Remise Volume]
  } ON COLUMNS,

  TOPCOUNT(
    [Dim Produit].[Nom Produit].[Nom Produit].MEMBERS,
    20,
    [Measures].[Quantite]
  ) ON ROWS

FROM [Cube_Ventes]
WHERE [Dim Temps].[Calendrier].[Annee].&[2024]
```

```
5. Execute (F5)
6. Observer : Prix remisÃ© selon quantitÃ©
```

### âœ… Test CORRECT : Excel

```
1. Excel > DonnÃ©es > Ã€ partir d'Analysis Services
2. Serveur: localhost
3. Base: Cube_Ventes
4. CrÃ©er Tableau CroisÃ© Dynamique

Configuration TCD:
LIGNES:
â””â”€ [Dim Produit].[Nom Produit]

VALEURS:
â””â”€ [Quantite]
â””â”€ [Prix Unitaire]
â””â”€ [Prix Unitaire RemisÃ©]  â† Glisser depuis "Tarification"
â””â”€ [CA Remise Volume]

FILTRES:
â””â”€ [Annee] = 2024
```

**RÃ©sultat Excel :**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Produit       â”‚ QuantitÃ© â”‚ Prix Unit  â”‚ Prix RemisÃ©  â”‚ CA RemisÃ©   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Laptop Pro    â”‚ 850      â”‚ 899.00     â”‚ 809.10 (-10%)â”‚ 687,735     â”‚
â”‚ Smartphone X1 â”‚ 1,250    â”‚ 599.00     â”‚ 509.15 (-15%)â”‚ 636,438     â”‚
â”‚ TV LED 50"    â”‚ 450      â”‚ 699.00     â”‚ 664.05 (-5%) â”‚ 298,823     â”‚
â”‚ Tablette 10"  â”‚ 280      â”‚ 399.00     â”‚ 379.05 (-5%) â”‚ 106,134     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Le SCOPE fonctionne : Prix baisse selon quantitÃ©!
```

### Analyse RentabilitÃ© par Volume (Excel)

```
CrÃ©er 2e Tableau dans Excel:

LIGNES:
â””â”€ Grouper QuantitÃ© par tranches:
   â”œâ”€ 0-99
   â”œâ”€ 100-499  (-5%)
   â”œâ”€ 500-999  (-10%)
   â””â”€ 1000+    (-15%)

VALEURS:
â””â”€ Somme [Quantite]
â””â”€ Somme [CA Remise Volume]
â””â”€ Moy [Prix Unitaire RemisÃ©]

Graphique: Barres empilÃ©es pour voir impact
```

---

## Partie 4 : Script 2 - Allocation BudgÃ©taire

### ImplÃ©mentation (Identique)

```mdx
/* ================================================================
   SCRIPT 2 : ALLOCATION BUDGETAIRE PAR RÃ‰GION
================================================================ */

CREATE MEMBER CURRENTCUBE.[Measures].[Budget AllouÃ©]
AS NULL,
FORMAT_STRING = "Currency",
VISIBLE = 1,
DISPLAY_FOLDER = "Budget et Objectifs";

-- Budget 2025 = CA 2024 * 1.12
SCOPE(
    [Measures].[Budget AllouÃ©],
    [Dim Temps].[Calendrier].[Annee].&[2025]
);
    THIS = (
        [Measures].[Chiffre d'Affaires],
        [Dim Temps].[Calendrier].[Annee].&[2024]
    ) * 1.12;
END SCOPE;

-- Allocation par rÃ©gion
SCOPE(
    [Measures].[Budget AllouÃ©],
    [Dim Temps].[Calendrier].[Annee].&[2025],
    [Dim Client].[GÃ©ographie].[Region].MEMBERS
);
    THIS = (
        [Measures].[Chiffre d'Affaires],
        [Dim Client].[GÃ©ographie].[Region].CURRENTMEMBER,
        [Dim Temps].[Calendrier].[Annee].&[2024]
    ) * 1.12;
END SCOPE;

CREATE MEMBER CURRENTCUBE.[Measures].[Taux RÃ©alisation Budget]
AS 
    IIF(
        [Measures].[Budget AllouÃ©] = 0,
        NULL,
        [Measures].[Chiffre d'Affaires] / [Measures].[Budget AllouÃ©]
    ),
FORMAT_STRING = "Percent",
VISIBLE = 1,
DISPLAY_FOLDER = "Budget et Objectifs";
```

### âœ… Test CORRECT : MDX

```mdx
-- Test Budget par RÃ©gion
SELECT 
  {
    [Measures].[Chiffre d'Affaires],
    [Measures].[Budget AllouÃ©],
    [Measures].[Taux RÃ©alisation Budget]
  } ON COLUMNS,

  [Dim Client].[GÃ©ographie].[Region].MEMBERS ON ROWS

FROM [Cube_Ventes]
WHERE [Dim Temps].[Calendrier].[Annee].&[2025]
```

### âœ… Test CORRECT : Excel Dashboard

```
Excel Tableau 1: Vue Executive 2024 vs Budget 2025

LIGNES:
â””â”€ [GÃ©ographie].[Region]

COLONNES:
â””â”€ [Annee] = 2024, 2025

VALEURS:
â””â”€ [Chiffre d'Affaires]
â””â”€ [Budget AllouÃ©] (vide en 2024, calculÃ© en 2025)

RÃ©sultat:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RÃ©gion           â”‚ CA 2024    â”‚ Budget 2025â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ãle-de-France    â”‚ 8,500,000  â”‚ 9,520,000  â”‚
â”‚ RhÃ´ne-Alpes      â”‚ 6,200,000  â”‚ 6,944,000  â”‚
â”‚ PACA             â”‚ 5,100,000  â”‚ 5,712,000  â”‚
â”‚ Nouvelle-Aquitainâ”‚ 4,800,000  â”‚ 5,376,000  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Budget = CA 2024 Ã— 1.12
```

```
Excel Tableau 2: Suivi RÃ©alisation (pour 2025 quand donnÃ©es rÃ©elles)

LIGNES:
â””â”€ [GÃ©ographie].[Region]

VALEURS:
â””â”€ [Chiffre d'Affaires] (rÃ©el 2025)
â””â”€ [Budget AllouÃ©]
â””â”€ [Taux RÃ©alisation Budget]
â””â”€ Ã‰cart = CA - Budget (formule Excel)

Mise en forme conditionnelle:
- Vert: Taux â‰¥ 100%
- Jaune: 95-100%
- Rouge: < 95%
```

---

## Partie 5 : Script 3 - Commissions par Canal

### ImplÃ©mentation (Identique)

```mdx
/* ================================================================
   SCRIPT 3 : COMMISSIONS PAR CANAL
================================================================ */

CREATE MEMBER CURRENTCUBE.[Measures].[Commission]
AS 0,
FORMAT_STRING = "Currency",
VISIBLE = 1,
DISPLAY_FOLDER = "Commissions";

-- Site Web: 2%
SCOPE(
    [Measures].[Commission],
    [Dim Canal].[Nom Canal].&[Site Web]
);
    THIS = [Measures].[Chiffre d'Affaires] * 0.02;
END SCOPE;

-- App Mobile: 2%
SCOPE(
    [Measures].[Commission],
    [Dim Canal].[Nom Canal].&[Application Mobile]
);
    THIS = [Measures].[Chiffre d'Affaires] * 0.02;
END SCOPE;

-- Amazon: 15%
SCOPE(
    [Measures].[Commission],
    [Dim Canal].[Nom Canal].&[Amazon Marketplace]
);
    THIS = [Measures].[Chiffre d'Affaires] * 0.15;
END SCOPE;

-- eBay: 12%
SCOPE(
    [Measures].[Commission],
    [Dim Canal].[Nom Canal].&[eBay]
);
    THIS = [Measures].[Chiffre d'Affaires] * 0.12;
END SCOPE;

-- Magasin: 0%
SCOPE(
    [Measures].[Commission],
    [Dim Canal].[Nom Canal].&[Magasin Physique]
);
    THIS = 0;
END SCOPE;

CREATE MEMBER CURRENTCUBE.[Measures].[Marge Nette AprÃ¨s Commission]
AS 
    [Measures].[Marge Commerciale] - [Measures].[Commission],
FORMAT_STRING = "Currency",
VISIBLE = 1,
DISPLAY_FOLDER = "Commissions";

CREATE MEMBER CURRENTCUBE.[Measures].[Taux Marge Nette]
AS 
    IIF(
        [Measures].[Chiffre d'Affaires] = 0,
        NULL,
        [Measures].[Marge Nette AprÃ¨s Commission] / [Measures].[Chiffre d'Affaires]
    ),
FORMAT_STRING = "Percent",
VISIBLE = 1,
DISPLAY_FOLDER = "Commissions";
```

### âœ… Test CORRECT : MDX

```mdx
-- Analyse RentabilitÃ© par Canal
SELECT 
  {
    [Measures].[Chiffre d'Affaires],
    [Measures].[Commission],
    [Measures].[Marge Commerciale],
    [Measures].[Marge Nette AprÃ¨s Commission],
    [Measures].[Taux Marge Nette]
  } ON COLUMNS,

  [Dim Canal].[Type de Canal].[Type de Canal].MEMBERS ON ROWS

FROM [Cube_Ventes]
WHERE [Dim Temps].[Calendrier].[Annee].&[2024]
```

### âœ… Test CORRECT : Excel Analyse RentabilitÃ©

```
Excel Tableau: Comparaison Canaux

LIGNES:
â””â”€ [Type de Canal] > [Nom Canal] (hiÃ©rarchie Ã©tendue)

VALEURS:
â””â”€ [Chiffre d'Affaires]
â””â”€ [Commission]
â””â”€ [Marge Commerciale]
â””â”€ [Marge Nette AprÃ¨s Commission]
â””â”€ [Taux Marge Nette]

FILTRE:
â””â”€ [Annee] = 2024

RÃ©sultat:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Canal            â”‚ CA        â”‚ Commissio â”‚ Marge    â”‚ Marge Netteâ”‚ Taux Net â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Online           â”‚           â”‚           â”‚          â”‚            â”‚          â”‚
â”‚  â””â”€ Site Web     â”‚ 5,200,000 â”‚ 104,000   â”‚2,340,000 â”‚ 2,236,000  â”‚ 43.0%    â”‚
â”‚  â””â”€ App Mobile   â”‚ 3,800,000 â”‚  76,000   â”‚1,710,000 â”‚ 1,634,000  â”‚ 43.0%    â”‚
â”‚ Marketplace      â”‚           â”‚           â”‚          â”‚            â”‚          â”‚
â”‚  â””â”€ Amazon       â”‚ 4,500,000 â”‚ 675,000   â”‚2,025,000 â”‚ 1,350,000  â”‚ 30.0%    â”‚
â”‚  â””â”€ eBay         â”‚ 2,100,000 â”‚ 252,000   â”‚  945,000 â”‚   693,000  â”‚ 33.0%    â”‚
â”‚ Physique         â”‚           â”‚           â”‚          â”‚            â”‚          â”‚
â”‚  â””â”€ Magasin      â”‚ 3,200,000 â”‚     0     â”‚1,440,000 â”‚ 1,440,000  â”‚ 45.0%    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Le SCOPE applique bien les taux par canal!

Insights:
- Magasin Physique: Meilleure marge nette (45%, pas de commission)
- Amazon: Marge sacrifiÃ©e (30%) pour volume
- Canaux propriÃ©taires (Web/App): Bon Ã©quilibre (43%)
```

### Graphique Excel : Waterfall des Marges

```
CrÃ©er graphique Cascade (Waterfall):
1. Marge Brute (dÃ©part)
2. - Commission Amazon
3. - Commission eBay
4. - Commission Web/App
5. = Marge Nette (arrivÃ©e)

Montre visuellement l'impact des commissions
```

---

## Partie 6: Script 4 - PrÃ©visions

### ImplÃ©mentation (Identique)

```mdx
/* ================================================================
   SCRIPT 4 : PRÃ‰VISIONS AUTOMATIQUES 2025
================================================================ */

CREATE MEMBER CURRENTCUBE.[Measures].[PrÃ©vision CA]
AS NULL,
FORMAT_STRING = "Currency",
VISIBLE = 1,
DISPLAY_FOLDER = "PrÃ©visions";

-- PrÃ©visions mensuelles 2025
SCOPE(
    [Measures].[PrÃ©vision CA],
    [Dim Temps].[Calendrier].[Annee].&[2025],
    DESCENDANTS([Dim Temps].[Calendrier].[Annee].&[2025], [Dim Temps].[Calendrier].[Mois Nom])
);
    THIS = (
        (
            ([Measures].[Chiffre d'Affaires], 
             PARALLELPERIOD([Dim Temps].[Calendrier].[Annee], 1, [Dim Temps].[Calendrier].CURRENTMEMBER))
            +
            ([Measures].[Chiffre d'Affaires], 
             PARALLELPERIOD([Dim Temps].[Calendrier].[Annee], 2, [Dim Temps].[Calendrier].CURRENTMEMBER))
        ) / 2
    ) * 1.08; -- +8% croissance
END SCOPE;

CREATE MEMBER CURRENTCUBE.[Measures].[Ã‰cart PrÃ©vision]
AS 
    [Measures].[Chiffre d'Affaires] - [Measures].[PrÃ©vision CA],
FORMAT_STRING = "Currency",
VISIBLE = 1,
DISPLAY_FOLDER = "PrÃ©visions";

CREATE MEMBER CURRENTCUBE.[Measures].[PrÃ©cision PrÃ©vision %]
AS 
    IIF(
        [Measures].[PrÃ©vision CA] = 0,
        NULL,
        1 - (ABS([Measures].[Ã‰cart PrÃ©vision]) / [Measures].[PrÃ©vision CA])
    ),
FORMAT_STRING = "Percent",
VISIBLE = 1,
DISPLAY_FOLDER = "PrÃ©visions";
```

### âœ… Test CORRECT : MDX PrÃ©visions 2025

```mdx
-- PrÃ©visions par mois 2025
SELECT 
  {
    [Measures].[PrÃ©vision CA],
    [Measures].[Chiffre d'Affaires] -- Vide pour 2025 (pas encore de donnÃ©es)
  } ON COLUMNS,

  DESCENDANTS(
    [Dim Temps].[Calendrier].[Annee].&[2025],
    [Dim Temps].[Calendrier].[Mois Nom]
  ) ON ROWS

FROM [Cube_Ventes]
```

### âœ… Test CORRECT : Excel Dashboard PrÃ©visions

```
Excel Tableau 1: PrÃ©visions Mensuelles 2025

LIGNES:
â””â”€ [Calendrier].[Mois Nom] (filtrÃ© sur 2025)

VALEURS:
â””â”€ [PrÃ©vision CA]

COLONNES:
â””â”€ [CatÃ©gorie Produit]

Graphique: Courbes par catÃ©gorie avec prÃ©visions
```

```
Excel Tableau 2: Historique vs PrÃ©visions

LIGNES:
â””â”€ [Calendrier].[Mois Nom]

COLONNES:
â””â”€ [Annee] = 2023, 2024, 2025

VALEURS:
â””â”€ [Chiffre d'Affaires] (2023-2024: rÃ©el)
â””â”€ [PrÃ©vision CA] (2025: calculÃ© par SCOPE)

RÃ©sultat:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mois      â”‚ CA 2023   â”‚ CA 2024   â”‚ PrÃ©v 2025 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Janvier   â”‚ 950,000   â”‚ 1,080,000 â”‚ 1,100,540 â”‚
â”‚ FÃ©vrier   â”‚ 920,000   â”‚ 1,050,000 â”‚ 1,065,600 â”‚
â”‚ Mars      â”‚ 1,100,000 â”‚ 1,200,000 â”‚ 1,242,000 â”‚
â”‚ ...       â”‚ ...       â”‚ ...       â”‚ ...       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Formule PrÃ©vision:
= ((CA 2024 + CA 2023) / 2) Ã— 1.08
```

```
Excel Tableau 3: PrÃ©cision PrÃ©visions (quand 2025 rÃ©el disponible)

LIGNES:
â””â”€ [Calendrier].[Mois Nom] (2024 pour tester modÃ¨le)

VALEURS:
â””â”€ [Chiffre d'Affaires]
â””â”€ [PrÃ©vision CA]
â””â”€ [Ã‰cart PrÃ©vision]
â””â”€ [PrÃ©cision PrÃ©vision %]

Mise en forme:
- Vert: PrÃ©cision â‰¥ 95%
- Jaune: 90-95%
- Rouge: < 90%
```

---

## ğŸ“‹ RÃ‰CAPITULATIF UTILISATION SCOPE

### âŒ NE MARCHE PAS (Browser SSAS/SSDT)

```
Browser > Glisser mesure SCOPE  â† RÃ©sultats incorrects!
```

**Raison :** Le Browser utilise des requÃªtes MDX simplifiÃ©es qui ne respectent pas toujours les SCOPE complexes.

### âœ… MARCHE PARFAITEMENT (SSMS MDX)

```
SSMS > MDX Query > SELECT avec mesure SCOPE  â† CORRECT!
```

### âœ… MARCHE PARFAITEMENT (Excel)

```
Excel > TCD > Glisser mesure SCOPE  â† CORRECT!
```

### âœ… MARCHE (Power BI)

```
Power BI > Connexion SSAS > Visuel avec SCOPE  â† CORRECT!
```

---

## ğŸ“ POUR UN ENTRETIEN

**Question : "Comment teste-t-on un calcul SCOPE ?"**

**âœ… BONNE RÃ‰PONSE :**

```
"AprÃ¨s avoir crÃ©Ã© un SCOPE dans le script MDX:
1. Deploy + Process Full du cube
2. Test dans SSMS avec requÃªte MDX explicite
   - Permet de vÃ©rifier la logique exacte
3. Validation dans Excel via TCD
   - ExpÃ©rience utilisateur final
4. Tests de non-rÃ©gression avec SQL Profiler

Le Browser SSAS n'est PAS adaptÃ© pour tester les SCOPE
car il gÃ©nÃ¨re des requÃªtes simplifiÃ©es qui peuvent
contourner la logique du SCOPE."
```

**âŒ MAUVAISE RÃ‰PONSE :**

```
"On glisse les champs dans le Browser du cube."
â† Ã‰CHEC Ã€ L'ENTRETIEN!
```

---

## ğŸ¯ EXEMPLE COMPLET : Dashboard Excel IntÃ©grÃ©

### Configuration Dashboard Multi-Onglets

**Onglet 1: Vue Executive**

```
Tableau: Indicateurs ClÃ©s 2024-2025
â”œâ”€ CA RÃ©alisÃ© 2024
â”œâ”€ Budget AllouÃ© 2025
â”œâ”€ PrÃ©vision CA 2025
â””â”€ Commissions Totales 2024

Graphiques:
â”œâ”€ Jauge: % RÃ©alisation vs Budget
â”œâ”€ Courbe: Tendance CA + PrÃ©visions
â””â”€ Barres: CA par Canal avec Commissions
```

**Onglet 2: Analyse Produits**

```
Tableau: Prix et Volumes
LIGNES: [Nom Produit]
VALEURS:
â”œâ”€ [Quantite]
â”œâ”€ [Prix Unitaire]
â”œâ”€ [Prix Unitaire RemisÃ©] â† SCOPE
â””â”€ [CA Remise Volume] â† SCOPE

Segment: Par Tranche de QuantitÃ©
Graphique: Scatter Prix vs Volume
```

**Onglet 3: RentabilitÃ© Canaux**

```
Tableau: Marge par Canal
LIGNES: [Type Canal] > [Nom Canal]
VALEURS:
â”œâ”€ [CA]
â”œâ”€ [Commission] â† SCOPE
â”œâ”€ [Marge Commerciale]
â”œâ”€ [Marge Nette AprÃ¨s Commission] â† SCOPE
â””â”€ [Taux Marge Nette] â† SCOPE

Graphique: Waterfall Marges
```

**Onglet 4: PrÃ©visions**

```
Tableau: PrÃ©visions Mensuelles
LIGNES: [Mois Nom] (2025)
VALEURS:
â”œâ”€ [PrÃ©vision CA] â† SCOPE
â””â”€ [Budget AllouÃ©] â† SCOPE

Graphique: Ligne temps avec:
- Historique 2023-2024 (rÃ©el)
- PrÃ©visions 2025 (calculÃ©es)
- Zone d'incertitude Â±10%
```

### Slicers (Filtres Interactifs)

```
ConnectÃ©s Ã  TOUS les tableaux:
â”œâ”€ AnnÃ©e
â”œâ”€ CatÃ©gorie Produit
â”œâ”€ RÃ©gion
â””â”€ Type Canal
```

**Utilisateur final :**

- SÃ©lectionne filtre â†’ Tous tableaux se mettent Ã  jour
- Les SCOPE s'appliquent automatiquement
- Calculs en temps rÃ©el

---

## âœ… CHECKLIST FINALE

```
â˜ Scripts SCOPE crÃ©Ã©s dans SSAS
â˜ Deploy + Process Full rÃ©ussi
â˜ Tests MDX dans SSMS fonctionnels
â˜ Connexion Excel Ã©tablie
â˜ Mesures SCOPE visibles dans champs Excel
â˜ TCD Excel avec SCOPE opÃ©rationnel
â˜ Dashboard multi-onglets crÃ©Ã©
â˜ Graphiques avec SCOPE corrects
â˜ Capable d'expliquer pourquoi Browser inadaptÃ©
â˜ DÃ©monstration Excel prÃªte pour entretien
```

---

## ğŸ“Š DÃ‰MO POUR ENTRETIEN (5 Minutes)

### Script de DÃ©mo Oral

```
"Je vais vous dÃ©montrer l'utilisation de SCOPE dans SSAS.

[Ouvrir SSDT]
1. Voici le script SCOPE pour remises volume (montrer code)
   - 100-499 unitÃ©s: -5%
   - 500-999: -10%
   - 1000+: -15%

[Ouvrir SSMS]
2. Test MDX pour valider le calcul
   [ExÃ©cuter requÃªte, montrer rÃ©sultats]
   âœ“ Les prix sont bien ajustÃ©s selon les paliers

[Ouvrir Excel]
3. Utilisation finale par l'utilisateur mÃ©tier
   [Glisser champs, crÃ©er tableau]
   âœ“ TCD montre remises appliquÃ©es
   âœ“ Graphique visualise l'impact

4. Pourquoi pas le Browser?
   - Browser = outil dÃ©veloppeur
   - RequÃªtes simplifiÃ©es
   - Contexte Excel = production

5. Avantages SCOPE vs Membre CalculÃ©:
   - SCOPE: Modifie cellules existantes
   - Plus flexible pour logique conditionnelle
   - Performance optimisÃ©e

Questions?"
```
