# Atelier 3 CORRIGÃ‰ : Ensembles NommÃ©s (Named Sets

## Partie 3 CORRIGÃ‰E : Named Set 1 - Top 10 Produits

### CrÃ©ation (Identique)

1. **New Named Set**
2. **Name** : `[Top 10 Produits CA]`
3. **Type** : **Dynamic**
4. **Expression MDX** :

```mdx
TOPCOUNT(
    [Dim Produit].[Nom Produit].[Nom Produit].MEMBERS,
    10,
    [Measures].[Chiffre d'Affaires]
)
```

5. **Display Folder** : `Analyses Produits`
6. **Deploy + Process Full**

### âœ… Test CORRECT : RequÃªte MDX dans SSMS

```
1. Ouvrir SSMS
2. Se connecter au serveur Analysis Services
3. New Query > MDX
4. Copier cette requÃªte:
```

```mdx
-- Test Top 10 Produits CA
SELECT 
  {
    [Measures].[Chiffre d'Affaires],
    [Measures].[Quantite],
    [Measures].[Marge Commerciale]
  } ON COLUMNS,

  [Top 10 Produits CA] ON ROWS

FROM [Cube_Ventes]
```

```
5. Execute (F5)
6. RÃ©sultat : 10 produits avec leurs indicateurs
```

### Test Contexte Multiple (Avec WHERE)

```mdx
-- Top 10 pour l'annÃ©e 2023 uniquement
SELECT 
  [Measures].[Chiffre d'Affaires] ON COLUMNS,
  [Top 10 Produits CA] ON ROWS
FROM [Cube_Ventes]
WHERE [Dim Temps].[Calendrier].[Annee].&[2023]
```

### Test Dynamique : Comparaison par Canal

```mdx
-- Top 10 par canal (set dynamique s'adapte)
SELECT 
  [Measures].[Chiffre d'Affaires] ON COLUMNS,
  [Top 10 Produits CA] ON ROWS,
  [Dim Canal].[Type de Canal].[Type de Canal].MEMBERS ON PAGES
FROM [Cube_Ventes]
```

---

## Partie 4 : Named Set 2 - Bottom 5 Produits

### CrÃ©ation (Identique)

```mdx
CREATE SET [Cube_Ventes].[Bottom 5 Produits CA] AS
BOTTOMCOUNT(
    FILTER(
        [Dim Produit].[Nom Produit].[Nom Produit].MEMBERS,
        NOT ISEMPTY([Measures].[Chiffre d'Affaires])
    ),
    5,
    [Measures].[Chiffre d'Affaires]
),
DISPLAY_FOLDER = 'Analyses Produits';
```

### âœ… Test CORRECT : MDX

```mdx
-- Test Bottom 5
SELECT 
  {
    [Measures].[Chiffre d'Affaires],
    [Measures].[Marge Commerciale],
    [Measures].[Taux de Marge]
  } ON COLUMNS,

  [Bottom 5 Produits CA] ON ROWS

FROM [Cube_Ventes]
WHERE [Dim Temps].[Calendrier].[Annee].&[2024]
```

### Analyse Comparative Top vs Bottom

```mdx
-- Comparer Top 10 et Bottom 5
SELECT 
  [Measures].[Chiffre d'Affaires] ON COLUMNS,
  {
    [Top 10 Produits CA],
    [Bottom 5 Produits CA]
  } ON ROWS
FROM [Cube_Ventes]
```

---

## Partie 5  : Named Set 3 - Clients VIP (Statique)

### CrÃ©ation (Identique)

```mdx
CREATE SET [Cube_Ventes].[Clients VIP] AS
FILTER(
    [Dim Client].[Nom Client].[Nom Client].MEMBERS,
    [Measures].[Chiffre d'Affaires] >= 50000
),
DISPLAY_FOLDER = 'Segments Clients';
```

### âœ… Test CORRECT : MDX

```mdx
-- Test Clients VIP
SELECT 
  {
    [Measures].[Chiffre d'Affaires],
    [Measures].[Panier Moyen],
    [Measures].[Nombre de Commandes]
  } ON COLUMNS,

  [Clients VIP] ON ROWS

FROM [Cube_Ventes]
```

### Ã‰volution Clients VIP sur 3 Ans

```mdx
-- Performance VIP par annÃ©e
SELECT 
  [Dim Temps].[Calendrier].[Annee].MEMBERS ON COLUMNS,
  [Clients VIP] ON ROWS
FROM [Cube_Ventes]
WHERE [Measures].[Chiffre d'Affaires]
```

---

## Partie 6 : PÃ©riodes Comparatives

### âœ… Test CORRECT : 6 Derniers Mois

```mdx
-- Analyse sur 6 derniers mois
SELECT 
  {
    [Measures].[Chiffre d'Affaires],
    [Measures].[Croissance vs N-1 %],
    [Measures].[Panier Moyen]
  } ON COLUMNS,

  [6 Derniers Mois] ON ROWS

FROM [Cube_Ventes]
```

### Comparaison Multi-Sets

```mdx
-- Top produits sur 6 derniers mois
SELECT 
  [6 Derniers Mois] ON COLUMNS,
  [Top 10 Produits CA] ON ROWS
FROM [Cube_Ventes]
WHERE [Measures].[Chiffre d'Affaires]
```

---

## Partie 11 : OpÃ©rations sur Sets

### âœ… Test CORRECT : Union de Sets

```mdx
-- Union Top Produits CA et Marge
SELECT 
  {
    [Measures].[Chiffre d'Affaires],
    [Measures].[Marge Commerciale]
  } ON COLUMNS,

  [Top Produits Global] ON ROWS  -- Set qui combine CA et Marge

FROM [Cube_Ventes]
```

### Test Except (Produits Performance Moyenne)

```mdx
-- Produits ni top ni bottom
SELECT 
  [Measures].[Chiffre d'Affaires] ON COLUMNS,
  [Produits Performance Moyenne] ON ROWS
FROM [Cube_Ventes]
WHERE [Dim Temps].[Calendrier].[Annee].&[2024]
```

---

## Partie 12 : Tests Statique vs Dynamique

### Test Performance avec MDX

```mdx
-- Test Set Statique
SELECT 
  [Measures].[Chiffre d'Affaires] ON COLUMNS,
  [Top 10 Static] ON ROWS
FROM [Cube_Ventes]
WHERE [Dim Temps].[Calendrier].[Annee].&[2023]

-- Test Set Dynamique (mÃªme requÃªte)
SELECT 
  [Measures].[Chiffre d'Affaires] ON COLUMNS,
  [Top 10 Dynamic] ON ROWS
FROM [Cube_Ventes]
WHERE [Dim Temps].[Calendrier].[Annee].&[2023]
```

**Activer SQL Server Profiler pour comparer les performances.**

### Test AdaptabilitÃ©

```mdx
-- Statique : Liste ne change PAS
SELECT 
  [Dim Temps].[Calendrier].[Annee].MEMBERS ON COLUMNS,
  [Top 10 Static] ON ROWS
FROM [Cube_Ventes]
WHERE [Measures].[Chiffre d'Affaires]

-- Dynamique : Liste S'ADAPTE par annÃ©e
SELECT 
  [Dim Temps].[Calendrier].[Annee].MEMBERS ON COLUMNS,
  [Top 10 Dynamic] ON ROWS
FROM [Cube_Ventes]
WHERE [Measures].[Chiffre d'Affaires]
```

---

## Partie 13 : Cas d'Usage MÃ©tier

### Cas 1 : Rapport Directeur Commercial

```mdx
-- Vue mensuelle par segment produit
SELECT 
  [6 Derniers Mois] ON COLUMNS,
  {
    [Produits High-Tech],
    [Produits Maison],
    [Mode et Sport]
  } ON ROWS
FROM [Cube_Ventes]
WHERE [Measures].[Chiffre d'Affaires]
```

### Cas 2 : Dashboard E-Commerce

```mdx
-- Suivi ventes online 12 mois
SELECT 
  [12 Derniers Mois] ON COLUMNS,
  [Canaux Online] ON ROWS
FROM [Cube_Ventes]
WHERE [Measures].[Chiffre d'Affaires]
```

### Cas 3 : Analyse Portefeuille Clients

```mdx
-- Segmentation clients stratÃ©giques
SELECT 
  {
    [Measures].[Chiffre d'Affaires],
    [Measures].[Panier Moyen],
    [Measures].[Nombre de Commandes]
  } ON COLUMNS,
  {
    [Clients VIP],
    [Clients Premium],
    [Clients VIP Ã  ReconquÃ©rir]
  } ON ROWS
FROM [Cube_Ventes]
```

### Cas 4 : Optimisation Catalogue

```mdx
-- Analyse complÃ¨te produits
SELECT 
  {
    [Measures].[Chiffre d'Affaires],
    [Measures].[Taux de Marge],
    [Measures].[Croissance vs N-1 %]
  } ON COLUMNS,
  {
    [Top 20% Produits - Pareto],
    [Produits Forte Croissance],
    [Bottom 5 Produits CA],
    [Produits Marge NÃ©gative]
  } ON ROWS
FROM [Cube_Ventes]
WHERE [Dim Temps].[Calendrier].[Annee].&[2024]
```

---

## ğŸ¯ UTILISATION DANS EXCEL (Correcte)

### Connexion au Cube

```
1. Excel > DonnÃ©es > Obtenir des donnÃ©es
2. Ã€ partir d'Analysis Services
3. Serveur: localhost (ou votre serveur)
4. Base: Cube_Ventes
5. CrÃ©er Tableau CroisÃ© Dynamique
```

### âš ï¸ IMPORTANT : Named Sets dans Excel

**Les Named Sets APPARAISSENT dans la liste des champs Excel comme des hiÃ©rarchies !**

```
Champs de Tableau CroisÃ© Dynamique:

ğŸ“ Analyses Produits
   â””â”€ ğŸ“Š Top 10 Produits CA       â† Glissable!
   â””â”€ ğŸ“Š Top 10 Produits Marge
   â””â”€ ğŸ“Š Bottom 5 Produits CA

ğŸ“ Segments Clients
   â””â”€ ğŸ“Š Clients VIP
   â””â”€ ğŸ“Š Clients Premium

ğŸ“ PÃ©riodes
   â””â”€ ğŸ“Š 6 Derniers Mois
   â””â”€ ğŸ“Š 12 Derniers Mois
```

### Configuration Excel TCD

```
LIGNES:
â””â”€ Glisser [Top 10 Produits CA] (depuis Analyses Produits)

VALEURS:
â””â”€ Glisser [Chiffre d'Affaires]
â””â”€ Glisser [Marge Commerciale]

FILTRES:
â””â”€ Glisser [Annee] (pour filtrer une annÃ©e)
```

**RÃ©sultat Excel :**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Produit            â”‚ CA           â”‚ Marge       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Laptop Pro 15"     â”‚ 1,250,000    â”‚ 525,000     â”‚
â”‚ Smartphone X1      â”‚ 980,000      â”‚ 392,000     â”‚
â”‚ TV LED 50"         â”‚ 875,000      â”‚ 306,250     â”‚
â”‚ ...                â”‚ ...          â”‚ ...         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Dashboard Excel Dynamique

```
Tableau 1: Top Produits
â”œâ”€ Lignes: [Top 10 Produits CA]
â”œâ”€ Valeurs: CA, Marge
â””â”€ Graphique: Barres horizontales

Tableau 2: Clients StratÃ©giques
â”œâ”€ Lignes: [Clients VIP]
â”œâ”€ Valeurs: CA, Panier Moyen
â””â”€ Graphique: Tableau avec icÃ´nes

Tableau 3: Tendance Temporelle
â”œâ”€ Colonnes: [12 Derniers Mois]
â”œâ”€ Valeurs: CA
â””â”€ Graphique: Courbe avec tendance

Slicers (filtres visuels):
â”œâ”€ AnnÃ©e
â”œâ”€ CatÃ©gorie Produit
â””â”€ RÃ©gion
```

---

## ğŸ“‹ RÃ‰CAPITULATIF UTILISATION

### âŒ NE MARCHE PAS (Browser SSAS/SSDT)

```
Browser > Glisser Named Set  â† IMPOSSIBLE!
```

### âœ… MARCHE (SSMS MDX)

```
SSMS > MDX Query > Utiliser Named Set  â† CORRECT!
```

### âœ… MARCHE (Excel)

```
Excel > TCD > Glisser Named Set  â† CORRECT!
```

---

## ğŸ“ POUR UN ENTRETIEN

**Question : "Comment utilise-t-on un Named Set ?"**

**âœ… BONNE RÃ‰PONSE :**

```
"Les Named Sets s'utilisent principalement via :
1. RequÃªtes MDX dans SSMS avec SELECT ... FROM
2. Excel via connexion Analysis Services (glisser-dÃ©poser)
3. Power BI via import depuis cube SSAS
4. Applications .NET avec AMO/ADOMD.NET

Ils n'apparaissent PAS dans le Browser SSAS/SSDT,
qui est un outil de dÃ©veloppement, pas de consommation."
```

**âŒ MAUVAISE RÃ‰PONSE :**

```
"On les glisse dans le Browser du cube."
â† Ã‰CHEC IMMÃ‰DIAT Ã€ L'ENTRETIEN!
```

---

## âœ… CHECKLIST FINALE

```
â˜ Named Sets crÃ©Ã©s dans SSAS
â˜ Deploy + Process Full rÃ©ussi
â˜ Tests MDX dans SSMS fonctionnels
â˜ Connexion Excel Ã©tablie
â˜ Named Sets visibles dans champs Excel
â˜ TCD Excel avec Named Sets opÃ©rationnel
â˜ ComprÃ©hension diffÃ©rence Static/Dynamic
â˜ Capable d'expliquer usage correct en entretien
```
