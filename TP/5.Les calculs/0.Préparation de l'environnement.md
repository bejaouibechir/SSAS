# Atelier 1 : Construction du Data Warehouse et Cube SSAS

## Analyse des Ventes E-Commerce

---

## Contexte Métier

Une entreprise de vente en ligne souhaite analyser ses performances commerciales à travers plusieurs dimensions :

- Évolution des ventes dans le temps
- Performance par produit et catégorie
- Analyse géographique des clients
- Comparaison des canaux de vente

---

## Partie 1 : Création du Data Warehouse

### Script SQL - Création de la base de données

```sql
-- =============================================
-- Création de la base Data Warehouse
-- =============================================
USE master;
GO

IF EXISTS (SELECT name FROM sys.databases WHERE name = 'DW_ECommerce')
BEGIN
    ALTER DATABASE DW_ECommerce SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
    DROP DATABASE DW_ECommerce;
END
GO

CREATE DATABASE DW_ECommerce;
GO

USE DW_ECommerce;
GO

-- =============================================
-- DIMENSION TEMPS
-- =============================================
CREATE TABLE DimTemps (
    DateKey INT PRIMARY KEY,
    DateComplete DATE NOT NULL,
    Annee INT NOT NULL,
    Trimestre INT NOT NULL,
    Mois INT NOT NULL,
    MoisNom VARCHAR(20) NOT NULL,
    Semaine INT NOT NULL,
    Jour INT NOT NULL,
    JourSemaine INT NOT NULL,
    JourSemaineNom VARCHAR(20) NOT NULL,
    EstWeekend BIT NOT NULL,
    EstJourFerie BIT NOT NULL
);

-- =============================================
-- DIMENSION PRODUIT
-- =============================================
CREATE TABLE DimProduit (
    ProduitKey INT PRIMARY KEY IDENTITY(1,1),
    ProduitID VARCHAR(20) NOT NULL UNIQUE,
    NomProduit VARCHAR(100) NOT NULL,
    SousCategorie VARCHAR(50) NOT NULL,
    Categorie VARCHAR(50) NOT NULL,
    Marque VARCHAR(50) NOT NULL,
    PrixCatalogue DECIMAL(10,2) NOT NULL,
    Cout DECIMAL(10,2) NOT NULL,
    DateDebut DATE NOT NULL,
    DateFin DATE NULL,
    EstActif BIT NOT NULL DEFAULT 1
);

-- =============================================
-- DIMENSION CLIENT
-- =============================================
CREATE TABLE DimClient (
    ClientKey INT PRIMARY KEY IDENTITY(1,1),
    ClientID VARCHAR(20) NOT NULL UNIQUE,
    NomClient VARCHAR(100) NOT NULL,
    Email VARCHAR(100),
    Telephone VARCHAR(20),
    Ville VARCHAR(50) NOT NULL,
    Region VARCHAR(50) NOT NULL,
    Pays VARCHAR(50) NOT NULL,
    Segment VARCHAR(30) NOT NULL, -- Particulier, Professionnel, Premium
    DateInscription DATE NOT NULL,
    EstActif BIT NOT NULL DEFAULT 1
);

-- =============================================
-- DIMENSION CANAL
-- =============================================
CREATE TABLE DimCanal (
    CanalKey INT PRIMARY KEY IDENTITY(1,1),
    CanalID VARCHAR(20) NOT NULL UNIQUE,
    NomCanal VARCHAR(50) NOT NULL, -- Web, Mobile, Marketplace, Magasin
    TypeCanal VARCHAR(30) NOT NULL, -- Online, Offline
    TauxCommission DECIMAL(5,4) NOT NULL
);

-- =============================================
-- TABLE DE FAITS - VENTES
-- =============================================
CREATE TABLE FactVentes (
    VenteKey BIGINT PRIMARY KEY IDENTITY(1,1),
    DateKey INT NOT NULL,
    ProduitKey INT NOT NULL,
    ClientKey INT NOT NULL,
    CanalKey INT NOT NULL,

    -- Métriques
    Quantite INT NOT NULL,
    PrixUnitaire DECIMAL(10,2) NOT NULL,
    MontantBrut DECIMAL(12,2) NOT NULL,
    TauxRemise DECIMAL(5,4) NOT NULL,
    MontantRemise DECIMAL(10,2) NOT NULL,
    ChiffreAffaires DECIMAL(12,2) NOT NULL,
    CoutTotal DECIMAL(12,2) NOT NULL,

    -- Clés étrangères
    CONSTRAINT FK_Ventes_Temps FOREIGN KEY (DateKey) REFERENCES DimTemps(DateKey),
    CONSTRAINT FK_Ventes_Produit FOREIGN KEY (ProduitKey) REFERENCES DimProduit(ProduitKey),
    CONSTRAINT FK_Ventes_Client FOREIGN KEY (ClientKey) REFERENCES DimClient(ClientKey),
    CONSTRAINT FK_Ventes_Canal FOREIGN KEY (CanalKey) REFERENCES DimCanal(CanalKey)
);

-- Index pour améliorer les performances
CREATE NONCLUSTERED INDEX IX_FactVentes_DateKey ON FactVentes(DateKey);
CREATE NONCLUSTERED INDEX IX_FactVentes_ProduitKey ON FactVentes(ProduitKey);
CREATE NONCLUSTERED INDEX IX_FactVentes_ClientKey ON FactVentes(ClientKey);
CREATE NONCLUSTERED INDEX IX_FactVentes_CanalKey ON FactVentes(CanalKey);
GO
```

### Script de Peuplement - Données de Démonstration

```sql
USE DW_ECommerce;
GO

-- =============================================
-- PEUPLEMENT DIMENSION TEMPS (2022-2024)
-- =============================================
DECLARE @StartDate DATE = '2022-01-01';
DECLARE @EndDate DATE = '2024-12-31';

WHILE @StartDate <= @EndDate
BEGIN
    INSERT INTO DimTemps (
        DateKey, DateComplete, Annee, Trimestre, Mois, MoisNom,
        Semaine, Jour, JourSemaine, JourSemaineNom, EstWeekend, EstJourFerie
    )
    VALUES (
        CAST(FORMAT(@StartDate, 'yyyyMMdd') AS INT),
        @StartDate,
        YEAR(@StartDate),
        DATEPART(QUARTER, @StartDate),
        MONTH(@StartDate),
        DATENAME(MONTH, @StartDate),
        DATEPART(WEEK, @StartDate),
        DAY(@StartDate),
        DATEPART(WEEKDAY, @StartDate),
        DATENAME(WEEKDAY, @StartDate),
        CASE WHEN DATEPART(WEEKDAY, @StartDate) IN (1,7) THEN 1 ELSE 0 END,
        0 -- Simplification: pas de jours fériés
    );

    SET @StartDate = DATEADD(DAY, 1, @StartDate);
END
GO

-- =============================================
-- PEUPLEMENT DIMENSION CANAL
-- =============================================
INSERT INTO DimCanal (CanalID, NomCanal, TypeCanal, TauxCommission)
VALUES 
    ('WEB001', 'Site Web', 'Online', 0.02),
    ('MOB001', 'Application Mobile', 'Online', 0.02),
    ('MKT001', 'Amazon Marketplace', 'Online', 0.15),
    ('MKT002', 'eBay', 'Online', 0.12),
    ('MAG001', 'Magasin Physique', 'Offline', 0.00);
GO

-- =============================================
-- PEUPLEMENT DIMENSION PRODUIT
-- =============================================
-- Catégorie: Électronique
INSERT INTO DimProduit (ProduitID, NomProduit, SousCategorie, Categorie, Marque, PrixCatalogue, Cout, DateDebut, DateFin, EstActif)
VALUES 
    ('ELEC001', 'Smartphone Galaxy S23', 'Smartphones', 'Électronique', 'Samsung', 899.00, 450.00, '2022-01-01', NULL, 1),
    ('ELEC002', 'iPhone 14 Pro', 'Smartphones', 'Électronique', 'Apple', 1299.00, 700.00, '2022-01-01', NULL, 1),
    ('ELEC003', 'Laptop Dell XPS 15', 'Ordinateurs', 'Électronique', 'Dell', 1599.00, 900.00, '2022-01-01', NULL, 1),
    ('ELEC004', 'MacBook Air M2', 'Ordinateurs', 'Électronique', 'Apple', 1399.00, 800.00, '2022-01-01', NULL, 1),
    ('ELEC005', 'Tablette iPad Air', 'Tablettes', 'Électronique', 'Apple', 699.00, 350.00, '2022-01-01', NULL, 1),
    ('ELEC006', 'Écouteurs AirPods Pro', 'Audio', 'Électronique', 'Apple', 279.00, 120.00, '2022-01-01', NULL, 1),
    ('ELEC007', 'Casque Sony WH-1000XM5', 'Audio', 'Électronique', 'Sony', 399.00, 180.00, '2022-01-01', NULL, 1),
    ('ELEC008', 'Smartwatch Apple Watch 8', 'Wearables', 'Électronique', 'Apple', 499.00, 250.00, '2022-01-01', NULL, 1);

-- Catégorie: Maison & Jardin
INSERT INTO DimProduit (ProduitID, NomProduit, SousCategorie, Categorie, Marque, PrixCatalogue, Cout, DateDebut, DateFin, EstActif)
VALUES 
    ('MAIS001', 'Aspirateur Robot Roomba', 'Électroménager', 'Maison & Jardin', 'iRobot', 449.00, 200.00, '2022-01-01', NULL, 1),
    ('MAIS002', 'Cafetière Nespresso', 'Électroménager', 'Maison & Jardin', 'Nespresso', 199.00, 90.00, '2022-01-01', NULL, 1),
    ('MAIS003', 'Canapé 3 Places Nordic', 'Mobilier', 'Maison & Jardin', 'IKEA', 799.00, 350.00, '2022-01-01', NULL, 1),
    ('MAIS004', 'Table à Manger Extensible', 'Mobilier', 'Maison & Jardin', 'IKEA', 399.00, 180.00, '2022-01-01', NULL, 1),
    ('MAIS005', 'Lampe LED Connectée', 'Éclairage', 'Maison & Jardin', 'Philips', 49.00, 20.00, '2022-01-01', NULL, 1);

-- Catégorie: Mode & Vêtements
INSERT INTO DimProduit (ProduitID, NomProduit, SousCategorie, Categorie, Marque, PrixCatalogue, Cout, DateDebut, DateFin, EstActif)
VALUES 
    ('MODE001', 'Jean Slim Bleu', 'Pantalons', 'Mode & Vêtements', 'Levi''s', 89.00, 35.00, '2022-01-01', NULL, 1),
    ('MODE002', 'Chemise Blanche Coton', 'Chemises', 'Mode & Vêtements', 'Hugo Boss', 129.00, 50.00, '2022-01-01', NULL, 1),
    ('MODE003', 'Baskets Running', 'Chaussures', 'Mode & Vêtements', 'Nike', 149.00, 60.00, '2022-01-01', NULL, 1),
    ('MODE004', 'Veste en Cuir', 'Vestes', 'Mode & Vêtements', 'Zara', 299.00, 120.00, '2022-01-01', NULL, 1),
    ('MODE005', 'Robe d''Été Florale', 'Robes', 'Mode & Vêtements', 'H&M', 59.00, 25.00, '2022-01-01', NULL, 1);

-- Catégorie: Sport & Loisirs
INSERT INTO DimProduit (ProduitID, NomProduit, SousCategorie, Categorie, Marque, PrixCatalogue, Cout, DateDebut, DateFin, EstActif)
VALUES 
    ('SPOR001', 'Vélo VTT 27.5"', 'Cyclisme', 'Sport & Loisirs', 'Decathlon', 499.00, 250.00, '2022-01-01', NULL, 1),
    ('SPOR002', 'Tapis de Course Électrique', 'Fitness', 'Sport & Loisirs', 'NordicTrack', 899.00, 400.00, '2022-01-01', NULL, 1),
    ('SPOR003', 'Raquette Tennis Pro', 'Tennis', 'Sport & Loisirs', 'Wilson', 199.00, 80.00, '2022-01-01', NULL, 1),
    ('SPOR004', 'Ballon Football Official', 'Football', 'Sport & Loisirs', 'Adidas', 79.00, 30.00, '2022-01-01', NULL, 1);
GO

-- =============================================
-- PEUPLEMENT DIMENSION CLIENT (100 clients)
-- =============================================
DECLARE @i INT = 1;
DECLARE @Segments TABLE (Segment VARCHAR(30));
INSERT INTO @Segments VALUES ('Particulier'), ('Professionnel'), ('Premium');

DECLARE @Pays TABLE (Pays VARCHAR(50), Region VARCHAR(50));
INSERT INTO @Pays VALUES 
    ('France', 'Île-de-France'), ('France', 'Provence-Alpes-Côte d''Azur'),
    ('France', 'Auvergne-Rhône-Alpes'), ('France', 'Occitanie'),
    ('Belgique', 'Bruxelles'), ('Belgique', 'Wallonie'),
    ('Suisse', 'Genève'), ('Suisse', 'Zurich'),
    ('Canada', 'Québec'), ('Canada', 'Ontario');

WHILE @i <= 100
BEGIN
    DECLARE @Segment VARCHAR(30) = (SELECT TOP 1 Segment FROM @Segments ORDER BY NEWID());
    DECLARE @Pays VARCHAR(50), @Region VARCHAR(50);

    SELECT TOP 1 @Pays = Pays, @Region = Region FROM @Pays ORDER BY NEWID();

    INSERT INTO DimClient (ClientID, NomClient, Email, Telephone, Ville, Region, Pays, Segment, DateInscription, EstActif)
    VALUES (
        'CLI' + RIGHT('00000' + CAST(@i AS VARCHAR(5)), 5),
        'Client ' + CAST(@i AS VARCHAR(5)),
        'client' + CAST(@i AS VARCHAR(5)) + '@email.com',
        '+33 6' + RIGHT('00000000' + CAST(ABS(CHECKSUM(NEWID())) % 100000000 AS VARCHAR(8)), 8),
        CASE WHEN @Region = 'Île-de-France' THEN 'Paris'
             WHEN @Region = 'Provence-Alpes-Côte d''Azur' THEN 'Marseille'
             WHEN @Region = 'Auvergne-Rhône-Alpes' THEN 'Lyon'
             WHEN @Region = 'Occitanie' THEN 'Toulouse'
             WHEN @Region = 'Bruxelles' THEN 'Bruxelles'
             WHEN @Region = 'Wallonie' THEN 'Liège'
             WHEN @Region = 'Genève' THEN 'Genève'
             WHEN @Region = 'Zurich' THEN 'Zurich'
             WHEN @Region = 'Québec' THEN 'Montréal'
             ELSE 'Toronto' END,
        @Region,
        @Pays,
        @Segment,
        DATEADD(DAY, -ABS(CHECKSUM(NEWID())) % 730, '2024-01-01'),
        1
    );

    SET @i = @i + 1;
END
GO

-- =============================================
-- PEUPLEMENT TABLE DE FAITS (Transactions 2022-2024)
-- =============================================
DECLARE @CurrentDate DATE = '2022-01-01';
DECLARE @TransactionCount INT = 0;

WHILE @CurrentDate < '2025-01-01' AND @TransactionCount < 10000
BEGIN
    -- Nombre de transactions par jour (entre 5 et 30)
    DECLARE @DailyTransactions INT = 5 + ABS(CHECKSUM(NEWID())) % 26;
    DECLARE @DayCounter INT = 0;

    WHILE @DayCounter < @DailyTransactions AND @TransactionCount < 10000
    BEGIN
        DECLARE @ProduitKey INT = (SELECT TOP 1 ProduitKey FROM DimProduit ORDER BY NEWID());
        DECLARE @ClientKey INT = (SELECT TOP 1 ClientKey FROM DimClient ORDER BY NEWID());
        DECLARE @CanalKey INT = (SELECT TOP 1 CanalKey FROM DimCanal ORDER BY NEWID());
        DECLARE @Quantite INT = 1 + ABS(CHECKSUM(NEWID())) % 5;
        DECLARE @PrixCat DECIMAL(10,2) = (SELECT PrixCatalogue FROM DimProduit WHERE ProduitKey = @ProduitKey);
        DECLARE @Cout DECIMAL(10,2) = (SELECT Cout FROM DimProduit WHERE ProduitKey = @ProduitKey);

        -- Remise aléatoire (0%, 5%, 10%, 15%, 20%)
        DECLARE @TauxRemise DECIMAL(5,4) = CAST((ABS(CHECKSUM(NEWID())) % 5) * 0.05 AS DECIMAL(5,4));

        DECLARE @MontantBrut DECIMAL(12,2) = @PrixCat * @Quantite;
        DECLARE @MontantRemise DECIMAL(10,2) = @MontantBrut * @TauxRemise;
        DECLARE @ChiffreAffaires DECIMAL(12,2) = @MontantBrut - @MontantRemise;
        DECLARE @CoutTotal DECIMAL(12,2) = @Cout * @Quantite;

        INSERT INTO FactVentes (
            DateKey, ProduitKey, ClientKey, CanalKey,
            Quantite, PrixUnitaire, MontantBrut, TauxRemise, MontantRemise,
            ChiffreAffaires, CoutTotal
        )
        VALUES (
            CAST(FORMAT(@CurrentDate, 'yyyyMMdd') AS INT),
            @ProduitKey,
            @ClientKey,
            @CanalKey,
            @Quantite,
            @PrixCat,
            @MontantBrut,
            @TauxRemise,
            @MontantRemise,
            @ChiffreAffaires,
            @CoutTotal
        );

        SET @DayCounter = @DayCounter + 1;
        SET @TransactionCount = @TransactionCount + 1;
    END

    SET @CurrentDate = DATEADD(DAY, 1, @CurrentDate);
END
GO

-- Vérification des données
SELECT 'DimTemps' AS TableName, COUNT(*) AS NombreLignes FROM DimTemps
UNION ALL
SELECT 'DimProduit', COUNT(*) FROM DimProduit
UNION ALL
SELECT 'DimClient', COUNT(*) FROM DimClient
UNION ALL
SELECT 'DimCanal', COUNT(*) FROM DimCanal
UNION ALL
SELECT 'FactVentes', COUNT(*) FROM FactVentes;
GO
```

---

## Partie 2 : Intégration dans SQL Server Data Tools (SSDT)

### Étape 1 : Créer le projet Analysis Services

1. **Ouvrir Visual Studio**
2. **Créer un nouveau projet** :
   - File → New → Project
   - Templates → Business Intelligence → Analysis Services
   - Sélectionner "Analysis Services Multidimensional Project"
   - Nom : `ProjetCube_ECommerce`
   - Emplacement : Choisir votre dossier de travail
   - Cliquer sur **OK**

### Étape 2 : Créer la Data Source

1. **Clic droit** sur le dossier **Data Sources** dans le Solution Explorer
2. **New Data Source...**
3. **Assistant de création** :
   - Cliquer sur **Next**
   - Cliquer sur **New...** pour créer une nouvelle connexion
   - **Server name** : `localhost` (ou nom de votre serveur)
   - **Authentication** : Windows Authentication (ou SQL Server selon votre config)
   - **Select or enter database name** : `DW_ECommerce`
   - **Test Connection** pour vérifier
   - Cliquer sur **OK**
4. **Impersonation Information** :
   - Sélectionner "Use the service account"
   - Cliquer sur **Next**
5. **Completing the Wizard** :
   - Nom : `DS_DW_ECommerce`
   - Cliquer sur **Finish**

### Étape 3 : Créer la Data Source View

1. **Clic droit** sur **Data Source Views** → **New Data Source View...**
2. **Assistant** :
   - Cliquer sur **Next**
   - Sélectionner `DS_DW_ECommerce`
   - Cliquer sur **Next**
3. **Sélection des tables** :
   - Dans "Available objects", sélectionner toutes les tables :
     - `DimTemps`
     - `DimProduit`
     - `DimClient`
     - `DimCanal`
     - `FactVentes`
   - Cliquer sur **>** pour les ajouter
   - Cliquer sur **Next**
4. **Completing the Wizard** :
   - Nom : `DSV_ECommerce`
   - Cliquer sur **Finish**

### Étape 4 : Organiser le diagramme

Dans la vue DSV qui s'ouvre :

1. **Organiser les tables** en disposition en étoile (star schema) :
   - `FactVentes` au centre
   - Dimensions autour
2. **Vérifier les relations** (doivent être automatiquement détectées)
3. **Sauvegarder** (Ctrl+S)

### Étape 5 : Créer le Cube

1. **Clic droit** sur **Cubes** → **New Cube...**
2. **Assistant de création** :
   - Sélectionner "Use existing tables"
   - Cliquer sur **Next**
3. **Identify Measure Group Tables** :
   - Sélectionner `FactVentes`
   - Cliquer sur **Next**
4. **Select Measures** :
   - Désélectionner `Vente Key`, `Date Key`, `Produit Key`, `Client Key`, `Canal Key`
   - Garder cochés :
     - `Quantite` (renommer en "Quantité Vendue")
     - `Montant Brut`
     - `Montant Remise`
     - `Chiffre Affaires`
     - `Cout Total`
     - `Fact Ventes Count` (renommer en "Nombre de Commandes")
   - Cliquer sur **Next**
5. **Select Dimensions** :
   - Toutes doivent être cochées :
     - `Dim Temps`
     - `Dim Produit`
     - `Dim Client`
     - `Dim Canal`
   - Cliquer sur **Next**
6. **Completing the Wizard** :
   - Nom : `Cube_Ventes`
   - Cliquer sur **Finish**

### Étape 6 : Configuration des Dimensions

#### Dimension Temps

1. **Double-cliquer** sur `Dim Temps.dim` dans le Solution Explorer

2. **Créer la hiérarchie** :
   
   - Dans le volet **Attributes**, glisser-déposer dans **Hierarchies** :
     - `Annee` (niveau 1)
     - `Trimestre` (niveau 2)
     - `Mois Nom` (niveau 3)
     - `Date Complete` (niveau 4)
   - **Clic droit** sur la hiérarchie → Rename → `Calendrier`

3. **Configurer comme dimension de temps** :
   
   - Dans le volet **Properties** de la dimension
   - `Type` : Time
   - Sauvegarder

4. **Configurer les attributs de temps** :
   
   - Sélectionner l'attribut `Annee` :
     - `Type` → `Years`
   - Sélectionner `Trimestre` :
     - `Type` → `Quarters`
   - Sélectionner `Mois` :
     - `Type` → `Months`
   - Sélectionner `Date Complete` :
     - `Type` → `Date`

#### Dimension Produit

1. **Double-cliquer** sur `Dim Produit.dim`
2. **Créer la hiérarchie produit** :
   - Glisser-déposer :
     - `Categorie` (niveau 1)
     - `Sous Categorie` (niveau 2)
     - `Nom Produit` (niveau 3)
   - Renommer en `Hiérarchie Produit`
3. **Ajouter l'attribut Marque** comme navigation parallèle
4. **Sauvegarder**

#### Dimension Client

1. **Double-cliquer** sur `Dim Client.dim`
2. **Créer la hiérarchie géographique** :
   - Glisser-déposer :
     - `Pays` (niveau 1)
     - `Region` (niveau 2)
     - `Ville` (niveau 3)
   - Renommer en `Géographie`
3. **Ajouter l'attribut** `Segment` comme attribut indépendant
4. **Sauvegarder**

#### Dimension Canal

1. **Double-cliquer** sur `Dim Canal.dim`
2. **Créer une hiérarchie** :
   - Glisser-déposer :
     - `Type Canal` (niveau 1)
     - `Nom Canal` (niveau 2)
   - Renommer en `Type de Canal`
3. **Sauvegarder**

### Étape 7 : Configuration du Cube

1. **Double-cliquer** sur `Cube_Ventes.cube`

2. **Onglet Cube Structure** :
   
   - Vérifier que toutes les mesures et dimensions sont présentes
   - Organiser les mesures dans des dossiers logiques (optionnel)

3. **Renommer les mesures** pour plus de clarté :
   
   - `Quantite` → `Quantité Vendue`
   - `Chiffre Affaires` → `Chiffre d'Affaires`
   - `Cout Total` → `Coût Total`

### Étape 8 : Déploiement et Traitement

1. **Configurer les propriétés de déploiement** :
   
   - Clic droit sur le projet dans Solution Explorer
   - **Properties**
   - **Deployment** :
     - `Server` : localhost (ou votre serveur)
     - `Database` : `SSAS_ECommerce`
   - Cliquer sur **OK**

2. **Déployer le projet** :
   
   - Clic droit sur le projet → **Deploy**
   - Attendre la fin du déploiement et du traitement

3. **En cas d'erreur de traitement** :
   
   - Vérifier que le service SQL Server Analysis Services est démarré
   - Vérifier les droits d'accès à la base DW_ECommerce

### Étape 9 : Navigation dans le Cube

1. **Ouvrir le Browser** :
   
   - Double-cliquer sur `Cube_Ventes.cube`
   - Onglet **Browser**
   - Cliquer sur l'icône **Reconnect** si nécessaire

2. **Test de navigation** :
   
   - Glisser `Chiffre d'Affaires` dans la zone de données
   - Glisser `Hiérarchie Produit` dans les lignes
   - Glisser `Calendrier` dans les colonnes
   - Observer les résultats

3. **Tests supplémentaires** :
   
   - Ajouter la dimension `Géographie`
   - Filtrer par `Segment` de client
   - Analyser par `Type de Canal`

---

## Vérifications et Tests

### Requêtes MDX de validation

```mdx
-- Test 1 : Chiffre d'affaires total
SELECT 
    [Measures].[Chiffre d'Affaires] ON COLUMNS
FROM [Cube_Ventes]

-- Test 2 : CA par année
SELECT 
    [Measures].[Chiffre d'Affaires] ON COLUMNS,
    [Dim Temps].[Calendrier].[Annee].MEMBERS ON ROWS
FROM [Cube_Ventes]

-- Test 3 : CA par catégorie de produit
SELECT 
    [Measures].[Chiffre d'Affaires] ON COLUMNS,
    [Dim Produit].[Hiérarchie Produit].[Categorie].MEMBERS ON ROWS
FROM [Cube_Ventes]

-- Test 4 : Top 10 produits
SELECT 
    [Measures].[Chiffre d'Affaires] ON COLUMNS,
    TOPCOUNT([Dim Produit].[Nom Produit].[Nom Produit].MEMBERS, 10, [Measures].[Chiffre d'Affaires]) ON ROWS
FROM [Cube_Ventes]

-- Test 5 : CA par canal et pays
SELECT 
    [Measures].[Chiffre d'Affaires] ON COLUMNS,
    [Dim Canal].[Nom Canal].[Nom Canal].MEMBERS ON ROWS,
    [Dim Client].[Géographie].[Pays].MEMBERS ON PAGES
FROM [Cube_Ventes]
```

---

## Points de Contrôle

✅ **Base de données DW_ECommerce créée avec succès** ✅ **Tables de dimensions et de faits peuplées** ✅ **Projet SSAS créé et configuré** ✅ **Data Source et Data Source View créées** ✅ **Cube déployé et traité sans erreur** ✅ **Hiérarchies fonctionnelles dans chaque dimension** ✅ **Navigation dans le cube opérationnelle**

---

## Prochaines Étapes

Dans les ateliers suivants, nous allons :

- **Atelier 2** : Créer des membres calculés (KPIs, ratios, YTD)
- **Atelier 3** : Définir des ensembles nommés (Top produits, segments clients)
- **Atelier 4** : Implémenter des scripts avec SCOPE pour des calculs complexes

---

## Résolution de Problèmes Courants

| Problème                           | Solution                                                        |
| ---------------------------------- | --------------------------------------------------------------- |
| Erreur de connexion au serveur SQL | Vérifier que le service SQL Server est démarré                  |
| Erreur de droits d'accès           | Vérifier les permissions sur la base DW_ECommerce               |
| Dimension de temps non reconnue    | Configurer le `Type` de dimension à "Time"                      |
| Hiérarchie mal formée              | Vérifier l'ordre des niveaux (du plus général au plus détaillé) |
| Cube ne se traite pas              | Vérifier les relations dans la DSV                              |
| Mesures affichent NULL             | Vérifier les données dans FactVentes                            |


