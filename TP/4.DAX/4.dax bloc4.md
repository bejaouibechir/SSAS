# Atelier DAX pour SSAS Tabular

# BLOC 4 : Tables Calcul√©es et Mod√©lisation

## Comprendre les Tables Calcul√©es

### Vue d'ensemble

**üéØ Type d'objet : üìã TABLE CALCUL√âE**

#### Qu'est-ce qu'une table calcul√©e ?

**D√©finition** : Une table enti√®rement cr√©√©e par une formule DAX (pas import√©e depuis une source)

**Quand l'utiliser ?**

- ‚úÖ Segmentation/cat√©gorisation (ex: groupes RFM)
- ‚úÖ Tables de param√®tres (ex: s√©lection dynamique)
- ‚úÖ Tables de dates personnalis√©es
- ‚úÖ Tables de r√©f√©rence (ex: fourchettes, seuils)
- ‚úÖ Agr√©gations pr√©calcul√©es (attention √† la m√©moire)

**Quand NE PAS l'utiliser ?**

- ‚ùå Pour des calculs simples (pr√©f√©rer mesure)
- ‚ùå Si les donn√©es existent d√©j√† dans la source
- ‚ùå Pour de tr√®s grosses tables (performance)

---

### Syntaxe de cr√©ation

#### Dans SSDT - Visual Studio

1. Menu **Mod√®le** ‚Üí **Nouvelle table calcul√©e**
2. Dans la barre de formule, taper :

```dax
NomTable = 
    EXPRESSION_QUI_RETOURNE_UNE_TABLE
```

3. Appuyer sur **Entr√©e**

#### Fonctions qui retournent des tables

| Fonction                        | Usage                              | Exemple              |
| ------------------------------- | ---------------------------------- | -------------------- |
| **DATATABLE**                   | Cr√©er table manuellement           | Liste de valeurs     |
| **SUMMARIZE**                   | Agr√©ger et grouper                 | Ventes par cat√©gorie |
| **SUMMARIZECOLUMNS**            | Version moderne de SUMMARIZE       | M√™me usage           |
| **ADDCOLUMNS**                  | Ajouter colonnes √† table existante | Enrichir dimension   |
| **SELECTCOLUMNS**               | S√©lectionner colonnes sp√©cifiques  | Sous-ensemble        |
| **FILTER**                      | Filtrer une table                  | Top produits         |
| **CROSSJOIN**                   | Produit cart√©sien                  | Toutes combinaisons  |
| **UNION**                       | Fusionner tables                   | Combiner sources     |
| **CALENDAR** / **CALENDARAUTO** | G√©n√©rer calendrier                 | Table de dates       |

---

### Diff√©rence table calcul√©e vs colonne calcul√©e

| Aspect        | Table calcul√©e üìã                | Colonne calcul√©e üìè              |
| ------------- | -------------------------------- | -------------------------------- |
| **Cr√©e**      | Une table compl√®te               | Une colonne dans table existante |
| **Symbole**   | `NomTable =`                     | `NomColonne =`                   |
| **Contexte**  | N/A (table enti√®re)              | Ligne par ligne                  |
| **Stockage**  | Oui (toute la table)             | Oui (colonne dans table)         |
| **Relations** | Peut cr√©er relations vers/depuis | Fait partie de la table          |
| **Usage**     | Segmentation, param√®tres         | Enrichissement donn√©es           |

---

## SC√âNARIO 10 : Table de Segmentation RFM Client

### üìã Contexte M√©tier

**Persona** : Marie, Directrice Marketing  
**Besoin** : "Je veux segmenter mes clients selon leur valeur (RFM : Recency, Frequency, Monetary) pour cr√©er des campagnes marketing cibl√©es."

**Segments √† cr√©er** :

- üèÜ **Champions** : Acheteurs fr√©quents et r√©cents, forte valeur
- üíé **Loyaux** : Acheteurs r√©guliers, bonne valeur
- üå± **Potentiel** : Acheteurs occasionnels, √† d√©velopper
- ‚ö†Ô∏è **√Ä risque** : Clients qui s'√©loignent
- üò¥ **Endormis** : Clients inactifs depuis longtemps
- üíÄ **Perdus** : Clients √† r√©activer

**Objectif p√©dagogique** :

- Cr√©er une table calcul√©e de segmentation
- Calculer scores RFM
- Cr√©er des cat√©gories client
- Utiliser la table pour analyses cibl√©es
- Mesurer la valeur par segment

---

### √âtape 1 : Comprendre le mod√®le RFM

#### 1.1 Les 3 dimensions RFM

**R - Recency (R√©cence)** : Depuis combien de temps le dernier achat ?

- ‚úÖ Plus r√©cent = meilleur score
- Exemple : Achat hier = 5 points, il y a 1 an = 1 point

**F - Frequency (Fr√©quence)** : Combien de commandes ?

- ‚úÖ Plus de commandes = meilleur score
- Exemple : 20 commandes = 5 points, 1 commande = 1 point

**M - Monetary (Montant)** : Combien d√©pens√© au total ?

- ‚úÖ Plus d√©pens√© = meilleur score
- Exemple : 10K$ = 5 points, 100$ = 1 point

#### 1.2 Scores et segmentation

**Score RFM** : Combinaison de 3 chiffres (ex: 555, 311, 111)

- **555** : Champion (Recency=5, Frequency=5, Monetary=5)
- **311** : √Ä risque (Recency faible mais historique correct)
- **111** : Perdu (Inactif, peu de commandes, faible valeur)

---

### √âtape 2 : Cr√©er la table de segmentation client

**üéØ Type d'objet : üìã TABLE CALCUL√âE**

#### 2.1 Cr√©er la structure de base

Menu **Mod√®le** ‚Üí **Nouvelle table calcul√©e** :

```dax
Customer Segmentation = 
    ADDCOLUMNS(
        VALUES(DimCustomer[CustomerKey]),
        "Customer Name", 
            RELATED(DimCustomer[FirstName]) & " " & RELATED(DimCustomer[LastName]),
        "Total Orders", [Customer Order Count],
        "Total Spend", [Customer Total Spend],
        "Last Purchase Date", [Customer Last Purchase Date]
    )
```

**Probl√®me** : Les mesures ne fonctionnent pas dans ADDCOLUMNS de table calcul√©e !

**Solution** : Calculer avec CALCULATE

```dax
Customer Segmentation = 
    ADDCOLUMNS(
        VALUES(DimCustomer[CustomerKey]),
        "Customer Name", 
            CALCULATE(
                MAX(DimCustomer[FirstName]) & " " & MAX(DimCustomer[LastName])
            ),
        "Total Orders", 
            CALCULATE(COUNTROWS(FactInternetSales)),
        "Total Spend", 
            CALCULATE(SUM(FactInternetSales[SalesAmount])),
        "Last Purchase Date", 
            CALCULATE(MAX(FactInternetSales[OrderDate]))
    )
```

#### 2.2 R√©sultat de la table

**Dans l'Explorateur de mod√®les** :

```
üìã Customer Segmentation
   ‚îú‚îÄ CustomerKey
   ‚îú‚îÄ Customer Name
   ‚îú‚îÄ Total Orders
   ‚îú‚îÄ Total Spend
   ‚îî‚îÄ Last Purchase Date
```

**Donn√©es** (exemple) :

```
CustomerKey | Customer Name  | Total Orders | Total Spend | Last Purchase
11000       | John Smith     | 8            | $3,456.78   | 2013-11-15
11001       | Jane Doe       | 23           | $12,345.89  | 2013-12-20
11002       | Bob Johnson    | 2            | $567.45     | 2012-03-10
...
```

---

### √âtape 3 : Calculer les scores RFM

**üéØ Type d'objet : üìè COLONNE CALCUL√âE** (dans la table calcul√©e)

#### 3.1 Score Recency (R)

**Dans la table Customer Segmentation**, ajouter une colonne :

```dax
R_Score = 
    VAR DaysSinceLastPurchase = 
        DATEDIFF(
            'Customer Segmentation'[Last Purchase Date],
            DATE(2014, 1, 1),  // Date de r√©f√©rence
            DAY
        )
    RETURN
        SWITCH(
            TRUE(),
            DaysSinceLastPurchase <= 30, 5,    // Moins de 1 mois
            DaysSinceLastPurchase <= 90, 4,    // 1-3 mois
            DaysSinceLastPurchase <= 180, 3,   // 3-6 mois
            DaysSinceLastPurchase <= 365, 2,   // 6-12 mois
            1                                  // Plus d'1 an
        )
```

#### 3.2 Score Frequency (F)

```dax
F_Score = 
    VAR Orders = 'Customer Segmentation'[Total Orders]
    RETURN
        SWITCH(
            TRUE(),
            Orders >= 15, 5,    // 15+ commandes
            Orders >= 10, 4,    // 10-14 commandes
            Orders >= 5, 3,     // 5-9 commandes
            Orders >= 2, 2,     // 2-4 commandes
            1                   // 1 commande
        )
```

#### 3.3 Score Monetary (M)

```dax
M_Score = 
    VAR Spend = 'Customer Segmentation'[Total Spend]
    RETURN
        SWITCH(
            TRUE(),
            Spend >= 10000, 5,  // 10K$+
            Spend >= 5000, 4,   // 5-10K$
            Spend >= 2000, 3,   // 2-5K$
            Spend >= 500, 2,    // 500-2K$
            1                   // Moins de 500$
        )
```

#### 3.4 Score RFM composite

```dax
RFM_Score = 
    ('Customer Segmentation'[R_Score] * 100) + 
    ('Customer Segmentation'[F_Score] * 10) + 
    'Customer Segmentation'[M_Score]
```

**Exemple** :

- R=5, F=3, M=4 ‚Üí RFM_Score = 534

---

### √âtape 4 : Cr√©er les segments clients

**üéØ Type d'objet : üìè COLONNE CALCUL√âE**

#### 4.1 Segmentation d√©taill√©e

```dax
Customer Segment = 
    VAR R = 'Customer Segmentation'[R_Score]
    VAR F = 'Customer Segmentation'[F_Score]
    VAR M = 'Customer Segmentation'[M_Score]
    VAR RFM = 'Customer Segmentation'[RFM_Score]
    RETURN
        SWITCH(
            TRUE(),
            // Champions : R‚â•4, F‚â•4, M‚â•4
            R >= 4 && F >= 4 && M >= 4, "üèÜ Champions",

            // Loyaux : R‚â•3, F‚â•3, M‚â•3
            R >= 3 && F >= 3 && M >= 3, "üíé Loyaux",

            // Potentiel : R‚â•4 mais F ou M faibles
            R >= 4 && (F < 3 || M < 3), "üå± Potentiel",

            // √Ä risque : F‚â•3, M‚â•3 mais R faible
            F >= 3 && M >= 3 && R < 3, "‚ö†Ô∏è √Ä risque",

            // Endormis : R‚â§2, mais historique correct
            R <= 2 && F >= 2, "üò¥ Endormis",

            // Perdus : Tous faibles
            "üíÄ Perdus"
        )
```

#### 4.2 R√©sultat

```
CustomerKey | RFM_Score | R | F | M | Segment
11000       | 534       | 5 | 3 | 4 | üèÜ Champions
11001       | 555       | 5 | 5 | 5 | üèÜ Champions
11002       | 211       | 2 | 1 | 1 | üíÄ Perdus
11003       | 443       | 4 | 4 | 3 | üíé Loyaux
11004       | 512       | 5 | 1 | 2 | üå± Potentiel
11005       | 244       | 2 | 4 | 4 | ‚ö†Ô∏è √Ä risque
...
```

---

### √âtape 5 : Cr√©er une relation avec la table de faits

#### 5.1 Cr√©er la relation

**Dans la vue Diagramme** :

1. Glisser-d√©poser de **Customer Segmentation[CustomerKey]** vers **FactInternetSales[CustomerKey]**
2. Type : Many-to-One (Plusieurs ventes ‚Üí un client)
3. Direction : Simple

**Ou via menu** :

1. Menu **Mod√®le** ‚Üí **G√©rer les relations**
2. **Nouvelle**
3. Configurer :
   - Table : FactInternetSales
   - Colonne : CustomerKey
   - Table li√©e : Customer Segmentation
   - Colonne li√©e : CustomerKey

#### 5.2 V√©rifier la relation

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FactInternetSales       ‚îÇ         ‚îÇCustomer Segment.  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§         ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ CustomerKey     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îº‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ñ∂‚îÇ CustomerKey       ‚îÇ
‚îÇ SalesAmount             ‚îÇ         ‚îÇ Customer Segment  ‚îÇ
‚îÇ OrderDate               ‚îÇ         ‚îÇ R_Score, F_Score  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ RFM_Score         ‚îÇ
                                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### √âtape 6 : Analyser par segment

#### 6.1 Dans Excel - Tableau crois√©

**Configuration** :

- **Lignes** : Customer Segmentation[Customer Segment]
- **Valeurs** :
  - Count of CustomerKey (nombre de clients)
  - Total Sales
  - Average Sales per Customer

**R√©sultat** :

```
Segment        | Count | Total Sales    | Avg per Customer | % of Total
üèÜ Champions   | 856   | $12,456,789    | $14,552         | 42.4%
üíé Loyaux      | 2,134 | $8,234,567     | $3,859          | 28.1%
üå± Potentiel   | 1,245 | $3,456,789     | $2,776          | 11.8%
‚ö†Ô∏è √Ä risque    | 987   | $2,345,678     | $2,377          | 8.0%
üò¥ Endormis    | 1,567 | $1,789,234     | $1,141          | 6.1%
üíÄ Perdus      | 11,695| $1,075,620     | $92             | 3.7%
```

**üí° Insights** :

- **Champions** : 5% des clients = 42% du CA ! üéØ
- **Perdus** : 63% des clients = seulement 4% du CA
- **Action** : Focus marketing sur Champions et Loyaux

---

### √âtape 7 : Cr√©er des mesures sp√©cifiques par segment

**üéØ Type d'objet : üìä MESURE**

#### 7.1 Ventes des Champions uniquement

```dax
Sales Champions := 
    CALCULATE(
        SUM(FactInternetSales[SalesAmount]),
        'Customer Segmentation'[Customer Segment] = "üèÜ Champions"
    )
```

#### 7.2 Taux de r√©tention par segment

```dax
Segment Retention Rate := 
    VAR CustomersWithPurchases = 
        CALCULATE(
            DISTINCTCOUNT(FactInternetSales[CustomerKey]),
            FactInternetSales[OrderDate] >= DATE(2013, 1, 1)
        )
    VAR TotalCustomersInSegment = 
        DISTINCTCOUNT('Customer Segmentation'[CustomerKey])
    RETURN
        DIVIDE(CustomersWithPurchases, TotalCustomersInSegment) * 100
```

**R√©sultat** :

```
Segment        | Retention Rate (2013)
üèÜ Champions   | 95.2%  ‚Üê Excellent !
üíé Loyaux      | 87.3%
üå± Potentiel   | 52.4%
‚ö†Ô∏è √Ä risque    | 34.1%  ‚Üê Alerte
üò¥ Endormis    | 12.8%
üíÄ Perdus      | 2.3%
```

---

### √âtape 8 : Strat√©gies marketing par segment

#### 8.1 Cr√©er une table de recommandations

**üéØ Type d'objet : üìã TABLE CALCUL√âE**

```dax
Marketing Strategy = 
    DATATABLE(
        "Segment", STRING,
        "Strategy", STRING,
        "Budget Priority", STRING,
        "Expected ROI", STRING,
        {
            {"üèÜ Champions", "Programme VIP, early access, exclusivit√©s", "HIGH", "Excellent"},
            {"üíé Loyaux", "R√©compenses fid√©lit√©, recommandations", "HIGH", "Tr√®s bon"},
            {"üå± Potentiel", "Incitations √† racheter, bundles", "MEDIUM", "Bon"},
            {"‚ö†Ô∏è √Ä risque", "Campagne de r√©activation, offres sp√©ciales", "MEDIUM", "Moyen"},
            {"üò¥ Endormis", "Win-back campaign, remises agressives", "LOW", "Faible"},
            {"üíÄ Perdus", "Minimal contact, enqu√™te exit", "VERY LOW", "Tr√®s faible"}
        }
    )
```

#### 8.2 Dashboard pour Marie

**Section 1 : Vue d'ensemble segments**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ R√âPARTITION CLIENT√àLE                                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üèÜ Champions    856 clients    42% CA    Budget: HIGH   ‚îÇ
‚îÇ üíé Loyaux       2,134 clients  28% CA    Budget: HIGH   ‚îÇ
‚îÇ üå± Potentiel    1,245 clients  12% CA    Budget: MED    ‚îÇ
‚îÇ ‚ö†Ô∏è √Ä risque     987 clients    8% CA     Budget: MED    ‚îÇ
‚îÇ üò¥ Endormis     1,567 clients  6% CA     Budget: LOW    ‚îÇ
‚îÇ üíÄ Perdus       11,695 clients 4% CA     Budget: V.LOW  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Section 2 : Graphique en secteurs**

- Visualiser % de CA par segment
- Taille proportionnelle √† la valeur

**Section 3 : Matrice RFM**

```
        M=5      M=4      M=3      M=2      M=1
R=5   üèÜ Champ  üèÜ Champ üå± Poten  üå± Poten  üíÄ Perdu
R=4   üèÜ Champ  üíé Loyal üíé Loyal  üå± Poten  üíÄ Perdu
R=3   üíé Loyal  üíé Loyal üíé Loyal  üò¥ Endor  üíÄ Perdu
R=2   ‚ö†Ô∏è Risque ‚ö†Ô∏è Risque üò¥ Endor  üò¥ Endor  üíÄ Perdu
R=1   üíÄ Perdu  üíÄ Perdu  üíÄ Perdu  üíÄ Perdu  üíÄ Perdu
```

---

### üìä CONCLUSION DU SC√âNARIO 10

#### Ce que vous avez appris :

‚úÖ **Table calcul√©e** : Cr√©er une table compl√®te avec ADDCOLUMNS  
‚úÖ **Segmentation RFM** : Recency, Frequency, Monetary  
‚úÖ **Scores conditionnels** : SWITCH avec conditions multiples  
‚úÖ **Relations** : Connecter table calcul√©e au mod√®le  
‚úÖ **Analyse par segment** : Identifier valeur par groupe  
‚úÖ **Strat√©gies cibl√©es** : Actions marketing adapt√©es

#### Pattern Segmentation Client

```
1. Cr√©er table calcul√©e avec m√©triques client
2. Calculer scores (R, F, M)
3. Cr√©er segments bas√©s sur scores
4. √âtablir relation avec table de faits
5. Analyser CA et comportement par segment
6. D√©finir strat√©gies par segment
```

#### Impact m√©tier pour Marie

üéØ **Insight principal** : 5% des clients (Champions) = 42% du CA  
üí∞ **Budget marketing** : 70% sur Champions+Loyaux (3K clients, 70% CA)  
‚ö†Ô∏è **Alerte** : 987 clients "√Ä risque" avec r√©tention 34% (campagne urgente)  
üìà **Opportunit√©** : 1,245 clients "Potentiel" √† d√©velopper  
üíÄ **Accepter la perte** : 11K clients "Perdus" (4% CA, co√ªt > b√©n√©fice)

#### Prochaine √©tape :

‚Üí Sc√©nario 11 : Table de dates personnalis√©e avanc√©e

---

## SC√âNARIO 11 : Table de Dates Personnalis√©e (Calendar Table)

### üìã Contexte M√©tier

**Persona** : Philippe, Architecte BI  
**Besoin** : "Je veux une table de dates compl√®te avec des colonnes personnalis√©es : semaines fiscales, p√©riodes de campagne marketing, jours f√©ri√©s, etc."

**Probl√®me avec DimDate actuelle** :

- Colonnes manquantes (ex: num√©ro de semaine ISO)
- Pas de marqueurs de jours f√©ri√©s
- Pas de p√©riodes marketing personnalis√©es
- Ann√©e fiscale diff√©rente de l'ann√©e calendaire

**Objectif p√©dagogique** :

- Cr√©er une table de dates avec CALENDAR/CALENDARAUTO
- Ajouter des colonnes calcul√©es personnalis√©es
- G√©rer les ann√©es fiscales
- Marquer jours f√©ri√©s et √©v√©nements
- Int√©grer au mod√®le existant

---

### √âtape 1 : Cr√©er la table de dates de base

**üéØ Type d'objet : üìã TABLE CALCUL√âE**

#### 1.1 Option 1 : CALENDAR (plage manuelle)

```dax
Calendar = 
    CALENDAR(
        DATE(2010, 1, 1),    -- Date de d√©but
        DATE(2020, 12, 31)   -- Date de fin
    )
```

**R√©sultat** : Table avec UNE colonne `[Date]` contenant toutes les dates de 2010 √† 2020

#### 1.2 Option 2 : CALENDARAUTO (automatique)

```dax
Calendar = CALENDARAUTO()
```

**Ce que fait CALENDARAUTO** :

1. Analyse TOUTES les colonnes de dates du mod√®le
2. Trouve la date min et max
3. Cr√©e une table avec toutes les dates entre min et max

**Avantage** : S'adapte automatiquement aux donn√©es  
**Inconv√©nient** : Moins de contr√¥le

#### 1.3 Option recommand√©e : CALENDAR avec dates dynamiques

```dax
Calendar = 
    VAR MinDate = DATE(2010, 1, 1)  -- Ou CALCULATE(MIN(FactInternetSales[OrderDate]))
    VAR MaxDate = DATE(2020, 12, 31) -- Ou DATE(YEAR(TODAY()), 12, 31)
    RETURN
        CALENDAR(MinDate, MaxDate)
```

---

### √âtape 2 : Ajouter les colonnes de base

**üéØ Type d'objet : üìè COLONNE CALCUL√âE** (dans la table Calendar)

#### 2.1 Colonnes d'ann√©e

```dax
Year = YEAR(Calendar[Date])

Year Short = FORMAT(Calendar[Date], "YY")  -- Ex: "24" pour 2024

Year Month = FORMAT(Calendar[Date], "YYYY-MM")  -- Ex: "2024-01"

Year Month Name = FORMAT(Calendar[Date], "YYYY MMM")  -- Ex: "2024 Jan"
```

#### 2.2 Colonnes de trimestre

```dax
Quarter = "Q" & QUARTER(Calendar[Date])  -- Ex: "Q1", "Q2"

Quarter Number = QUARTER(Calendar[Date])  -- 1, 2, 3, 4

Year Quarter = 
    FORMAT(Calendar[Date], "YYYY") & " Q" & QUARTER(Calendar[Date])
    -- Ex: "2024 Q1"
```

#### 2.3 Colonnes de mois

```dax
Month = MONTH(Calendar[Date])  -- 1, 2, ..., 12

Month Name = FORMAT(Calendar[Date], "MMMM")  -- Ex: "January"

Month Short = FORMAT(Calendar[Date], "MMM")  -- Ex: "Jan"

Month Year = FORMAT(Calendar[Date], "MMM YYYY")  -- Ex: "Jan 2024"
```

#### 2.4 Colonnes de semaine

```dax
Week Number = WEEKNUM(Calendar[Date], 2)  -- ISO 8601 (lundi = d√©but)

Week Day = WEEKDAY(Calendar[Date], 2)  -- 1=Lundi, 7=Dimanche

Week Day Name = FORMAT(Calendar[Date], "DDDD")  -- Ex: "Monday"

Week Day Short = FORMAT(Calendar[Date], "DDD")  -- Ex: "Mon"
```

#### 2.5 Colonnes de jour

```dax
Day = DAY(Calendar[Date])  -- 1, 2, ..., 31

Day of Year = 
    DATEDIFF(
        DATE(YEAR(Calendar[Date]), 1, 1),
        Calendar[Date],
        DAY
    ) + 1  -- Jour 1-365/366
```

---

### √âtape 3 : Ann√©e fiscale (exercice fiscal)

**Sc√©nario** : L'ann√©e fiscale commence le 1er juillet

#### 3.1 Colonnes ann√©e fiscale

```dax
Fiscal Year = 
    VAR CurrentMonth = MONTH(Calendar[Date])
    VAR CurrentYear = YEAR(Calendar[Date])
    RETURN
        IF(
            CurrentMonth >= 7,  -- Juillet ou apr√®s
            CurrentYear + 1,    -- Ann√©e fiscale suivante
            CurrentYear         -- M√™me ann√©e fiscale
        )
```

**Exemple** :

- 15 juin 2024 ‚Üí Fiscal Year = 2024
- 15 juillet 2024 ‚Üí Fiscal Year = 2025

```dax
Fiscal Quarter = 
    VAR CurrentMonth = MONTH(Calendar[Date])
    VAR FiscalMonth = IF(CurrentMonth >= 7, CurrentMonth - 6, CurrentMonth + 6)
    RETURN
        "FQ" & ROUNDUP(FiscalMonth / 3, 0)
```

**Exemple** :

- Juillet (mois 7) ‚Üí Fiscal Month 1 ‚Üí FQ1
- Septembre (mois 9) ‚Üí Fiscal Month 3 ‚Üí FQ1
- Octobre (mois 10) ‚Üí Fiscal Month 4 ‚Üí FQ2

```dax
Fiscal Month = 
    VAR CurrentMonth = MONTH(Calendar[Date])
    RETURN
        IF(CurrentMonth >= 7, CurrentMonth - 6, CurrentMonth + 6)
```

---

### √âtape 4 : Indicateurs de jours sp√©ciaux

**üéØ Type d'objet : üìè COLONNE CALCUL√âE**

#### 4.1 Week-end vs jour ouvrable

```dax
Is Weekend = 
    VAR DayNum = WEEKDAY(Calendar[Date], 2)  -- 1=Lundi, 7=Dimanche
    RETURN
        DayNum >= 6  -- Samedi (6) ou Dimanche (7)

Is Weekday = NOT(Calendar[Is Weekend])
```

#### 4.2 Jours f√©ri√©s (France exemple)

```dax
Is Holiday = 
    VAR D = Calendar[Date]
    VAR Y = YEAR(D)
    VAR M = MONTH(D)
    VAR Day = DAY(D)

    -- P√¢ques (formule de Gauss simplifi√©e - approximation)
    VAR EasterMonth = 3  -- Approximation pour l'exemple
    VAR EasterDay = 31 + (19 * (Y MOD 19) + 24) MOD 30

    RETURN
        SWITCH(
            TRUE(),
            M = 1 && Day = 1, TRUE,     -- Nouvel An
            M = 5 && Day = 1, TRUE,     -- F√™te du Travail
            M = 5 && Day = 8, TRUE,     -- Victoire 1945
            M = 7 && Day = 14, TRUE,    -- F√™te Nationale
            M = 8 && Day = 15, TRUE,    -- Assomption
            M = 11 && Day = 1, TRUE,    -- Toussaint
            M = 11 && Day = 11, TRUE,   -- Armistice
            M = 12 && Day = 25, TRUE,   -- No√´l
            FALSE
        )

Holiday Name = 
    VAR M = MONTH(Calendar[Date])
    VAR Day = DAY(Calendar[Date])
    RETURN
        SWITCH(
            TRUE(),
            M = 1 && Day = 1, "Nouvel An",
            M = 5 && Day = 1, "F√™te du Travail",
            M = 5 && Day = 8, "Victoire 1945",
            M = 7 && Day = 14, "F√™te Nationale",
            M = 8 && Day = 15, "Assomption",
            M = 11 && Day = 1, "Toussaint",
            M = 11 && Day = 11, "Armistice",
            M = 12 && Day = 25, "No√´l",
            BLANK()
        )
```

#### 4.3 P√©riodes marketing

```dax
Marketing Period = 
    VAR M = MONTH(Calendar[Date])
    RETURN
        SWITCH(
            TRUE(),
            M = 1, "Soldes Hiver",
            M = 2, "Saint-Valentin",
            M = 3 || M = 4, "Printemps",
            M = 5, "F√™te des M√®res",
            M = 6 || M = 7, "Soldes √ât√©",
            M = 8, "Rentr√©e Scolaire",
            M = 9 || M = 10, "Automne",
            M = 11, "Black Friday",
            M = 12, "No√´l",
            "Standard"
        )
```

---

### √âtape 5 : Indicateurs de p√©riode

**üéØ Type d'objet : üìè COLONNE CALCUL√âE**

#### 5.1 Indicateurs temporels

```dax
Is Today = Calendar[Date] = TODAY()

Is Current Month = 
    YEAR(Calendar[Date]) = YEAR(TODAY()) &&
    MONTH(Calendar[Date]) = MONTH(TODAY())

Is Current Quarter = 
    YEAR(Calendar[Date]) = YEAR(TODAY()) &&
    QUARTER(Calendar[Date]) = QUARTER(TODAY())

Is Current Year = YEAR(Calendar[Date]) = YEAR(TODAY())

Is Last Month = 
    VAR LastMonth = EOMONTH(TODAY(), -1)  -- Fin du mois dernier
    RETURN
        YEAR(Calendar[Date]) = YEAR(LastMonth) &&
        MONTH(Calendar[Date]) = MONTH(LastMonth)
```

#### 5.2 Indicateurs relatifs

```dax
Days from Today = 
    DATEDIFF(
        TODAY(),
        Calendar[Date],
        DAY
    )

Is Past = Calendar[Date] < TODAY()

Is Future = Calendar[Date] > TODAY()

Is This Week = 
    VAR StartOfWeek = TODAY() - WEEKDAY(TODAY(), 2) + 1
    VAR EndOfWeek = StartOfWeek + 6
    RETURN
        Calendar[Date] >= StartOfWeek && Calendar[Date] <= EndOfWeek
```

---

### √âtape 6 : Colonnes de tri personnalis√©es

**üéØ Type d'objet : üìè COLONNE CALCUL√âE**

#### 6.1 Ordre de tri pour les mois

**Probl√®me** : "January", "February"... ne se trient pas correctement alphab√©tiquement

**Solution** : Colonne num√©rique de tri

```dax
Month Sort = MONTH(Calendar[Date])  -- 1, 2, 3, ...
```

**Configuration du tri** :

1. S√©lectionner la colonne **Month Name**
2. Ruban **Mod√©lisation** ‚Üí **Trier par colonne** ‚Üí **Month Sort**

#### 6.2 Ordre pour les jours de la semaine

```dax
Week Day Sort = WEEKDAY(Calendar[Date], 2)  -- 1=Lundi, 7=Dimanche
```

**Appliquer √† Week Day Name** :

1. S√©lectionner **Week Day Name**
2. **Trier par colonne** ‚Üí **Week Day Sort**

---

### √âtape 7 : Int√©grer la table au mod√®le

#### 7.1 Cr√©er une relation avec FactInternetSales

**Option 1 : Remplacer DimDate existante**

1. Supprimer les relations de DimDate
2. Cr√©er relation Calendar[Date] ‚Üí FactInternetSales[OrderDate]
3. Supprimer DimDate (optionnel)

**Option 2 : Avoir les deux tables** (recommand√© pour transition)

1. Cr√©er relation Calendar[Date] ‚Üí FactInternetSales[OrderDateKey]
2. Marquer comme inactive la relation de DimDate
3. Tester les deux approches
4. Basculer progressivement

#### 7.2 Marquer comme table de dates

**IMPORTANT** :

1. Clic droit sur **Calendar** (table)
2. **Marquer comme table de dates**
3. S√©lectionner la colonne **Date**

**V√©rification** : L'ic√¥ne de la table change (ajout d'un calendrier üìÖ)

---

### √âtape 8 : Tester avec Time Intelligence

#### 8.1 V√©rifier YTD avec la nouvelle table

```dax
Sales YTD New Calendar := 
    TOTALYTD(
        SUM(FactInternetSales[SalesAmount]),
        Calendar[Date]  -- Utiliser la nouvelle table
    )
```

#### 8.2 Comparer avec l'ancienne

```
Month     | YTD Old Table | YTD New Table | Match?
Jan 2013  | $802,145      | $802,145      | ‚úÖ
Feb 2013  | $1,567,379    | $1,567,379    | ‚úÖ
Mar 2013  | $2,379,835    | $2,379,835    | ‚úÖ
```

**Si les valeurs matchent** : Migration r√©ussie ! ‚úÖ

---

### √âtape 9 : Cas d'usage avanc√©s

#### 9.1 Analyser par jour ouvrable vs week-end

**Dans Excel** :

```
Day Type  | Sales       | Avg per Day
Weekday   | $24,500,000 | $87,456
Weekend   | $4,858,677  | $56,789
```

**üí° Insight** : Ventes 54% plus √©lev√©es les jours ouvrables (B2B ?)

#### 9.2 Impact des jours f√©ri√©s

```
Period Type        | Avg Daily Sales
Normal Weekday     | $87,456
Holiday Eve        | $123,789  (+41% !)
Holiday            | $12,345   (-86%)
Post-Holiday       | $98,456   (+13%)
```

**üí° Insight** : Pic la veille des jours f√©ri√©s, creux pendant

#### 9.3 Performance par p√©riode marketing

```
Marketing Period   | Sales       | % of Total
No√´l               | $8,456,789  | 28.8%
Soldes √ât√©         | $4,234,567  | 14.4%
Black Friday       | $3,123,456  | 10.6%
Rentr√©e Scolaire   | $2,456,789  | 8.4%
Standard           | $11,087,076 | 37.8%
```

**üí° Insight** : 3 p√©riodes = 54% du CA annuel !

---

### üìä CONCLUSION DU SC√âNARIO 11

#### Ce que vous avez appris :

‚úÖ **CALENDAR / CALENDARAUTO** : G√©n√©rer table de dates  
‚úÖ **Colonnes personnalis√©es** : Ann√©e fiscale, semaines, trimestres  
‚úÖ **Jours f√©ri√©s** : Marquer √©v√©nements sp√©ciaux  
‚úÖ **P√©riodes marketing** : Segmentation temporelle m√©tier  
‚úÖ **Colonnes de tri** : Ordre correct pour mois/jours  
‚úÖ **Marquer comme table de dates** : Activer Time Intelligence  
‚úÖ **Migration** : Remplacer table existante progressivement

#### Pattern Table de Dates

```
1. Cr√©er table avec CALENDAR
2. Ajouter colonnes standard (Year, Month, Quarter...)
3. Ajouter colonnes fiscales si n√©cessaire
4. Marquer jours sp√©ciaux (f√©ri√©s, week-end)
5. Cr√©er colonnes de tri
6. √âtablir relation avec tables de faits
7. Marquer comme table de dates
8. Tester Time Intelligence
```

#### Colonnes essentielles √† avoir

**Minimum vital** :

- Date (PK)
- Year, Quarter, Month, Day
- Year Month (pour axes)
- Colonnes de tri

**Recommand√©** :

- Ann√©e fiscale si applicable
- Is Weekend, Is Holiday
- Week Number
- Day of Year

**Avanc√©** :

- P√©riodes marketing
- Indicateurs relatifs (Is Today, Is Current Month...)
- Days from Today

#### Prochaine √©tape :

‚Üí Sc√©nario 12 : Table d'analyse ABC/Pareto avec classification dynamique

---

## SC√âNARIO 12 : Table d'Analyse ABC (Pareto) avec Classification Dynamique

### üìã Contexte M√©tier

**Persona** : St√©phane, Responsable Supply Chain  
**Besoin** : "Je veux classifier mes produits selon le principe de Pareto (80/20) :

- **Classe A** : Produits strat√©giques (80% du CA)
- **Classe B** : Produits interm√©diaires (15% du CA)
- **Classe C** : Produits marginaux (5% du CA)

Je veux aussi pouvoir ajuster dynamiquement les seuils."

**Objectif p√©dagogique** :

- Cr√©er une table d'analyse avec cumuls
- Calculer pourcentages cumul√©s
- Classifier selon Pareto
- Utiliser table de param√®tres pour seuils dynamiques
- Analyser la distribution des produits

---

### √âtape 1 : Cr√©er la table d'analyse produits

**üéØ Type d'objet : üìã TABLE CALCUL√âE**

#### 1.1 Table de base avec ventes par produit

```dax
Product ABC Analysis = 
    ADDCOLUMNS(
        VALUES(DimProduct[ProductKey]),
        "Product Name", CALCULATE(MAX(DimProduct[EnglishProductName])),
        "Total Sales", CALCULATE(SUM(FactInternetSales[SalesAmount])),
        "Total Quantity", CALCULATE(SUM(FactInternetSales[OrderQuantity])),
        "Order Count", CALCULATE(COUNTROWS(FactInternetSales))
    )
```

**R√©sultat** :

```
ProductKey | Product Name           | Total Sales | Total Qty | Order Count
310        | Mountain-100 Silver    | $1,912,674  | 236       | 236
311        | Mountain-100 Black     | $1,834,567  | 198       | 198
322        | Road-250 Red           | $1,234,567  | 145       | 145
...
```

---

### √âtape 2 : Ajouter le classement et cumuls

**üéØ Type d'objet : üìè COLONNE CALCUL√âE** (dans Product ABC Analysis)

#### 2.1 Rang par ventes

```dax
Sales Rank = 
    RANKX(
        ALL('Product ABC Analysis'),
        'Product ABC Analysis'[Total Sales],
        ,
        DESC,
        DENSE
    )
```

**R√©sultat** : 1 = produit avec ventes les plus √©lev√©es

#### 2.2 Pourcentage des ventes totales

```dax
Sales % = 
    VAR ProductSales = 'Product ABC Analysis'[Total Sales]
    VAR TotalSales = 
        CALCULATE(
            SUM('Product ABC Analysis'[Total Sales]),
            ALL('Product ABC Analysis')
        )
    RETURN
        DIVIDE(ProductSales, TotalSales)
```

#### 2.3 Cumul des ventes

**M√©thode** : Somme de toutes les ventes des produits avec rang ‚â§ rang actuel

```dax
Cumulative Sales = 
    VAR CurrentRank = 'Product ABC Analysis'[Sales Rank]
    RETURN
        CALCULATE(
            SUM('Product ABC Analysis'[Total Sales]),
            FILTER(
                ALL('Product ABC Analysis'),
                'Product ABC Analysis'[Sales Rank] <= CurrentRank
            )
        )
```

#### 2.4 Pourcentage cumul√©

```dax
Cumulative % = 
    VAR CumulativeSales = 'Product ABC Analysis'[Cumulative Sales]
    VAR TotalSales = 
        CALCULATE(
            SUM('Product ABC Analysis'[Total Sales]),
            ALL('Product ABC Analysis')
        )
    RETURN
        DIVIDE(CumulativeSales, TotalSales)
```

**R√©sultat** :

```
Rank | Product Name        | Sales     | Sales % | Cumul %
1    | Mountain-100 Silver | $1,912,674| 6.51%   | 6.51%
2    | Mountain-100 Black  | $1,834,567| 6.25%   | 12.76%
3    | Road-250 Red        | $1,234,567| 4.20%   | 16.96%
...
50   | Product X           | $45,678   | 0.16%   | 78.45%
51   | Product Y           | $44,123   | 0.15%   | 78.60%
...
100  | Product Z           | $12,345   | 0.04%   | 95.23%
```

---

### √âtape 3 : Classification ABC statique

**üéØ Type d'objet : üìè COLONNE CALCUL√âE**

#### 3.1 Classe ABC basique

```dax
ABC Class = 
    VAR CumulPct = 'Product ABC Analysis'[Cumulative %]
    RETURN
        SWITCH(
            TRUE(),
            CumulPct <= 0.80, "A",  -- 80% du CA
            CumulPct <= 0.95, "B",  -- 15% suivants
            "C"                      -- 5% restants
        )
```

#### 3.2 R√©sultat

```
Rank | Product Name        | Cumul % | Class
1    | Mountain-100 Silver | 6.51%   | A
2    | Mountain-100 Black  | 12.76%  | A
...
85   | Product X           | 79.85%  | A
86   | Product Y           | 80.12%  | B  ‚Üê Bascule ici
...
150  | Product Z           | 95.05%  | C  ‚Üê Bascule ici
...
```

**Distribution** :

```
Class | Count Products | % Products | Sales      | % Sales
A     | 85             | 14.0%      | $23,486,942| 80.0%
B     | 65             | 10.7%      | $4,402,802 | 15.0%
C     | 456            | 75.2%      | $1,468,934 | 5.0%
```

**üí° Principe de Pareto v√©rifi√©** : 14% des produits = 80% du CA !

---

### √âtape 4 : Seuils dynamiques avec table de param√®tres

**üéØ Type d'objet : üìã TABLE CALCUL√âE**

#### 4.1 Cr√©er une table de param√®tres pour les seuils

```dax
ABC Thresholds = 
    DATATABLE(
        "Parameter", STRING,
        "Threshold A (%)", DOUBLE,
        "Threshold B (%)", DOUBLE,
        {
            {"Conservative", 0.70, 0.90},   -- A=70%, B=20%
            {"Standard", 0.80, 0.95},       -- A=80%, B=15%
            {"Aggressive", 0.85, 0.97}      -- A=85%, B=12%
        }
    )
```

**R√©sultat** :

```
Parameter    | Threshold A | Threshold B
Conservative | 70%         | 90%
Standard     | 80%         | 95%
Aggressive   | 85%         | 97%
```

#### 4.2 Mesure pour classification dynamique

```dax
ABC Class Dynamic := 
    VAR SelectedThresholdA = SELECTEDVALUE('ABC Thresholds'[Threshold A (%)], 0.80)
    VAR SelectedThresholdB = SELECTEDVALUE('ABC Thresholds'[Threshold B (%)], 0.95)
    VAR CumulPct = 
        SELECTEDVALUE('Product ABC Analysis'[Cumulative %])
    RETURN
        SWITCH(
            TRUE(),
            CumulPct <= SelectedThresholdA, "A",
            CumulPct <= SelectedThresholdB, "B",
            "C"
        )
```

#### 4.3 Utilisation dans Excel

**Configuration** :

1. Ajouter **Slicer** sur `ABC Thresholds[Parameter]`
2. Tableau avec colonnes :
   - Product Name
   - Cumulative %
   - ABC Class Dynamic

**Test** :

```
S√©lection: Standard (80/95)
Class A: 85 produits

S√©lection: Conservative (70/90)
Class A: 65 produits  ‚Üê Moins de produits en A

S√©lection: Aggressive (85/97)
Class A: 105 produits  ‚Üê Plus de produits en A
```

---

### √âtape 5 : M√©triques d'analyse par classe

**üéØ Type d'objet : üìä MESURE**

#### 5.1 Concentration du CA

```dax
Sales Concentration A := 
    DIVIDE(
        CALCULATE(
            SUM('Product ABC Analysis'[Total Sales]),
            'Product ABC Analysis'[ABC Class] = "A"
        ),
        SUM('Product ABC Analysis'[Total Sales])
    )
```

**R√©sultat** : 0.80 (80%)

#### 5.2 Nombre de produits par classe

```dax
Product Count by Class := 
    COUNTROWS('Product ABC Analysis')
```

**Usage** : Filtrer par ABC Class pour avoir le count par classe

#### 5.3 Indicateur de rotation

```dax
Turnover Rate = 
    VAR TotalQuantity = 'Product ABC Analysis'[Total Quantity]
    VAR OrderCount = 'Product ABC Analysis'[Order Count]
    RETURN
        DIVIDE(TotalQuantity, OrderCount)  -- Unit√©s par commande
```

**Interpr√©tation** :

- √âlev√© (>5) : Produit de volume
- Faible (<2) : Produit de niche

---

### √âtape 6 : Dashboard d'analyse ABC

#### 6.1 Section 1 - Vue d'ensemble

**KPI Cards** :

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ CLASSE A         ‚îÇ ‚îÇ CLASSE B         ‚îÇ ‚îÇ CLASSE C         ‚îÇ
‚îÇ 85 produits      ‚îÇ ‚îÇ 65 produits      ‚îÇ ‚îÇ 456 produits     ‚îÇ
‚îÇ 14% du catalogue ‚îÇ ‚îÇ 11% du catalogue ‚îÇ ‚îÇ 75% du catalogue ‚îÇ
‚îÇ 80% du CA üéØ     ‚îÇ ‚îÇ 15% du CA        ‚îÇ ‚îÇ 5% du CA         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 6.2 Section 2 - Courbe de Pareto

**Graphique combin√©** :

- **Barres** : Ventes par produit (d√©croissant)
- **Ligne** : Pourcentage cumul√©

```
Sales      100%
$2M ‚îÇ‚ñà                                     ‚îÄ ‚îÄ ‚îÄ
    ‚îÇ‚ñà                               ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ       ‚Üê 80% ici
$1M ‚îÇ‚ñà                        ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ             
    ‚îÇ‚ñà‚ñà                ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                    
 $0 ‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                          
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
     P1  P10  P20  P50  P85  P150  P300  P606
```

#### 6.3 Section 3 - Matrice d√©taill√©e

```
Class | Products | Sales       | Avg Sales/Prod | Rotation | Stock Priority
A     | 85       | $23,486,942 | $276,317       | 4.2      | HAUTE ‚¨ÜÔ∏è
B     | 65       | $4,402,802  | $67,735        | 2.8      | MOYENNE ‚û°Ô∏è
C     | 456      | $1,468,934  | $3,223         | 1.2      | FAIBLE ‚¨áÔ∏è
```

---

### √âtape 7 : Recommandations par classe

#### 7.1 Cr√©er table de strat√©gies

**üéØ Type d'objet : üìã TABLE CALCUL√âE**

```dax
ABC Strategy = 
    DATATABLE(
        "Class", STRING,
        "Inventory Strategy", STRING,
        "Forecast Accuracy Target", STRING,
        "Stock Level", STRING,
        "Reorder Frequency", STRING,
        {
            {"A", "Stock toujours disponible", "¬±5%", "√âlev√©", "Hebdomadaire"},
            {"B", "Stock mod√©r√©", "¬±10%", "Moyen", "Bi-mensuel"},
            {"C", "Stock minimal / sur commande", "¬±20%", "Faible", "Mensuel"}
        }
    )
```

#### 7.2 Pour St√©phane (Supply Chain)

**Actions par classe** :

**Classe A (85 produits)** :

- ‚úÖ Stock de s√©curit√© √©lev√©
- ‚úÖ Forecast pr√©cis (¬±5%)
- ‚úÖ Monitoring quotidien
- ‚úÖ Fournisseurs multiples (risque)
- üí∞ Budget stockage : 70%

**Classe B (65 produits)** :

- ‚úÖ Stock mod√©r√©
- ‚úÖ Forecast standard (¬±10%)
- ‚úÖ Monitoring hebdomadaire
- üí∞ Budget stockage : 20%

**Classe C (456 produits)** :

- ‚úÖ Stock minimal
- ‚úÖ Commande √† la demande
- ‚úÖ Monitoring mensuel
- üí∞ Budget stockage : 10%
- ‚ö†Ô∏è Consid√©rer retrait catalogue si rotation tr√®s faible

---

### üìä CONCLUSION DU SC√âNARIO 12

#### Ce que vous avez appris :

‚úÖ **Table d'analyse** : Cr√©er avec ADDCOLUMNS et cumuls  
‚úÖ **RANKX** : Classer par importance  
‚úÖ **Cumuls** : Calculer pourcentages cumul√©s  
‚úÖ **Classification ABC** : Principe de Pareto (80/20)  
‚úÖ **Table de param√®tres** : Seuils dynamiques  
‚úÖ **Mesures conditionnelles** : Adapter selon s√©lection  
‚úÖ **Courbe de Pareto** : Visualiser concentration

#### Pattern Analyse ABC

```
1. Cr√©er table avec m√©triques cl√©s
2. Ajouter rang (RANKX)
3. Calculer cumuls et % cumul√©s
4. Classifier selon seuils
5. Cr√©er table de param√®tres pour flexibilit√©
6. Analyser distribution
7. D√©finir strat√©gies par classe
```

#### Impact m√©tier pour St√©phane

üéØ **Focus** : 14% des produits (85) = 80% du CA ‚Üí Priorit√© stock !  
üí∞ **Optimisation budget** : 70% stock sur 85 produits au lieu de 606  
‚ö†Ô∏è **Produits C** : 456 produits (75%) ne g√©n√®rent que 5% du CA  
üìâ **Action** : Analyse retrait catalogue pour produits C √† rotation nulle  
üìà **Forecast** : Pr√©cision ¬±5% sur classe A critique

---

### üìã R√âCAPITULATIF BLOC 4 : Tables Calcul√©es

#### Types de tables calcul√©es ma√Ætris√©es :

| Type             | Fonction               | Usage                     | Sc√©nario        |
| ---------------- | ---------------------- | ------------------------- | --------------- |
| **Segmentation** | ADDCOLUMNS + CALCULATE | Groupes clients RFM       | Sc√©nario 10     |
| **Dates**        | CALENDAR               | Table temporelle compl√®te | Sc√©nario 11     |
| **Analyse**      | ADDCOLUMNS + RANKX     | Classification ABC        | Sc√©nario 12     |
| **Param√®tres**   | DATATABLE              | Seuils dynamiques         | Sc√©narios 11-12 |

#### Patterns appris :

1. **Segmentation RFM** : Scores ‚Üí Segments ‚Üí Strat√©gies
2. **Table de dates** : Standard + Fiscal + Jours sp√©ciaux
3. **Analyse Pareto** : Rang ‚Üí Cumul ‚Üí Classification

#### Sc√©narios complets :

‚úÖ **Sc√©nario 10** : Segmentation RFM (Champions, Loyaux, √Ä risque...)  
‚úÖ **Sc√©nario 11** : Table de dates personnalis√©e (Fiscal, F√©ri√©s, Marketing)  
‚úÖ **Sc√©nario 12** : Analyse ABC avec seuils dynamiques


