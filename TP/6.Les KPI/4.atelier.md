# üìä GUIDE SSAS - VERSION SIMPLIFI√âE

## Cr√©ation du Cube SSAS pour D√©mo KPI

---

## üéØ ARCHITECTURE SIMPLIFI√âE

```
DW_KPI_Simple
‚îú‚îÄ DimTime (1,096 jours)
‚îú‚îÄ DimProduct (20 produits, 3 cat√©gories)
‚îú‚îÄ DimCustomer (50 clients)
‚îî‚îÄ FactSales (~50,000 transactions)
```

**Parfait pour d√©montrer TOUS les KPI !**

---

## √âTAPE 1 : CR√âER LE PROJET SSAS

### 1.1 Nouveau Projet

```
Visual Studio / SSDT
‚îî‚îÄ File > New > Project
   ‚îî‚îÄ Analysis Services Multidimensional Project
      ‚îî‚îÄ Name: KPI_Demo_Simple
      ‚îî‚îÄ Location: C:\SSAS\Projects
      ‚îî‚îÄ OK
```

---

## √âTAPE 2 : DATA SOURCE

### 2.1 Ajouter la Source

```
Solution Explorer
‚îî‚îÄ Data Sources (clic droit)
   ‚îî‚îÄ New Data Source
      ‚îî‚îÄ Next
      ‚îî‚îÄ New... (Connection Manager)
         ‚îú‚îÄ Server name: localhost (ou votre serveur)
         ‚îú‚îÄ Database: DW_KPI_Simple
         ‚îú‚îÄ Test Connection ‚Üí Success!
         ‚îî‚îÄ OK
      ‚îî‚îÄ Next
      ‚îî‚îÄ Impersonation: Use the service account
      ‚îî‚îÄ Next
      ‚îî‚îÄ Data source name: DW_KPI_Simple
      ‚îî‚îÄ Finish
```

---

## √âTAPE 3 : DATA SOURCE VIEW

### 3.1 Cr√©er la DSV

```
Data Source Views (clic droit)
‚îî‚îÄ New Data Source View
   ‚îî‚îÄ Next
   ‚îî‚îÄ Select: DW_KPI_Simple
   ‚îî‚îÄ Next
   ‚îî‚îÄ Available objects:
      ‚òë DimTime
      ‚òë DimProduct
      ‚òë DimCustomer
      ‚òë FactSales
   ‚îî‚îÄ Add > (4 tables dans included objects)
   ‚îî‚îÄ Next
   ‚îî‚îÄ Name: DSV_KPI_Simple
   ‚îî‚îÄ Finish
```

### 3.2 V√©rifier les Relations

Le diagramme doit montrer :

```
DimTime ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ
DimProduct ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ> FactSales
              ‚îÇ
DimCustomer ‚îÄ‚îÄ‚îò
```

Si relations manquantes, les ajouter manuellement :

- Glisser DimTime.TimeKey ‚Üí FactSales.TimeKey
- Glisser DimProduct.ProductKey ‚Üí FactSales.ProductKey
- Glisser DimCustomer.CustomerKey ‚Üí FactSales.CustomerKey

---

## √âTAPE 4 : CR√âER LES DIMENSIONS

### 4.1 Dimension Temps (DimTime)

```
Dimensions (clic droit) > New Dimension
‚îî‚îÄ Next
‚îî‚îÄ Use an existing table
‚îî‚îÄ Next
‚îî‚îÄ Main table: DimTime
‚îî‚îÄ Key columns: TimeKey
‚îî‚îÄ Name column: FullDate
‚îî‚îÄ Next
‚îî‚îÄ Dimension type: Time
‚îî‚îÄ Calendar time period: Date
‚îî‚îÄ Next
‚îî‚îÄ Attributes √† s√©lectionner:
   ‚òë Full Date
   ‚òë Year
   ‚òë Year Month
   ‚òë Quarter Name
   ‚òë Month Name
   ‚òë Day Of Month
‚îî‚îÄ Next
‚îî‚îÄ Dimension name: Dim Time
‚îî‚îÄ Finish
```

**Configuration des Hi√©rarchies :**

Dans Dimension Designer :

```
Hierarchies (glisser-d√©poser) :
‚îî‚îÄ Calendar (nouvelle hi√©rarchie)
   ‚îú‚îÄ Year
   ‚îú‚îÄ Quarter Name
   ‚îú‚îÄ Month Name
   ‚îî‚îÄ Full Date
```

**Propri√©t√©s importantes :**

```
DimTime (dimension)
‚îî‚îÄ Type: Time
‚îî‚îÄ Calendar: Calendar hierarchy

Year (attribut)
‚îî‚îÄ AttributeHierarchyVisible: True
‚îî‚îÄ Type: Years

Full Date (attribut)
‚îî‚îÄ Type: Date
‚îî‚îÄ KeyColumns: TimeKey
‚îî‚îÄ NameColumn: FullDate
```

### 4.2 Dimension Produit (DimProduct)

```
New Dimension
‚îî‚îÄ Next
‚îî‚îÄ Use an existing table
‚îî‚îÄ Next
‚îî‚îÄ Main table: DimProduct
‚îî‚îÄ Key: ProductKey
‚îî‚îÄ Name: ProductName
‚îî‚îÄ Next
‚îî‚îÄ Attributes:
   ‚òë Product Name
   ‚òë Product Category
   ‚òë Product Code
‚îî‚îÄ Next
‚îî‚îÄ Dimension name: Dim Product
‚îî‚îÄ Finish
```

**Cr√©er la hi√©rarchie produit :**

```
Product Hierarchy
‚îú‚îÄ Product Category
‚îî‚îÄ Product Name
```

### 4.3 Dimension Client (DimCustomer)

```
New Dimension
‚îî‚îÄ Main table: DimCustomer
‚îî‚îÄ Key: CustomerKey
‚îî‚îÄ Name: CustomerName
‚îî‚îÄ Attributes:
   ‚òë Customer Name
   ‚òë Customer Segment
   ‚òë Region
   ‚òë Country
‚îî‚îÄ Dimension name: Dim Customer
‚îî‚îÄ Finish
```

**Cr√©er la hi√©rarchie g√©ographique :**

```
Geography
‚îú‚îÄ Country
‚îú‚îÄ Region
‚îî‚îÄ Customer Name
```

---

## √âTAPE 5 : CR√âER LE CUBE

### 5.1 Nouveau Cube

```
Cubes (clic droit) > New Cube
‚îî‚îÄ Next
‚îî‚îÄ Use existing tables
‚îî‚îÄ Next
‚îî‚îÄ Measure group tables:
   ‚òë FactSales
‚îî‚îÄ Next
‚îî‚îÄ Mesures √† s√©lectionner:
   ‚òë Order Quantity (Sum)
   ‚òë Returned Quantity (Sum)
   ‚òë Customer Satisfaction Score (Average)
   ‚òë Sales Target (Sum)
   ‚òë Margin Target (Sum)
   ‚òë Gross Sales Amount (Sum)
   ‚òë Net Sales Amount (Sum)
   ‚òë Total Cost (Sum)
   ‚òë Gross Profit (Sum)
   ‚òë Fact Sales Count (Count)
‚îî‚îÄ Next
‚îî‚îÄ Dimensions existantes:
   ‚òë Dim Time
   ‚òë Dim Product
   ‚òë Dim Customer
‚îî‚îÄ Next
‚îî‚îÄ Cube name: KPI Simple Cube
‚îî‚îÄ Finish
```

### 5.2 Configurer les Mesures

Dans Cube Designer, onglet **Cube Structure** :

**Renommer les mesures :**

```
Order Quantity ‚Üí OrderQuantity
Returned Quantity ‚Üí ReturnedQuantity
Customer Satisfaction Score ‚Üí OverallSatisfactionScore
Gross Sales Amount ‚Üí GrossSalesAmount
Net Sales Amount ‚Üí NetSalesAmount
Total Cost ‚Üí TotalCost
Gross Profit ‚Üí GrossProfit
Fact Sales Count ‚Üí TransactionCount
```

**Format des mesures :**

```
NetSalesAmount
‚îî‚îÄ FormatString: #,##0

GrossProfit
‚îî‚îÄ FormatString: #,##0

OverallSatisfactionScore
‚îî‚îÄ FormatString: #.0
‚îî‚îÄ AggregateFunction: Average
```

---

## √âTAPE 6 : MESURES CALCUL√âES

Onglet **Calculations**, cliquer **New Calculated Member**.

### 6.1 Marge Pourcentage

**Explication :**  
La marge pourcentage mesure la rentabilit√© des ventes. Elle indique le pourcentage de profit r√©alis√© sur les ventes nettes.  
Formule :  
`(B√©n√©fice Brut / Ventes Netes) √ó 100`

```mdx
CREATE MEMBER CURRENTCUBE.[Measures].[Margin Percentage]
AS 
  -- ATTENTION: Pas de NULLIF en MDX!
  -- Utiliser IIF pour √©viter division par z√©ro
  IIF(
    [Measures].[NetSalesAmount] = 0,
    NULL,
    [Measures].[GrossProfit] / [Measures].[NetSalesAmount] * 100
  ),
FORMAT_STRING = "#,##0.00",
VISIBLE = 1;
```

### 6.2 Taux d'Atteinte des Ventes

**Explication :**  
Ce
 taux compare les ventes r√©elles √† l‚Äôobjectif de vente. Il montre si 
l‚Äô√©quipe commerciale a atteint, d√©pass√© ou sous-perform√© par rapport √† 
la cible.

```mdx
CREATE MEMBER CURRENTCUBE.[Measures].[Sales Achievement Rate]
AS 
  IIF(
    [Measures].[SalesTarget] = 0,
    NULL,
    [Measures].[NetSalesAmount] / [Measures].[SalesTarget]
  ),
FORMAT_STRING = "Percent",
VISIBLE = 1;
```

### 6.3 Ventes P√©riode Pr√©c√©dente (PY)

**Explication :**  
Cette mesure permet de comparer les ventes actuelles avec celles de la m√™me 
p√©riode l‚Äôann√©e pr√©c√©dente (Year-over-Year). Utile pour analyser la 
croissance.

```mdx
CREATE MEMBER CURRENTCUBE.[Measures].[Sales PY]
AS 
  (
    ParallelPeriod(
      [Dim Time].[Calendar].[Year],
      1,
      [Dim Time].[Calendar].CurrentMember
    ),
    [Measures].[NetSalesAmount]
  ),
FORMAT_STRING = "#,##0",
VISIBLE = 1;
```

### 6.4 Croissance YoY

**Explication :**  
Indique l‚Äô√©volution des ventes par rapport √† l‚Äôann√©e pr√©c√©dente en pourcentage. Positive = croissance, n√©gative = d√©croissance.

```mdx
CREATE MEMBER CURRENTCUBE.[Measures].[Sales Growth YoY]
AS 
  IIF(
    [Measures].[Sales PY] = 0,
    NULL,
    ([Measures].[NetSalesAmount] - [Measures].[Sales PY]) / [Measures].[Sales PY]
  ),
FORMAT_STRING = "Percent",
VISIBLE = 1;
```

### 6.5 Panier Moyen

**Explication :**  
Montant moyen d√©pens√© par transaction. Un indicateur cl√© pour √©valuer la valeur moyenne des achats clients.

```mdx
CREATE MEMBER CURRENTCUBE.[Measures].[Average Basket]
AS 
  IIF(
    [Measures].[TransactionCount] = 0,
    NULL,
    [Measures].[NetSalesAmount] / [Measures].[TransactionCount]
  ),
FORMAT_STRING = "#,##0.00",
VISIBLE = 1;
```

### 6.6 Taux de Retour

**Explication :**  
Proportion
 des produits retourn√©s par rapport aux quantit√©s command√©es. Un taux 
√©lev√© peut indiquer des probl√®mes de qualit√© ou de logistique.

```mdx
CREATE MEMBER CURRENTCUBE.[Measures].[Return Rate]
AS 
  IIF(
    [Measures].[OrderQuantity] = 0,
    0,
    [Measures].[ReturnedQuantity] / [Measures].[OrderQuantity]
  ),
FORMAT_STRING = "Percent",
VISIBLE = 1;
```

### 6.7 Satisfaction Achievement

**Explication :**  
Compare
 la satisfaction client r√©elle (sur 5) √† un objectif fix√© (4/5). Permet 
de voir si l‚Äôexp√©rience client atteint le niveau attendu.

```mdx
CREATE MEMBER CURRENTCUBE.[Measures].[Satisfaction Achievement]
AS 
  -- Objectif: 4.0/5
  IIF(
    [Measures].[OverallSatisfactionScore] = NULL,
    NULL,
    [Measures].[OverallSatisfactionScore] / 4.0
  ),
FORMAT_STRING = "Percent",
VISIBLE = 1;
```

---

## √âTAPE 7 : CR√âER LES KPI

Onglet **KPIs**, cliquer **New KPI**.

### 7.1 KPI Global Performance (Niveau Strat√©gique)

**Explication :**  
KPI composite qui r√©sume la performance globale de l‚Äôentreprise. Il combine
 plusieurs indicateurs cl√©s (ventes, marge, satisfaction, croissance) en
 un score unique pond√©r√©.

```
Name: Global_Performance
Associated measure group: Fact Sales

VALUE Expression:
-- Composite pond√©r√© (sans NULLIF!)
IIF(
  [Measures].[SalesTarget] = 0 OR [Measures].[Sales PY] = 0,
  0,
  (
    [Measures].[Sales Achievement Rate] * 0.4 +
    ([Measures].[Margin Percentage] / 45.0) * 0.3 +
    ([Measures].[OverallSatisfactionScore] / 5.0) * 0.2 +
    IIF([Measures].[Sales Growth YoY] < 0, 0, [Measures].[Sales Growth YoY]) * 0.1
  )
)

GOAL Expression:
1.0

STATUS Expression:
CASE
  WHEN KpiValue("Global_Performance") >= 0.95 THEN 1
  WHEN KpiValue("Global_Performance") >= 0.85 THEN 0
  ELSE -1
END

TREND Expression:
-- Comparer au trimestre pr√©c√©dent
IIF(
  (
    ParallelPeriod(
      [Dim Time].[Calendar].[Quarter],
      1,
      [Dim Time].[Calendar].CurrentMember
    ),
    KpiValue("Global_Performance")
  ) = 0,
  0,
  CASE
    WHEN KpiValue("Global_Performance") > 
         (
           ParallelPeriod(
             [Dim Time].[Calendar].[Quarter],
             1,
             [Dim Time].[Calendar].CurrentMember
           ),
           KpiValue("Global_Performance")
         ) * 1.03 THEN 1
    WHEN KpiValue("Global_Performance") < 
         (
           ParallelPeriod(
             [Dim Time].[Calendar].[Quarter],
             1,
             [Dim Time].[Calendar].CurrentMember
           ),
           KpiValue("Global_Performance")
         ) * 0.97 THEN -1
    ELSE 0
  END
)

STATUS Graphic: Gauge
TREND Graphic: Standard Arrow

Display Folder: 1 - Strategic KPIs
```

### 7.2 KPI Commercial Performance (Niveau Tactique)

**Explication :**  
Se concentre sur la performance commerciale : atteinte des objectifs de 
vente, marge r√©alis√©e et panier moyen. Utile pour les responsables 
commerciaux.

```
Name: Commercial_Performance
Associated measure group: Fact Sales

VALUE Expression:
IIF(
  [Measures].[SalesTarget] = 0,
  0,
  (
    [Measures].[Sales Achievement Rate] * 0.5 +
    ([Measures].[Margin Percentage] / 45.0) * 0.3 +
    ([Measures].[Average Basket] / 200.0) * 0.2
  )
)

GOAL Expression:
1.0

STATUS Expression:
CASE
  WHEN KpiValue("Commercial_Performance") >= 0.95 THEN 1
  WHEN KpiValue("Commercial_Performance") >= 0.85 THEN 0
  ELSE -1
END

TREND Expression:
IIF(
  (
    ParallelPeriod(
      [Dim Time].[Calendar].[Month],
      1,
      [Dim Time].[Calendar].CurrentMember
    ),
    KpiValue("Commercial_Performance")
  ) = 0,
  0,
  CASE
    WHEN KpiValue("Commercial_Performance") > 
         (ParallelPeriod([Dim Time].[Calendar].[Month], 1), KpiValue("Commercial_Performance")) * 1.02 THEN 1
    WHEN KpiValue("Commercial_Performance") < 
         (ParallelPeriod([Dim Time].[Calendar].[Month], 1), KpiValue("Commercial_Performance")) * 0.98 THEN -1
    ELSE 0
  END
)

STATUS Graphic: Traffic Light
TREND Graphic: Standard Arrow

Display Folder: 2 - Tactical KPIs
Parent KPI: Global_Performance
Weight: 0.5
```

### 7.3 KPI Customer Quality (Niveau Tactique)

**Explication :**  
Mesure la qualit√© de la relation client √† travers la satisfaction et le taux 
de retour. Un score √©lev√© indique des clients fid√®les et satisfaits.

```
Name: Customer_Quality
Associated measure group: Fact Sales

VALUE Expression:
-- Qualit√© client composite (Satisfaction + Retours)
(
  ([Measures].[OverallSatisfactionScore] / 5.0) * 0.6
  +
  (1.0 - [Measures].[Return Rate]) * 0.4
)

GOAL Expression:
0.90

STATUS Expression:
CASE
  WHEN KpiValue("Customer_Quality") >= 0.90 THEN 1
  WHEN KpiValue("Customer_Quality") >= 0.80 THEN 0
  ELSE -1
END

TREND Expression:
IIF(
  (ParallelPeriod([Dim Time].[Calendar].[Month], 1), KpiValue("Customer_Quality")) = 0,
  0,
  CASE
    WHEN KpiValue("Customer_Quality") > 
         (ParallelPeriod([Dim Time].[Calendar].[Month], 1), KpiValue("Customer_Quality")) * 1.02 THEN 1
    WHEN KpiValue("Customer_Quality") < 
         (ParallelPeriod([Dim Time].[Calendar].[Month], 1), KpiValue("Customer_Quality")) * 0.98 THEN -1
    ELSE 0
  END
)

STATUS Graphic: Faces
TREND Graphic: Standard Arrow

Display Folder: 2 - Tactical KPIs
Parent KPI: Global_Performance
Weight: 0.3
```

### 7.4 KPI Sales by Category (Niveau Op√©rationnel)

**Explication :**  
√âvalue l‚Äôatteinte des objectifs de vente par cat√©gorie de produit. Permet 
d‚Äôidentifier les cat√©gories performantes ou √† am√©liorer.

```
Name: Sales_By_Category
Associated measure group: Fact Sales

VALUE Expression:
[Measures].[Sales Achievement Rate]

GOAL Expression:
1.0

STATUS Expression:
CASE
  WHEN KpiValue("Sales_By_Category") >= 1.05 THEN 1
  WHEN KpiValue("Sales_By_Category") >= 0.95 THEN 0
  ELSE -1
END

TREND Expression:
IIF(
  (ParallelPeriod([Dim Time].[Calendar].[Month], 1), [Measures].[NetSalesAmount]) = 0,
  0,
  CASE
    WHEN [Measures].[Sales Growth YoY] > 0.15 THEN 1
    WHEN [Measures].[Sales Growth YoY] < 0.10 THEN -1
    ELSE 0
  END
)

STATUS Graphic: Road Signs
TREND Graphic: Standard Arrow

Display Folder: 3 - Operational KPIs
Parent KPI: Commercial_Performance
```

### 7.5 KPI Margin by Category (Niveau Op√©rationnel)

**Explication :**  
Compare la marge r√©alis√©e par cat√©gorie √† un objectif sp√©cifique. Chaque cat√©gorie peut avoir un objectif de marge diff√©rent.

```
Name: Margin_By_Category
Associated measure group: Fact Sales

VALUE Expression:
-- Marge r√©elle vs marge cible
IIF(
  [Dim Product].[Product Category].CurrentMember.Level.Ordinal = 0,
  -- All Products: objectif global 45%
  [Measures].[Margin Percentage] / 45.0,
  -- Par cat√©gorie avec objectifs diff√©rents
  IIF(
    [Dim Product].[Product Category].CurrentMember.Name = "√âlectronique",
    [Measures].[Margin Percentage] / 42.0,
    IIF(
      [Dim Product].[Product Category].CurrentMember.Name = "√âlectrom√©nager",
      [Measures].[Margin Percentage] / 38.0,
      [Measures].[Margin Percentage] / 48.0  -- Meubles
    )
  )
)

GOAL Expression:
1.0

STATUS Expression:
CASE
  WHEN KpiValue("Margin_By_Category") >= 1.0 THEN 1
  WHEN KpiValue("Margin_By_Category") >= 0.9 THEN 0
  ELSE -1
END

TREND Expression:
IIF(
  (ParallelPeriod([Dim Time].[Calendar].[Month], 1), KpiValue("Margin_By_Category")) = 0,
  0,
  CASE
    WHEN KpiValue("Margin_By_Category") > 
         (ParallelPeriod([Dim Time].[Calendar].[Month], 1), KpiValue("Margin_By_Category")) * 1.02 THEN 1
    WHEN KpiValue("Margin_By_Category") < 
         (ParallelPeriod([Dim Time].[Calendar].[Month], 1), KpiValue("Margin_By_Category")) * 0.98 THEN -1
    ELSE 0
  END
)

STATUS Graphic: Gauge
TREND Graphic: Standard Arrow

Display Folder: 3 - Operational KPIs
Parent KPI: Commercial_Performance
```

### 7.6 KPI Customer Satisfaction (Niveau Op√©rationnel)

**Explication :**  
Suivi simple de la satisfaction client moyenne. Objectif : maintenir un score ‚â• 4/5.

```
Name: Customer_Satisfaction
Associated measure group: Fact Sales

VALUE Expression:
[Measures].[OverallSatisfactionScore]

GOAL Expression:
4.0

STATUS Expression:
CASE
  WHEN KpiValue("Customer_Satisfaction") >= 4.0 THEN 1
  WHEN KpiValue("Customer_Satisfaction") >= 3.5 THEN 0
  ELSE -1
END

TREND Expression:
IIF(
  (ParallelPeriod([Dim Time].[Calendar].[Month], 1), [Measures].[OverallSatisfactionScore]) = 0,
  0,
  CASE
    WHEN [Measures].[OverallSatisfactionScore] > 
         (ParallelPeriod([Dim Time].[Calendar].[Month], 1), [Measures].[OverallSatisfactionScore]) * 1.05 THEN 1
    WHEN [Measures].[OverallSatisfactionScore] < 
         (ParallelPeriod([Dim Time].[Calendar].[Month], 1), [Measures].[OverallSatisfactionScore]) * 0.95 THEN -1
    ELSE 0
  END
)

STATUS Graphic: Faces
TREND Graphic: Standard Arrow

Display Folder: 3 - Operational KPIs
Parent KPI: Customer_Quality
```

### 7.7 KPI Return Rate (Niveau Op√©rationnel)

**Explication :**  
Surveille le taux de retour des produits. Un indicateur invers√© : plus le taux est bas, mieux c‚Äôest. Objectif : ‚â§ 3%.

```
Name: Return_Rate_KPI
Associated measure group: Fact Sales

VALUE Expression:
-- INVERS√â: Plus bas est mieux!
-- Objectif: max 3% de retours
IIF(
  [Measures].[OrderQuantity] = 0,
  0,
  1 - ([Measures].[Return Rate] / 0.03)
)

GOAL Expression:
1.0

STATUS Expression:
-- Invers√©: taux bas = vert
CASE
  WHEN [Measures].[Return Rate] <= 0.02 THEN 1   -- Moins de 2%: Excellent
  WHEN [Measures].[Return Rate] <= 0.03 THEN 0   -- 2-3%: OK
  ELSE -1                                          -- Plus de 3%: Rouge
END

TREND Expression:
IIF(
  (ParallelPeriod([Dim Time].[Calendar].[Month], 1), [Measures].[Return Rate]) = 0,
  0,
  CASE
    -- Tendance INVERS√âE: baisse = positif!
    WHEN [Measures].[Return Rate] < 
         (ParallelPeriod([Dim Time].[Calendar].[Month], 1), [Measures].[Return Rate]) * 0.9 THEN 1
    WHEN [Measures].[Return Rate] > 
         (ParallelPeriod([Dim Time].[Calendar].[Month], 1), [Measures].[Return Rate]) * 1.1 THEN -1
    ELSE 0
  END
)

STATUS Graphic: Reversed Gauge
TREND Graphic: Standard Arrow

Display Folder: 3 - Operational KPIs
Parent KPI: Customer_Quality
```

**R√©sum√© :**  
Les KPI sont structur√©s en trois niveaux :

- **Strat√©gique** : Vue globale pour la direction.

- **Tactique** : Focus par domaine (commercial, client).

- **Op√©rationnel** : D√©tail par cat√©gorie ou indicateur sp√©cifique.

Chaque KPI est li√© √† un parent (sauf le global) pour cr√©er une hi√©rarchie de pilotage.

---

## √âTAPE 8 : DEPLOY ET PROCESS

### 8.1 Deploy

```
Solution Explorer
‚îî‚îÄ KPI_Demo_Simple (clic droit)
   ‚îî‚îÄ Properties
      ‚îî‚îÄ Deployment
         ‚îú‚îÄ Server: localhost
         ‚îú‚îÄ Database: KPI_Demo_SSAS_Simple
         ‚îî‚îÄ OK
   ‚îî‚îÄ Deploy
```

Attendre "Deploy succeeded"

### 8.2 Process

```
Solution Explorer
‚îî‚îÄ KPI Simple Cube.cube (clic droit)
   ‚îî‚îÄ Process
      ‚îî‚îÄ Process Full
      ‚îî‚îÄ OK
      ‚îî‚îÄ Run
```

Attendre "Process succeeded"

---

## √âTAPE 9 : TESTER DANS LE BROWSER

### 9.1 Browser SSAS

```
Cube Designer
‚îî‚îÄ Onglet Browser
   ‚îî‚îÄ Reconnect (si n√©cessaire)
```

**Test 1 : Mesures de base**

```
Glisser:
- [Measures].[NetSalesAmount] dans Drop Data Fields Here
- [Dim Time].[Calendar].[Year] dans Drop Row Fields Here

R√©sultat attendu:
2022: ~8,000,000
2023: ~10,000,000
2024: ~12,000,000
```

**Test 2 : KPI Global**

```
Glisser:
- [KPIs].[Global_Performance].[Value] dans Data
- [KPIs].[Global_Performance].[Status] dans Data
- [KPIs].[Global_Performance].[Trend] dans Data
- [Dim Time].[Calendar].[Quarter Name] dans Rows

R√©sultat: Voyez les indicateurs visuels!
```

### 9.2 Test MDX

Nouvelle requ√™te MDX :

```mdx
SELECT 
  {
    [Measures].[NetSalesAmount],
    [Measures].[GrossProfit],
    [Measures].[Margin Percentage],
    [Measures].[Sales Achievement Rate]
  } ON COLUMNS,

  [Dim Time].[Calendar].[Year].Members ON ROWS

FROM [KPI Simple Cube]
```

---

## √âTAPE 10 : EXCEL

### 10.1 Connexion

```
Excel
‚îî‚îÄ Donn√©es > Obtenir des donn√©es externes
   ‚îî‚îÄ From Analysis Services
      ‚îî‚îÄ Server: localhost
      ‚îî‚îÄ Database: KPI_Demo_SSAS_Simple
      ‚îî‚îÄ Cube: KPI Simple Cube
      ‚îî‚îÄ Cr√©er PivotTable
```

### 10.2 Dashboard KPI

**Cr√©er 3 tableaux :**

**Tableau 1 : KPI Strat√©giques**

```
Lignes: [Dim Time].[Calendar].[Quarter Name]
Valeurs: 
  - [KPIs].[Global_Performance].[Value]
  - [KPIs].[Global_Performance].[Status]
```

**Tableau 2 : KPI par Cat√©gorie**

```
Lignes: [Dim Product].[Product Category]
Valeurs:
  - [Measures].[NetSalesAmount]
  - [Measures].[Margin Percentage]
  - [KPIs].[Margin_By_Category].[Status]
```

**Tableau 3 : √âvolution Temporelle**

```
Lignes: [Dim Time].[Calendar].[Month Name]
Valeurs:
  - [Measures].[NetSalesAmount]
  - [Measures].[Sales Growth YoY]
  - [KPIs].[Commercial_Performance].[Status]
```

---

## üéØ POINTS CL√âS MDX

### ‚ö†Ô∏è PAS DE NULLIF EN MDX!

**‚ùå ERREUR (ne fonctionne pas) :**

```mdx
[Measures].[A] / NULLIF([Measures].[B], 0)
```

**‚úÖ CORRECT (utiliser IIF) :**

```mdx
IIF(
  [Measures].[B] = 0,
  NULL,
  [Measures].[A] / [Measures].[B]
)
```

### Autres pi√®ges √† √©viter :

1. **Division par z√©ro :** Toujours tester avec IIF
2. **Comparaison NULL :** Utiliser `IS NULL` ou `= 0`
3. **ParallelPeriod :** Peut retourner NULL, tester avant utilisation
4. **Format_String :** Toujours entre guillemets

---

## ‚úÖ CHECKLIST FINALE

```
‚òê Base de donn√©es cr√©√©e et popul√©e
‚òê Projet SSAS cr√©√©
‚òê Data Source configur√©e
‚òê Data Source View avec 4 tables
‚òê 3 Dimensions cr√©√©es avec hi√©rarchies
‚òê Cube cr√©√© avec toutes les mesures
‚òê 7+ mesures calcul√©es (sans NULLIF!)
‚òê 7 KPI hi√©rarchiques configur√©s
‚òê Deploy r√©ussi
‚òê Process Full r√©ussi
‚òê Browser affiche des donn√©es
‚òê Excel se connecte au cube
‚òê KPI affichent des indicateurs visuels
```