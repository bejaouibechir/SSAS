# ATELIER : Mon Premier Cube OLAP

## PARTIE 1 : Connexion √† la base de donn√©es (15 min)

### √âtape 1 : Cr√©er le projet

1. Ouvrir **Visual Studio**
2. **File** ‚Üí **New** ‚Üí **Project**
3. Chercher **Analysis Services Multidimensional Project**
4. Nom du projet : `TechMartCube`
5. Cliquer **Create**
   
   

### √âtape 2 : Cr√©er la Data Source

1. Dans **Solution Explorer** (√† droite), clic droit sur **Data Sources** ‚Üí **New Data Source**
2. Clic **Next** dans l'assistant
3. Clic **New** pour cr√©er une connexion
4. Remplir :
   - **Server name** : `DESKTOP-463V422\SERVER2024`
     
     ![](D:\Formation%20BI\SSAS\Labs\0.%20Cr√©ation%20Datawarehouse\images\6.png)
   - **Database** : `DW`
5. Clic **Test Connection** ‚Üí doit afficher "Test connection succeeded"
   
   ![](D:\Formation%20BI\SSAS\Labs\0.%20Cr√©ation%20Datawarehouse\images\7.png)
6. Clic **OK** puis **Next**
7. Garder **Use the service account**
8. Clic **Next** puis **Finish**
   
   

‚úÖ **Vous avez connect√© Visual Studio √† votre DataWarehouse !**

### √âtape 3 : Cr√©er la Data Source View

1. Clic droit sur **Data Source Views** ‚Üí **New Data Source View**
   
   ![](D:\Formation%20BI\SSAS\Labs\0.%20Cr√©ation%20Datawarehouse\images\8.png)
2. Clic **Next**
3. S√©lectionner votre Data Source **DW** ‚Üí **Next**
4. Dans la liste des tables, s√©lectionner **TOUTES** les tables qui commencent par `dw_` :
   - dw.DimCampaign
   - dw.DimCustomer
   - dw.DimDate
   - dw.DimProduct
   - dw.DimStore
   - dw.DimTime
   - dw.FactProductSales
5. Cliquer **>** pour les ajouter
6. Clic **Next**
7. Nom : `DW` ‚Üí **Finish**

‚úÖ **Vous voyez maintenant le sch√©ma de votre DataWarehouse avec toutes les relations !**

---

## PARTIE 2 : Cr√©er les dimensions (20 min)

On va cr√©er 7 dimensions d'un coup avec l'assistant.

### Cr√©er toutes les dimensions

1. Clic droit sur **Dimensions** ‚Üí **New Dimension**

2. Clic **Next**

3. Cocher **Auto build** ‚Üí Clic **Next**

4. **IMPORTANT** : D√©cocher **Create attributes...** ‚Üí Clic **Next**

5. S√©lectionner **TOUTES les 7 tables** (Ctrl + clic) :
   
   - DimCampaign
   - DimCustomer
   - DimDate
   - DimProduct
   - DimStore
   - DimTime
   - (ne PAS s√©lectionner FactProductSales)
     
     ![](D:\Formation%20BI\SSAS\Labs\0.%20Cr√©ation%20Datawarehouse\images\9.png)

6. Clic **Next**

7. Pour chaque dimension, l'assistant vous demande la cl√© :
   
   - **DimCampaign** : CampaignKey
   - **DimCustomer** : CustomerKey
   - **DimDate** : DateKey
   - **DimProduct** : ProductKey
   - **DimPromotion** : PromotionKey
   - **DimStore** : StoreKey
   - **DimTime** : TimeKey
   - **DimSalesPerson** : SalesPersonKey

8. Clic **Next** puis **Finish**

‚úÖ **Vos 8 dimensions sont cr√©√©es ! Regardez dans Solution Explorer ‚Üí Dimensions**

---

## PARTIE 3 : Cr√©er le cube (15 min)

### Cr√©er le cube

1. Clic droit sur **Cubes** ‚Üí **New Cube**
2. Clic **Next**
3. **Use existing tables** ‚Üí **Next**
4. S√©lectionner **dw.FactProductSales** ‚Üí **Next**
5. L'assistant d√©tecte automatiquement les mesures. Garder toutes coch√©es :
   - Fact Product Sales Count
   - Quantity
   - Total Price
   - Unit Price
   - Discount Amount ...
6. Clic **Next**
7. Cocher **TOUTES les dimensions** ‚Üí **Next**
8. Nom du cube : `DW` ‚Üí **Finish**

‚úÖ **Votre cube est cr√©√© les mesures et les 8 dimensions !**

![](D:\Formation%20BI\SSAS\Labs\0.%20Cr√©ation%20Datawarehouse\images\10.png)

**SAUVEGARDEZ votre projet** : Ctrl + S

---

## PARTIE 4 : Cr√©er la hi√©rarchie Calendrier (20 min)

C'est la partie la plus importante ! On va cr√©er une hi√©rarchie pour naviguer dans le temps.

### Ouvrir la dimension Date

1. Dans **Solution Explorer** ‚Üí **Dimensions**
2. Double-cliquer sur **Dim Date.dim**
3. Vous voyez maintenant tous les attributs de la dimension

### Cr√©er la hi√©rarchie

1. Dans le panneau du milieu, sous "Hierarchies", clic droit ‚Üí **New Hierarchy**
2. Une nouvelle hi√©rarchie appara√Æt : `Hierarchy`
3. Renommer en **Calendrier** (clic droit ‚Üí Rename)

### Glisser-d√©poser les niveaux

Depuis le panneau "Attributes" (√† gauche), **glisser-d√©poser** dans cet ordre dans la hi√©rarchie "Calendrier" et renommer les :

1. Year Number: **Year** ‚Üí devient le niveau 1
2. Quarter Number: **Quarter** ‚Üí devient le niveau 2
3. Quanrter Month: **Month** ‚Üí devient le niveau 3
4. **Date BK** ‚Üí devient le niveau 4

### Cr√©er les relations entre attributs

**TR√àS IMPORTANT pour les performances** : dire √† SSAS que Ann√©e ‚Üí Trimestre ‚Üí Mois ‚Üí Jour

1. Aller dans l'onglet **Attribute Relationships** (en bas)
   
   ![](D:\Formation%20BI\SSAS\Labs\0.%20Cr√©ation%20Datawarehouse\images\11.png)
2. Vous voyez tous les attributs reli√©s √† `Date Key`
3. On va modifier √ßa :

**Relations √† cr√©er** :

- Clic droit sur **Year** ‚Üí **New Attribute Relationship**
  - Related Attribute : **Quarter** ‚Üí OK
- Clic droit sur **Quarter** ‚Üí **New Attribute Relationship**
  - Related Attribute : **Month** ‚Üí OK
- Clic droit sur **Month** ‚Üí **New Attribute Relationship**
  - Related Attribute : **Day Of Month** ‚Üí OK
    
    ![](D:\Formation%20BI\SSAS\Labs\0.%20Cr√©ation%20Datawarehouse\images\12.png)

‚úÖ **Votre hi√©rarchie Calendrier est pr√™te !**

**SAUVEGARDEZ** : Ctrl + S

---

## PARTIE 5 : D√©ployer et tester (20 min)

### D√©ployer le cube

1. Clic droit sur le projet `TechMartCube` ‚Üí **Properties**
2. Dans **Deployment** :
   - **Server** : `DESKTOP-463V422\SERVER2024`
   - **Database** : `DW`
3. Clic **OK**
4. Clic droit sur le projet ‚Üí **Deploy**

‚è≥ **Attendez que le d√©ploiement se termine** (1-2 minutes)

Vous devez voir en bas : `Deploy Completed Successfully`

![](D:\Formation%20BI\SSAS\Labs\0.%20Cr√©ation%20Datawarehouse\images\13.png)

### Interroger le cube

1. Dans **Solution Explorer**, double-cliquer sur **DW.cube** (votre cube)
2. Aller dans l'onglet **Browser** (en haut)
3. Si demand√©, cliquer **Reconnect**

![](D:\Formation%20BI\SSAS\Labs\0.%20Cr√©ation%20Datawarehouse\images\14.png)

### Votre premi√®re requ√™te !

**Dans la zone de droite** :

1. D√©velopper **Dim Date**
2. D√©velopper **Calendrier** (votre hi√©rarchie)
3. **Glisser "Calendrier"** dans la zone **rows** (lignes)

**Dans Measures** :
4. **Glisser "Total Price"** dans la zone du milieu

üéâ **Vous voyez vos ventes par ann√©e, trimestre, mois et jour !**

### Tester la navigation

- Cliquer sur le **+** devant une ann√©e pour voir les trimestres
- Cliquer sur le **+** devant un trimestre pour voir les mois
- Cliquer sur le **+** devant un mois pour voir les jours

### 

## 

## EXERCICE BONUS (si vous avez le temps)

### Cr√©er une deuxi√®me hi√©rarchie : G√©ographie des magasins

1. Ouvrir **Dim Store.dim**
2. Cr√©er une hi√©rarchie **G√©ographie**
3. Ajouter les niveaux dans cet ordre :
   - Country
   - Region
   - City
   - Store Name
4. Cr√©er les relations entre attributs
5. D√©ployer
6. Tester dans le Browser avec Total Price



- 

**F√©licitations ! Vous avez cr√©√© votre premier cube OLAP ! üéä**
