# ATELIER 2 : LES RELATIONS DIMENSION-MESURE - PRATIQUE SSDT

## üìã CE QUE VOUS ALLEZ FAIRE

1. Explorer les relations Regular (d√©j√† en place)
2. Cr√©er une dimension Fact (Degenerate Dimension)
3. Cr√©er une relation Referenced (Snowflake)
4. Configurer une relation Many-to-Many
5. Comprendre les Factless Fact Tables

---

## LES 4 TYPES DE RELATIONS

| Type             | Description                                 | Exemple                                            |
| ---------------- | ------------------------------------------- | -------------------------------------------------- |
| **Regular**      | Relation directe FK ‚Üí PK                    | FactProductSales.ProductSK ‚Üí DimProduct.ProductSK  |
| **Fact**         | Colonne de la Fact utilis√©e comme dimension | SalesInvoiceNumber dans FactProductSales           |
| **Referenced**   | Dimension de 2√®me niveau (Snowflake)        | FactProductSales ‚Üí DimProduct ‚Üí DimProductCategory |
| **Many-to-Many** | Table de liaison entre dimensions           | FactPromotionPerProduct (Promotion ‚Üî Product)      |

---

## PARTIE 1 : EXPLORER LES RELATIONS REGULAR (15 min)

### EXERCICE 1.1 : Examiner les relations existantes

**√âtapes SSDT :**

1. Ouvrir `Cube.cube` ‚Üí Onglet **Dimension Usage**
2. Vous voyez une grille avec :
   - **Colonnes** : Measure Groups (Fact Product Sales, Fact Promotion Per Product)
   - **Lignes** : Dimensions (Dim Customer, Dim Product, etc.)
   - **Cellules** : Type de relation

**Ce que vous voyez actuellement :**

```
                        | Fact Product Sales | Fact Promotion Per Product
------------------------|--------------------|--------------------------
Dim Customer            | Regular            | No Relationship
Dim Product             | Regular            | Regular
Dim Date                | Regular            | No Relationship
Dim Promotion           | Regular            | Regular
Dim Store               | Regular            | No Relationship
Dim Sales Person        | Regular            | No Relationship
Dim Campaign            | Regular            | No Relationship
Dim Time                | Regular            | No Relationship
```

### EXERCICE 1.2 : Examiner une relation Regular

1. Cliquer sur la cellule **Dim Product** √ó **Fact Product Sales**
2. Un bouton [...] appara√Æt ‚Üí Cliquer dessus
3. La fen√™tre **Define Relationship** s'ouvre

**Ce que vous voyez :**

| Champ                     | Valeur    |
| ------------------------- | --------- |
| **Relationship type**     | Regular   |
| **Granularity attribute** | Product   |
| **Measure group columns** | ProductSK |
| **Dimension columns**     | ProductSK |

**Explication** : C'est une relation FK ‚Üí PK classique

4. Cliquer **Cancel** (ne pas modifier)

‚úÖ **Toutes les relations actuelles sont Regular**

---

## PARTIE 2 : CR√âER UNE DIMENSION FACT (45 min)

### Qu'est-ce qu'une dimension Fact ?

Une **dimension Fact** (ou **Degenerate Dimension**) est une colonne de la table de faits qui sert de dimension sans avoir de table de dimension d√©di√©e.

**Exemple** : `SalesInvoiceNumber` dans FactProductSales

- Chaque vente a un num√©ro de facture
- Pas besoin d'une table DimInvoice s√©par√©e
- On utilise directement la colonne de la Fact

---

### EXERCICE 2.1 : V√©rifier que la colonne existe

**Dans SSMS :**

```sql
USE DW;
GO

-- V√©rifier la colonne SalesInvoiceNumber
SELECT TOP 10
    SalesInvoiceNumber,
    InvoiceLineNumber,
    ProductSK,
    Quantity,
    TotalAmount
FROM dw.FactProductSales
ORDER BY SalesInvoiceNumber;
```

**R√©sultat attendu :**

```
SalesInvoiceNumber | InvoiceLineNumber | ProductSK | Quantity | TotalAmount
-------------------|-------------------|-----------|----------|-------------
INV-000001         | 1                 | 5         | 2        | 1500.00
INV-000001         | 2                 | 8         | 1        | 800.00
INV-000002         | 1                 | 3         | 5        | 2500.00
```

‚úÖ **La colonne existe et contient des valeurs**

---

### EXERCICE 2.2 : Cr√©er la dimension dans SSDT

#### √âtape 1 : Cr√©er une nouvelle dimension

1. Dans Solution Explorer ‚Üí Clic droit sur **Dimensions** ‚Üí **New Dimension**

2. Wizard : **Welcome** ‚Üí Cliquer **Next**

3. **Select Creation Method** :
   
   - S√©lectionner **Use an existing table**
   - Cliquer **Next**

4. **Specify Source Information** :
   
   - Data source view : **DW**
   - Main table : S√©lectionner **dw_FactProductSales**
   - Key columns : Cocher **SalesInvoiceNumber**
   - Name column : S√©lectionner **SalesInvoiceNumber**
   - Cliquer **Next**

5. **Select Related Tables** :
   
   - Ne rien cocher (c'est une dimension degener√©e, pas de table li√©e)
   - Cliquer **Next**

6. **Select Dimension Attributes** :
   
   - Cocher seulement **Sales Invoice Number**
   - Cliquer **Next**

7. **Completing the Wizard** :
   
   - Dimension name : `Dim Sales Invoice`
   - Cliquer **Finish**

#### √âtape 2 : Nettoyer la dimension

Une nouvelle dimension appara√Æt : `Dim Sales Invoice.dim`

1. Double-cliquer dessus pour l'ouvrir
2. Dans l'onglet **Dimension Structure** :
   - Vous voyez l'attribut **Sales Invoice Number**
3. Pas besoin de modifier quoi que ce soit

#### √âtape 3 : Ajouter la dimension au cube

1. Ouvrir `Cube.cube` ‚Üí Onglet **Cube Structure**
2. Dans le panneau **Dimensions** (√† gauche), clic droit ‚Üí **Add Cube Dimension**
3. S√©lectionner **Dim Sales Invoice** ‚Üí **OK**

La dimension appara√Æt dans la liste des dimensions du cube.

---

### EXERCICE 2.3 : Configurer la relation Fact

1. Onglet **Dimension Usage**

2. Localiser la ligne **Dim Sales Invoice**

3. Cliquer sur la cellule **Dim Sales Invoice** √ó **Fact Product Sales**

4. Cliquer sur le bouton [...]

5. Dans la fen√™tre **Define Relationship** :

| Champ                        | Valeur √† s√©lectionner |
| ---------------------------- | --------------------- |
| **Select relationship type** | **Fact**              |
| **Granularity attribute**    | Sales Invoice Number  |
| **Dimension columns**        | SalesInvoiceNumber    |

6. Cliquer **OK**

**Important** : Notez que la cellule affiche maintenant **Fact** au lieu de Regular.

---

### EXERCICE 2.4 : D√©ployer et tester

1. **Deploy Solution**

2. Onglet **Browser** ‚Üí **Reconnect**

3. Cr√©er ce rapport :
   
   - **Rows** : Dim Sales Invoice ‚Üí Sales Invoice Number
   - **Values** : Quantity, Total Amount
   - Filtrer pour voir seulement les 20 premi√®res factures

**R√©sultat attendu :**

```
Sales Invoice Number | Quantity | Total Amount
---------------------|----------|-------------
INV-000001           | 3        | 2,300.00
INV-000002           | 5        | 2,500.00
INV-000003           | 2        | 1,800.00
```

‚úÖ **Vous pouvez maintenant analyser par facture sans table de dimension d√©di√©e !**

**Test suppl√©mentaire :**

- Rows : Product Name
- Columns : Sales Invoice Number (glisser 3-4 factures)
- Values : Quantity

Vous voyez la r√©partition des produits par facture.

---

## PARTIE 3 : CR√âER UNE RELATION REFERENCED (1h00)

### Qu'est-ce qu'une relation Referenced ?

Une **relation Referenced** (ou **Snowflake**) est une dimension de 2√®me niveau qui n'est pas directement li√©e √† la Fact.

**Exemple** : FactProductSales ‚Üí DimProduct ‚Üí DimProductCategory

---

### EXERCICE 3.1 : Cr√©er la table DimProductCategory dans la base

**Dans SSMS :**

```sql
USE DW;
GO

-- Cr√©er la table de cat√©gories
CREATE TABLE dw.DimProductCategory (
    ProductCategorySK INT IDENTITY(1,1) PRIMARY KEY,
    ProductCategoryBK INT NOT NULL UNIQUE,
    CategoryName NVARCHAR(100) NOT NULL,
    CategoryDescription NVARCHAR(500) NULL
);
GO

-- Ins√©rer des cat√©gories
INSERT INTO dw.DimProductCategory (ProductCategoryBK, CategoryName, CategoryDescription)
VALUES 
    (1, 'Laptops', 'Portable computers with high performance'),
    (2, 'Desktops', 'Stationary computers for office and home'),
    (3, 'Tablets', 'Touchscreen portable devices'),
    (4, 'Smartphones', 'Mobile phones with advanced features'),
    (5, 'Accessories', 'Computer peripherals and add-ons'),
    (6, 'Components', 'Internal computer parts'),
    (7, 'Software', 'Operating systems and applications');
GO

-- Ajouter la colonne FK dans DimProduct
ALTER TABLE dw.DimProduct 
ADD ProductCategorySK INT NULL;
GO

-- Ajouter la contrainte FK
ALTER TABLE dw.DimProduct
ADD CONSTRAINT FK_Product_Category 
FOREIGN KEY (ProductCategorySK) 
REFERENCES dw.DimProductCategory(ProductCategorySK);
GO

-- Assigner des cat√©gories aux produits existants (bas√© sur le nom du produit)
UPDATE dw.DimProduct
SET ProductCategorySK = 
    CASE 
        WHEN ProductName LIKE '%Laptop%' THEN 1
        WHEN ProductName LIKE '%Desktop%' THEN 2
        WHEN ProductName LIKE '%Tablet%' THEN 3
        WHEN ProductName LIKE '%Phone%' OR ProductName LIKE '%Smartphone%' THEN 4
        WHEN ProductName LIKE '%Mouse%' OR ProductName LIKE '%Keyboard%' OR ProductName LIKE '%Monitor%' THEN 5
        WHEN ProductName LIKE '%RAM%' OR ProductName LIKE '%SSD%' OR ProductName LIKE '%CPU%' THEN 6
        ELSE 7
    END;
GO

-- V√©rifier
SELECT 
    p.ProductName,
    pc.CategoryName
FROM dw.DimProduct p
LEFT JOIN dw.DimProductCategory pc ON p.ProductCategorySK = pc.ProductCategorySK
ORDER BY pc.CategoryName, p.ProductName;
```

‚úÖ **Ex√©cuter tout le script et v√©rifier que la derni√®re requ√™te retourne des produits avec leurs cat√©gories**

---

### EXERCICE 3.2 : Ajouter la table √† la DSV

**Dans SSDT :**

1. Solution Explorer ‚Üí Double-clic sur `DW.dsv`

2. Menu ‚Üí **Table** ‚Üí **Add/Remove Tables**

3. Dans la fen√™tre :
   
   - **Available objects** : Localiser `dw.DimProductCategory`
   - Cliquer sur **>** pour l'ajouter √† **Included objects**
   - Cliquer **OK**

4. La table `DimProductCategory` appara√Æt dans le diagramme

5. **V√©rifier la relation** :
   
   - Clic droit sur `DimProduct` ‚Üí **Refresh Table**
   - Une ligne de relation devrait appara√Ætre entre `DimProduct` et `DimProductCategory`
   - Si elle n'appara√Æt pas automatiquement, faites :
     - Clic droit dans le diagramme ‚Üí **Add/Remove Tables** ‚Üí Re-s√©lectionner les deux tables ‚Üí OK

6. **Sauvegarder** la DSV (Ctrl+S)

---

### EXERCICE 3.3 : Cr√©er la dimension Product Category

1. Solution Explorer ‚Üí Clic droit sur **Dimensions** ‚Üí **New Dimension**
2. **Use an existing table** ‚Üí Next
3. Main table : **dw_DimProductCategory**
4. Key columns : **ProductCategorySK**
5. Name column : **CategoryName**
6. Next ‚Üí Next
7. Select attributes : Cocher **Category Name** et **Category Description**
8. Next ‚Üí Dimension name : `Dim Product Category` ‚Üí Finish

---

### EXERCICE 3.4 : Ajouter la dimension au cube

1. Ouvrir `Cube.cube` ‚Üí **Cube Structure**
2. Panneau Dimensions ‚Üí Clic droit ‚Üí **Add Cube Dimension**
3. S√©lectionner **Dim Product Category** ‚Üí OK

---

### EXERCICE 3.5 : Configurer la relation Referenced

**√âtapes cruciales :**

1. Onglet **Dimension Usage**

2. Localiser la ligne **Dim Product Category**

3. Cliquer sur la cellule **Dim Product Category** √ó **Fact Product Sales**

4. Cliquer [...]

5. Dans **Define Relationship** :

| Champ                                | Valeur                        |
| ------------------------------------ | ----------------------------- |
| **Select relationship type**         | **Referenced**                |
| **Intermediate dimension**           | **Dim Product** ‚Üê Important ! |
| **Reference dimension attribute**    | Category Name                 |
| **Intermediate dimension attribute** | Product                       |

**Explication** :

- Fact ‚Üí Dim Product (Regular)

- Dim Product ‚Üí Dim Product Category (Referenced via Intermediate)
6. Cliquer **OK**

La cellule affiche maintenant **Referenced**.

---

### EXERCICE 3.6 : D√©ployer et tester

1. **Deploy Solution**

2. **Browser** ‚Üí **Reconnect**

3. Test 1 : Par cat√©gorie
   
   - **Rows** : Dim Product Category ‚Üí Category Name
   - **Values** : Quantity, Total Amount

**R√©sultat attendu :**

```
Category Name | Quantity | Total Amount
--------------|----------|-------------
Laptops       | 5,234    | 2,345,678.00
Tablets       | 3,456    | 1,234,567.00
Smartphones   | 2,789    | 987,654.00
```

4. Test 2 : Drill-down cat√©gorie ‚Üí produit
   - **Rows** : Category Name, Product Name (hi√©rarchie)
   - **Values** : Total Amount

**R√©sultat attendu :**

```
Category Name    Product Name        | Total Amount
------------------|--------------------|-------------
+ Laptops                             | 2,345,678.00
  - Laptop Elite                      | 1,234,567.00
  - Laptop Pro                        | 678,901.00
+ Tablets                             | 1,234,567.00
  - Tablet Pro                        | 789,012.00
```

‚úÖ **Vous pouvez maintenant analyser par cat√©gorie sans lien direct √† la Fact !**

---

## PARTIE 4 : RELATION MANY-TO-MANY (45 min)

### Qu'est-ce qu'une relation Many-to-Many ?

**Sc√©nario** : Une promotion peut s'appliquer √† plusieurs produits, et un produit peut avoir plusieurs promotions actives.

**Solution** : Table de liaison `FactPromotionPerProduct`

- PromotionSK (FK ‚Üí DimPromotion)
- ProductSK (FK ‚Üí DimProduct)

**C'est une Factless Fact Table** : Pas de mesures num√©riques, juste des relations.

---

### EXERCICE 4.1 : V√©rifier les donn√©es

**Dans SSMS :**

```sql
-- V√©rifier la structure de FactPromotionPerProduct
SELECT TOP 20
    fpp.PromotionSK,
    pr.PromotionName,
    fpp.ProductSK,
    p.ProductName,
    fpp.StartDate,
    fpp.EndDate,
    fpp.IsActive
FROM dw.FactPromotionPerProduct fpp
INNER JOIN dw.DimPromotion pr ON fpp.PromotionSK = pr.PromotionSK
INNER JOIN dw.DimProduct p ON fpp.ProductSK = p.ProductSK
ORDER BY pr.PromotionName, p.ProductName;
```

**Si la table est vide, ins√©rer des donn√©es :**

```sql
-- Ins√©rer des relations promotion-produit
DECLARE @StartDate DATE = '2024-01-01';
DECLARE @EndDate DATE = '2024-12-31';

-- Promotion 1 sur plusieurs produits
INSERT INTO dw.FactPromotionPerProduct (PromotionSK, ProductSK, StartDate, EndDate, IsActive, ETL_InsertedDate, ETL_SourceSystem)
SELECT 
    1 AS PromotionSK,
    ProductSK,
    @StartDate,
    @EndDate,
    1 AS IsActive,
    GETDATE(),
    'Manual'
FROM dw.DimProduct
WHERE ProductSK IN (1, 2, 3, 4, 5);

-- Promotion 2 sur d'autres produits
INSERT INTO dw.FactPromotionPerProduct (PromotionSK, ProductSK, StartDate, EndDate, IsActive, ETL_InsertedDate, ETL_SourceSystem)
SELECT 
    2 AS PromotionSK,
    ProductSK,
    @StartDate,
    @EndDate,
    1 AS IsActive,
    GETDATE(),
    'Manual'
FROM dw.DimProduct
WHERE ProductSK IN (3, 4, 5, 6, 7);

-- Promotion 3 sur encore d'autres produits
INSERT INTO dw.FactPromotionPerProduct (PromotionSK, ProductSK, StartDate, EndDate, IsActive, ETL_InsertedDate, ETL_SourceSystem)
SELECT 
    3 AS PromotionSK,
    ProductSK,
    @StartDate,
    @EndDate,
    1 AS IsActive,
    GETDATE(),
    'Manual'
FROM dw.DimProduct
WHERE ProductSK IN (1, 6, 7, 8);

-- V√©rifier
SELECT 
    pr.PromotionName,
    COUNT(DISTINCT fpp.ProductSK) AS NbProducts
FROM dw.FactPromotionPerProduct fpp
INNER JOIN dw.DimPromotion pr ON fpp.PromotionSK = pr.PromotionSK
GROUP BY pr.PromotionName;
```

‚úÖ **Vous devez voir au moins 3 promotions avec plusieurs produits chacune**

---

### EXERCICE 4.2 : Examiner le Measure Group existant

**Dans SSDT :**

1. Ouvrir `Cube.cube` ‚Üí **Cube Structure**
2. Dans le panneau **Measures**, d√©velopper **Fact Promotion Per Product**
3. Vous voyez : `Fact Promotion Per Product Nombre` (Count)

**C'est une Factless Fact Table** : La seule mesure est le comptage des relations.

---

### EXERCICE 4.3 : Configurer la relation Many-to-Many

1. Onglet **Dimension Usage**
2. Localiser **Measure Group** : **Fact Promotion Per Product**

**Actuellement, vous voyez :**

```
                        | Fact Promotion Per Product
------------------------|---------------------------
Dim Product             | Regular
Dim Promotion           | Regular
```

**Objectif** : Cr√©er une relation M2M pour analyser les promotions via les ventes de produits.

3. Localiser la ligne **Dim Promotion**

4. Cliquer sur la cellule **Dim Promotion** √ó **Fact Product Sales** (pas Fact Promotion Per Product !)

5. Cliquer [...]

6. Dans **Define Relationship** :

| Champ                          | Valeur                         |
| ------------------------------ | ------------------------------ |
| **Select relationship type**   | **Many-to-Many**               |
| **Intermediate measure group** | **Fact Promotion Per Product** |

**Explication** :

- Fact Product Sales ‚Üí Dim Promotion : via FactPromotionPerProduct (table de liaison)

- Permet d'analyser les ventes par promotion m√™me si la promotion n'est pas directement li√©e √† chaque vente
7. Cliquer **OK**

La cellule affiche **Many-to-Many**.

---

### EXERCICE 4.4 : D√©ployer et tester

1. **Deploy Solution**

2. **Browser** ‚Üí **Reconnect**

3. Test Many-to-Many :
   
   - **Rows** : Dim Promotion ‚Üí Promotion Name
   - **Values** : Total Amount (depuis Fact Product Sales)

**Ce que vous voyez (MAGIE !) :**

```
Promotion Name          | Total Amount
------------------------|-------------
Black Friday Sale       | 3,456,789.00
Summer Discount         | 2,345,678.00
New Year Special        | 1,234,567.00
```

**Explication** :

- SSAS calcule automatiquement les ventes totales des produits qui ont ces promotions

- M√™me si FactProductSales n'a pas de lien direct avec Promotion

- Passage par FactPromotionPerProduct (table de liaison)
4. Test drill-down :
   - **Rows** : Promotion Name, Product Name
   - **Values** : Total Amount

```
Promotion Name          Product Name    | Total Amount
------------------------|-----------------|-------------
+ Black Friday Sale                      | 3,456,789.00
  - Laptop Elite                         | 1,234,567.00
  - Tablet Pro                           | 987,654.00
  - Smartphone X                         | 765,432.00
```

‚úÖ **La relation Many-to-Many fonctionne !**

---

### EXERCICE 4.5 : Comprendre le Factless Fact Table

1. **Browser** ‚Üí S√©lectionner **Measure Group** : **Fact Promotion Per Product**
2. Cr√©er ce rapport :
   - **Rows** : Dim Promotion ‚Üí Promotion Name
   - **Values** : Fact Promotion Per Product Nombre

**R√©sultat :**

```
Promotion Name          | Fact Promotion Per Product Nombre
------------------------|----------------------------------
Black Friday Sale       | 5
Summer Discount         | 5
New Year Special        | 4
```

**Explication** :

- Cette mesure compte le nombre de relations promotion-produit
- C'est le seul contenu de cette Fact (pas de ventes, pas de montants)
- D'o√π le nom **Factless** : Fact sans mesures m√©tier

---

## PARTIE 5 : VALIDATION FINALE (15 min)

### EXERCICE 5.1 : Rapport complet avec les 4 types

Cr√©er un rapport qui utilise les 4 types de relations :

**Configuration :**

- **Rows** :
  1. Category Name (Referenced)
  2. Product Name (Regular)
- **Columns** :
  1. Promotion Name (Many-to-Many)
- **Filter** :
  1. Sales Invoice Number : S√©lectionner 5 factures (Fact)
- **Values** :
  1. Quantity
  2. Total Amount

**Actions :**

1. Glisser Category Name dans Rows
2. Glisser Product Name sous Category Name
3. Glisser Promotion Name dans Columns
4. Glisser Sales Invoice Number dans Filter ‚Üí S√©lectionner 5 factures
5. Glisser Quantity et Total Amount dans Values

**R√©sultat attendu : Un croisement complexe utilisant les 4 relations**

---

### EXERCICE 5.2 : Quiz de validation

**Cochez les affirmations correctes :**

- [ ] Une relation Regular n√©cessite une FK dans la Fact
- [ ] Une dimension Fact a sa propre table de dimension
- [ ] Une relation Referenced passe par une dimension interm√©diaire
- [ ] Une relation Many-to-Many n√©cessite une table de liaison
- [ ] Un Factless Fact Table n'a aucune mesure
- [ ] On peut avoir plusieurs relations entre une Fact et une Dimension

**R√©ponses :** 1-‚úÖ, 2-‚ùå, 3-‚úÖ, 4-‚úÖ, 5-‚ùå (Count), 6-‚ùå

---

## PARTIE 6 : DIMENSION USAGE - VUE D'ENSEMBLE

### EXERCICE 6.1 : Examiner la grille finale

Onglet **Dimension Usage** ‚Üí Voici ce que vous devez voir maintenant :

```
                        | Fact Product Sales | Fact Promotion Per Product
------------------------|--------------------|--------------------------
Dim Customer            | Regular            | No Relationship
Dim Product             | Regular            | Regular
Dim Product Category    | Referenced         | No Relationship
Dim Date                | Regular            | No Relationship
Dim Promotion           | Many-to-Many       | Regular
Dim Store               | Regular            | No Relationship
Dim Sales Person        | Regular            | No Relationship
Dim Campaign            | Regular            | No Relationship
Dim Time                | Regular            | No Relationship
Dim Sales Invoice       | Fact               | No Relationship
```

**V√©rifications :**

- ‚úÖ Dim Product Category ‚Üí **Referenced** sur Fact Product Sales
- ‚úÖ Dim Promotion ‚Üí **Many-to-Many** sur Fact Product Sales
- ‚úÖ Dim Promotion ‚Üí **Regular** sur Fact Promotion Per Product
- ‚úÖ Dim Sales Invoice ‚Üí **Fact** sur Fact Product Sales

---

## R√âCAPITULATIF

### Regular (Type 1) ‚úÖ

- **Relation** : FK dans Fact ‚Üí PK dans Dimension
- **Usage** : Le plus courant (90% des cas)
- **Exemple** : FactProductSales.ProductSK ‚Üí DimProduct.ProductSK

### Fact (Type 2) üîë

- **Relation** : Colonne de la Fact = Dimension
- **Usage** : √âviter des tables de dimensions inutiles
- **Exemple** : SalesInvoiceNumber dans FactProductSales
- **Configuration SSDT** : Relationship type = Fact

### Referenced (Type 3) üîó

- **Relation** : Fact ‚Üí Dim 1 ‚Üí Dim 2 (Snowflake)
- **Usage** : Dimensions de 2√®me niveau
- **Exemple** : FactProductSales ‚Üí DimProduct ‚Üí DimProductCategory
- **Configuration SSDT** : Relationship type = Referenced, Intermediate dimension = DimProduct

### Many-to-Many (Type 4) üîÄ

- **Relation** : Fact ‚Üí Table liaison ‚Üê Dimension
- **Usage** : Relations complexes N-N
- **Exemple** : FactProductSales ‚Üí FactPromotionPerProduct ‚Üê DimPromotion
- **Configuration SSDT** : Relationship type = Many-to-Many, Intermediate measure group = FactPromotionPerProduct

### Factless Fact Table üìä

- **D√©finition** : Table de faits sans mesures num√©riques (juste Count)
- **Usage** : Tables de liaison pour Many-to-Many
- **Exemple** : FactPromotionPerProduct (PromotionSK, ProductSK)

---

## CHECKLIST FINALE

- [ ] Je sais identifier les 4 types de relations dans Dimension Usage
- [ ] Je sais cr√©er une dimension depuis une table de faits (Fact relationship)
- [ ] Je sais cr√©er une dimension Snowflake (Referenced relationship)
- [ ] Je sais configurer une relation Many-to-Many
- [ ] Je comprends ce qu'est un Factless Fact Table
- [ ] Je peux tester mes relations dans le Browser
- [ ] Je sais quand utiliser chaque type de relation

---

## EN CAS DE PROBL√àME

### Erreur "Cannot resolve the reference"

- V√©rifier que la dimension interm√©diaire est bien s√©lectionn√©e
- V√©rifier que les FK existent dans la base
- Refresh la DSV

### Valeurs vides dans le Browser

- V√©rifier que les donn√©es existent dans les tables
- Process Full sur le cube
- V√©rifier les relations dans Dimension Usage

### Many-to-Many ne fonctionne pas

- V√©rifier que l'Intermediate Measure Group est correct
- V√©rifier que FactPromotionPerProduct a des donn√©es
- V√©rifier les relations : Fact ‚Üê M2M Table ‚Üí Dimension
