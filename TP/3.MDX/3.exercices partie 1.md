# Atelier MDX - Exercices Pratiques

## Guide d'utilisation

### Structure des exercices

Chaque exercice contient :

-  **Objectif** : Ce que vous devez apprendre
-  **Ã‰noncÃ©** : La tÃ¢che Ã  accomplir
-  **Indice** : Un conseil si vous Ãªtes bloquÃ©
-  **Solution** : La requÃªte MDX correcte
-  **Explication** : Pourquoi cette solution fonctionne

### Comment utiliser ce document

1. Lisez l'Ã©noncÃ© de l'exercice
2. Essayez de le rÃ©soudre par vous-mÃªme dans SSMS
3. Si bloquÃ©, consultez l'indice
4. Comparez votre solution avec la solution proposÃ©e
5. Lisez l'explication pour comprendre les concepts

---

# PARTIE 1 : REQUÃŠTES DE BASE

## Exercice 1 : PremiÃ¨re requÃªte simple

### Objectif

Comprendre la structure de base d'une requÃªte MDX avec SELECT, ON, FROM.

### Ã‰noncÃ©

Affichez le montant total des ventes (Sales Amount) sans aucune dimension en ligne.

### Indice

Utilisez une syntaxe minimale : mesure ON COLUMNS, ensemble vide {} ON ROWS.

### Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  {} ON ROWS
FROM [Adventure Works]
```

### Explication

- `SELECT` : Mot-clÃ© pour dÃ©marrer la requÃªte
- `ON COLUMNS` (ou `ON 0`) : DÃ©finit l'axe des colonnes
- `ON ROWS` (ou `ON 1`) : DÃ©finit l'axe des lignes
- `FROM [Adventure Works]` : SpÃ©cifie le cube source
- `{}` : Ensemble vide pour les lignes (affiche juste le total)

---

## Exercice 2 : Afficher une dimension simple

### ğŸ“ Objectif

Apprendre Ã  afficher les membres d'une hiÃ©rarchie.

### ğŸ“ Ã‰noncÃ©

Affichez le montant des ventes pour toutes les annÃ©es calendaires.

### ğŸ’¡ Indice

Utilisez la hiÃ©rarchie `[Dim Date].[Calendar Hierarchy]` et la propriÃ©tÃ© `.MEMBERS`.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  [Dim Date].[Calendar Hierarchy].[Calendar Year].MEMBERS ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `[Dim Date].[Calendar Hierarchy]` : Chemin vers la hiÃ©rarchie
- `[Calendar Year]` : Niveau dans la hiÃ©rarchie
- `.MEMBERS` : Retourne tous les membres de ce niveau

---

## Exercice 3 : Plusieurs mesures

### ğŸ“ Objectif

Afficher plusieurs mesures simultanÃ©ment.

### ğŸ“ Ã‰noncÃ©

Affichez Ã  la fois le montant des ventes (Sales Amount) et la quantitÃ© commandÃ©e (Order Quantity) pour toutes les annÃ©es.

### ğŸ’¡ Indice

Placez plusieurs mesures dans un ensemble {...} sÃ©parÃ©es par des virgules.

### âœ… Solution

```mdx
SELECT
  {
    [Measures].[Sales Amount],
    [Measures].[Order Quantity]
  } ON COLUMNS,
  [Dim Date].[Calendar Hierarchy].[Calendar Year].MEMBERS ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- Les accolades `{ }` dÃ©finissent un ensemble (set)
- Plusieurs Ã©lÃ©ments dans un set sont sÃ©parÃ©s par des virgules
- Chaque mesure apparaÃ®tra dans une colonne distincte

---

## Exercice 4 : RÃ©fÃ©rencer un membre spÃ©cifique

### ğŸ“ Objectif

Apprendre Ã  rÃ©fÃ©rencer un membre prÃ©cis plutÃ´t que tous les membres.

### ğŸ“ Ã‰noncÃ©

Affichez le montant des ventes uniquement pour l'annÃ©e 2013.

### ğŸ’¡ Indice

Utilisez `&[2013]` ou `.[2013]` pour rÃ©fÃ©rencer l'annÃ©e spÃ©cifique.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013] ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `&[2013]` : Le symbole `&` fait rÃ©fÃ©rence Ã  la clÃ© (key) du membre
- Alternative : `.[2013]` fait rÃ©fÃ©rence au nom (name) du membre
- DiffÃ©rence : `&[key]` est plus fiable si les noms peuvent changer

---

## Exercice 5 : HiÃ©rarchie produit

### ğŸ“ Objectif

Naviguer dans une hiÃ©rarchie produit avec plusieurs niveaux.

### ğŸ“ Ã‰noncÃ©

Affichez le montant des ventes pour toutes les catÃ©gories de produits.

### ğŸ’¡ Indice

Utilisez `[Dim Product Category].[Product Category]` ou la hiÃ©rarchie produit.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  [Dim Product Category].[Product Category].MEMBERS ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `[Dim Product Category]` : Dimension des catÃ©gories
- `[Product Category]` : Niveau ou attribut dans cette dimension
- Affiche : Bikes, Accessories, Clothing, Components, etc.

---

## Exercice 6 : Utiliser WHERE pour filtrer

### ğŸ“ Objectif

Comprendre la diffÃ©rence entre les axes (ROWS/COLUMNS) et le filtre (WHERE).

### ğŸ“ Ã‰noncÃ©

Affichez le montant des ventes par catÃ©gorie de produits, mais uniquement pour l'annÃ©e 2013.

### ğŸ’¡ Indice

La clause WHERE filtre tout le rÃ©sultat sans crÃ©er un nouvel axe.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  [Dim Product Category].[Product Category].MEMBERS ON ROWS
FROM [Adventure Works]
WHERE [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013]
```

### ğŸ“Š Explication

- `WHERE` crÃ©e un "slicer" (trancheur) qui filtre toutes les donnÃ©es
- DiffÃ©rence avec ROWS/COLUMNS : WHERE ne crÃ©e pas de nouvelle dimension visible
- RÃ©sultat : Une seule annÃ©e, mais dÃ©composÃ©e par catÃ©gories

---

## Exercice 7 : CrossJoin simple (*)

### ğŸ“ Objectif

Combiner deux dimensions pour crÃ©er un produit cartÃ©sien.

### ğŸ“ Ã‰noncÃ©

Affichez le montant des ventes pour chaque combinaison de catÃ©gorie de produit et annÃ©e.

### ğŸ’¡ Indice

Utilisez l'opÃ©rateur `*` entre deux ensembles pour crÃ©er un CrossJoin.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  [Dim Product Category].[Product Category].MEMBERS
  *
  [Dim Date].[Calendar Hierarchy].[Calendar Year].MEMBERS
  ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `*` : OpÃ©rateur de CrossJoin (produit cartÃ©sien)
- CrÃ©e toutes les combinaisons possibles : (Bikes, 2010), (Bikes, 2011), etc.
- Alternative : fonction `CROSSJOIN()` avec mÃªme rÃ©sultat

---

## Exercice 8 : Plusieurs dimensions avec WHERE

### ğŸ“ Objectif

Utiliser plusieurs filtres dans la clause WHERE.

### ğŸ“ Ã‰noncÃ©

Affichez le montant des ventes par mois, uniquement pour l'annÃ©e 2013 et la catÃ©gorie "Bikes".

### ğŸ’¡ Indice

Dans WHERE, utilisez un tuple (parenthÃ¨ses) pour combiner plusieurs membres.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  [Dim Date].[Calendar Hierarchy].[Month].MEMBERS ON ROWS
FROM [Adventure Works]
WHERE (
  [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013],
  [Dim Product Category].[Product Category].&[Bikes]
)
```

### ğŸ“Š Explication

- Un tuple `( membre1, membre2 )` dÃ©finit un point prÃ©cis dans le cube
- WHERE accepte un tuple pour filtrer sur plusieurs dimensions
- RÃ©sultat : Seulement les ventes de vÃ©los en 2013, par mois

---

## Exercice 9 : Afficher membres sans donnÃ©es

### ğŸ“ Objectif

Comprendre la diffÃ©rence entre tous les membres et les membres avec donnÃ©es.

### ğŸ“ Ã‰noncÃ©

Affichez tous les clients (mÃªme ceux sans vente) avec une colonne vide.

### ğŸ’¡ Indice

Utilisez `{}` sur l'axe des colonnes pour crÃ©er une colonne vide.

### âœ… Solution

```mdx
SELECT
  {} ON COLUMNS,
  [Dim Customer].[Customer].MEMBERS ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `{}` : Ensemble vide qui crÃ©e une colonne sans donnÃ©e
- Utile pour voir la liste complÃ¨te des membres
- Tous les clients sont affichÃ©s, avec ou sans ventes

---

## Exercice 10 : NON EMPTY pour filtrer les nulls

### ğŸ“ Objectif

Ã‰liminer les lignes vides du rÃ©sultat.

### ğŸ“ Ã‰noncÃ©

Affichez le montant des ventes par client, mais seulement pour les clients qui ont effectivement achetÃ©.

### ğŸ’¡ Indice

Utilisez le mot-clÃ© `NON EMPTY` avant l'ensemble sur l'axe des lignes.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  NON EMPTY [Dim Customer].[Customer].MEMBERS ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `NON EMPTY` : OpÃ©rateur qui Ã©limine les tuples sans donnÃ©es
- AppliquÃ© au niveau de l'axe (trÃ¨s performant)
- RÃ©sultat : Seulement les clients avec au moins une vente

---

## Exercice 11 : Utiliser Properties()

### ğŸ“ Objectif

Afficher des propriÃ©tÃ©s supplÃ©mentaires des membres.

### ğŸ“ Ã‰noncÃ©

Affichez le montant des ventes par produit avec la couleur du produit.

### ğŸ’¡ Indice

CrÃ©ez une mesure calculÃ©e avec `Properties("Color")`.

### âœ… Solution

```mdx
WITH MEMBER [Measures].[Product Color] AS
  [Dim Product].[Product].CurrentMember.Properties("Color")

SELECT
  {
    [Measures].[Sales Amount],
    [Measures].[Product Color]
  } ON COLUMNS,
  NON EMPTY [Dim Product].[Product].MEMBERS ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `WITH MEMBER` : CrÃ©e un membre calculÃ© temporaire
- `CurrentMember` : Fait rÃ©fÃ©rence au membre actuel de l'Ã©valuation
- `.Properties("Color")` : AccÃ¨de Ã  la propriÃ©tÃ© "Color" du produit
- La couleur s'affiche comme une "mesure" supplÃ©mentaire

---

## Exercice 12 : Filter() avec condition simple

### ğŸ“ Objectif

Filtrer des membres selon une condition sur une mesure.

### ğŸ“ Ã‰noncÃ©

Affichez seulement les annÃ©es oÃ¹ le montant des ventes dÃ©passe 10 millions.

### ğŸ’¡ Indice

Utilisez `Filter(ensemble, condition)` avec une comparaison sur [Measures].[Sales Amount].

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  Filter(
    [Dim Date].[Calendar Hierarchy].[Calendar Year].MEMBERS,
    [Measures].[Sales Amount] > 10000000
  ) ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `Filter(set, condition)` : Fonction qui filtre un ensemble
- Premier paramÃ¨tre : l'ensemble Ã  filtrer
- DeuxiÃ¨me paramÃ¨tre : condition boolÃ©enne
- Seules les annÃ©es avec ventes > 10M sont retournÃ©es

---

## Exercice 13 : TopCount()

### ğŸ“ Objectif

SÃ©lectionner les N meilleurs Ã©lÃ©ments selon une mesure.

### ğŸ“ Ã‰noncÃ©

Affichez les 5 produits avec le montant de ventes le plus Ã©levÃ©.

### ğŸ’¡ Indice

Utilisez `TopCount(ensemble, nombre, mesure)`.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  TopCount(
    [Dim Product].[Product].MEMBERS,
    5,
    [Measures].[Sales Amount]
  ) ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `TopCount(set, n, measure)` : Retourne les n premiers Ã©lÃ©ments
- Tri automatique selon la mesure spÃ©cifiÃ©e (ordre dÃ©croissant)
- Alternative : `BottomCount()` pour les N derniers

---

## Exercice 14 : Order() pour trier

### ğŸ“ Objectif

Trier explicitement un ensemble selon un critÃ¨re.

### ğŸ“ Ã‰noncÃ©

Affichez toutes les catÃ©gories de produits triÃ©es par montant de ventes dÃ©croissant.

### ğŸ’¡ Indice

Utilisez `Order(ensemble, expression, DESC/ASC)`.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  Order(
    [Dim Product Category].[Product Category].MEMBERS,
    [Measures].[Sales Amount],
    DESC
  ) ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `Order(set, sort_expression, flag)` : Trie un ensemble
- `DESC` : Ordre dÃ©croissant (du plus grand au plus petit)
- `ASC` ou `BASC` : Ordre croissant
- `BDESC` : Ordre dÃ©croissant (break hierarchy)

---

## Exercice 15 : Membres calculÃ©s simples (WITH MEMBER)

### ğŸ“ Objectif

CrÃ©er une mesure calculÃ©e temporaire.

### ğŸ“ Ã‰noncÃ©

CrÃ©ez une mesure "Profit" qui calcule : Sales Amount - Total Product Cost.

### ğŸ’¡ Indice

Utilisez `WITH MEMBER [Measures].[nom] AS expression` avant SELECT.

### âœ… Solution

```mdx
WITH MEMBER [Measures].[Profit] AS
  [Measures].[Sales Amount] - [Measures].[Total Product Cost]

SELECT
  {
    [Measures].[Sales Amount],
    [Measures].[Total Product Cost],
    [Measures].[Profit]
  } ON COLUMNS,
  [Dim Date].[Calendar Hierarchy].[Calendar Year].MEMBERS ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `WITH MEMBER` : DÃ©finit un membre temporaire (existe uniquement dans cette requÃªte)
- Syntaxe : `[Dimension].[Hierarchy].[Nom] AS expression`
- Expression : Peut utiliser opÃ©rateurs arithmÃ©tiques (+, -, *, /)
- Le membre calculÃ© se comporte comme une mesure standard

---

## ğŸ“ RÃ©sumÃ© - Partie 1

Vous avez appris :

-  Structure de base d'une requÃªte MDX (SELECT/FROM)
-  Utiliser ON COLUMNS et ON ROWS
-  RÃ©fÃ©rencer des membres (.MEMBERS, &[key])
-  Filtrer avec WHERE (slicer)
-  Combiner dimensions avec * (CrossJoin)
-  Ã‰liminer les valeurs vides (NON EMPTY)
-  Filtrer avec Filter()
-  SÃ©lectionner Top N avec TopCount()
-  Trier avec Order()
-  CrÃ©er des mesures calculÃ©es (WITH MEMBER)


