# Atelier MDX - Exercices Pratiques (Partie 2)

# PARTIE 2 : NAVIGATION DANS LES HIÃ‰RARCHIES

## Exercice 16 : Parent

### ğŸ“ Objectif

Naviguer vers le membre parent dans une hiÃ©rarchie.

### ğŸ“ Ã‰noncÃ©

Affichez le montant des ventes pour le premier trimestre 2013 et pour son parent (l'annÃ©e 2013).

### ğŸ’¡ Indice

Utilisez `.Parent` pour accÃ©der au membre parent.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  {
    [Dim Date].[Calendar Hierarchy].[Calendar Quarter].&[2013]&[1],
    [Dim Date].[Calendar Hierarchy].[Calendar Quarter].&[2013]&[1].Parent
  } ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `.Parent` : PropriÃ©tÃ© qui retourne le membre parent immÃ©diat
- Dans une hiÃ©rarchie Year â†’ Quarter : le parent d'un Quarter est le Year
- Utile pour comparaisons hiÃ©rarchiques (partie vs total)

---

## Exercice 17 : Children

### ğŸ“ Objectif

Obtenir tous les enfants d'un membre.

### ğŸ“ Ã‰noncÃ©

Affichez tous les trimestres de l'annÃ©e 2013.

### ğŸ’¡ Indice

Utilisez `.Children` sur le membre annÃ©e.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013].Children ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `.Children` : Retourne tous les membres enfants directs
- Pour 2013 : retourne Q1, Q2, Q3, Q4
- Alternative : `.Members` retourne tous les membres du niveau

---

## Exercice 18 : FirstChild et LastChild

### ğŸ“ Objectif

AccÃ©der au premier ou dernier enfant d'un membre.

### ğŸ“ Ã‰noncÃ©

Affichez le montant des ventes pour le premier et le dernier mois de l'annÃ©e 2013.

### ğŸ’¡ Indice

Utilisez `.FirstChild` et `.LastChild` en descendant les niveaux.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  {
    [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013].FirstChild.FirstChild,
    [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013].LastChild.LastChild
  } ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `.FirstChild` : Premier enfant (Q1, puis Janvier si on descend encore)
- `.LastChild` : Dernier enfant (Q4, puis DÃ©cembre)
- ChaÃ®nage possible : `.FirstChild.FirstChild` descend de 2 niveaux

---

## Exercice 19 : PrevMember et NextMember

### ğŸ“ Objectif

Naviguer horizontalement dans une hiÃ©rarchie (mÃªme niveau).

### ğŸ“ Ã‰noncÃ©

Affichez le montant des ventes pour fÃ©vrier 2013, ainsi que le mois prÃ©cÃ©dent et le mois suivant.

### ğŸ’¡ Indice

Utilisez `.PrevMember` et `.NextMember`.

### âœ… Solution

```mdx
WITH MEMBER [Dim Date].[Calendar Hierarchy].[Feb2013] AS
  [Dim Date].[Calendar Hierarchy].[Month].&[2013]&[2]

SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  {
    [Feb2013].PrevMember,
    [Feb2013],
    [Feb2013].NextMember
  } ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `.PrevMember` : Membre prÃ©cÃ©dent au mÃªme niveau
- `.NextMember` : Membre suivant au mÃªme niveau
- Utile pour comparaisons de pÃ©riodes consÃ©cutives

---

## Exercice 20 : Lag() et Lead()

### ğŸ“ Objectif

Naviguer de N positions en arriÃ¨re ou en avant.

### ğŸ“ Ã‰noncÃ©

Affichez le montant des ventes pour l'annÃ©e 2013, ainsi que 2 ans avant et 1 an aprÃ¨s.

### ğŸ’¡ Indice

Utilisez `.Lag(n)` et `.Lead(n)`.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  {
    [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013].Lag(2),
    [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013],
    [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013].Lead(1)
  } ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `.Lag(n)` : Recule de n positions (n=2 : 2011)
- `.Lead(n)` : Avance de n positions (n=1 : 2014)
- Plus flexible que PrevMember/NextMember pour sauts multiples

---

## Exercice 21 : Descendants()

### ğŸ“ Objectif

Obtenir tous les descendants d'un membre Ã  un niveau spÃ©cifique.

### ğŸ“ Ã‰noncÃ©

Affichez tous les mois de l'annÃ©e 2013.

### ğŸ’¡ Indice

Utilisez `Descendants(membre, niveau)`.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  Descendants(
    [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013],
    [Dim Date].[Calendar Hierarchy].[Month]
  ) ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `Descendants(member, level)` : Tous les descendants Ã  ce niveau
- Plus puissant que `.Children` qui ne descend que d'un niveau
- RÃ©sultat : Janvier 2013, FÃ©vrier 2013, ..., DÃ©cembre 2013

---

## Exercice 22 : Hierarchize()

### ğŸ“ Objectif

Organiser un ensemble selon l'ordre hiÃ©rarchique naturel.

### ğŸ“ Ã‰noncÃ©

Affichez tous les membres de la hiÃ©rarchie Calendar pour 2013 dans l'ordre hiÃ©rarchique.

### ğŸ’¡ Indice

Utilisez `Hierarchize(ensemble)` avec Descendants.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  Hierarchize(
    Descendants(
      [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013],
      [Dim Date].[Calendar Hierarchy].[Month]
    )
  ) ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `Hierarchize()` : Trie selon la structure hiÃ©rarchique
- Affiche : 2013 â†’ Q1 â†’ Janvier, FÃ©vrier, Mars â†’ Q2 â†’ ...
- Maintient la structure parent-enfant visuelle

---

## Exercice 23 : Ancestor()

### ğŸ“ Objectif

Remonter Ã  un ancÃªtre spÃ©cifique dans la hiÃ©rarchie.

### ğŸ“ Ã‰noncÃ©

Pour le mois de mars 2013, affichez son annÃ©e parente.

### ğŸ’¡ Indice

Utilisez `Ancestor(membre, niveau)`.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  {
    [Dim Date].[Calendar Hierarchy].[Month].&[2013]&[3],
    Ancestor(
      [Dim Date].[Calendar Hierarchy].[Month].&[2013]&[3],
      [Dim Date].[Calendar Hierarchy].[Calendar Year]
    )
  } ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `Ancestor(member, level)` : Remonte au niveau spÃ©cifiÃ©
- Plus prÃ©cis que `.Parent` qui remonte d'un seul niveau
- Utile pour remonter plusieurs niveaux en une fois

---

## Exercice 24 : DrilldownMember()

### ğŸ“ Objectif

DÃ©velopper (drill-down) des membres spÃ©cifiques dans un ensemble.

### ğŸ“ Ã‰noncÃ©

Affichez toutes les annÃ©es, mais dÃ©veloppez seulement l'annÃ©e 2013 pour voir ses trimestres.

### ğŸ’¡ Indice

Utilisez `DrilldownMember(set1, set2)`.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  DrilldownMember(
    [Dim Date].[Calendar Hierarchy].[Calendar Year].MEMBERS,
    {[Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013]}
  ) ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `DrilldownMember(set, members_to_drill)` : DÃ©veloppe seulement certains membres
- Premier paramÃ¨tre : ensemble initial
- DeuxiÃ¨me paramÃ¨tre : membres Ã  dÃ©velopper
- RÃ©sultat : 2010, 2011, 2012, 2013, Q1 2013, Q2 2013, Q3 2013, Q4 2013, 2014...

---

## Exercice 25 : Siblings

### ğŸ“ Objectif

Obtenir tous les frÃ¨res/sÅ“urs d'un membre (mÃªme parent).

### ğŸ“ Ã‰noncÃ©

Affichez tous les trimestres de l'annÃ©e qui contient Q2 2013.

### ğŸ’¡ Indice

Utilisez `.Siblings` sur le membre Q2 2013.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  [Dim Date].[Calendar Hierarchy].[Calendar Quarter].&[2013]&[2].Siblings ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `.Siblings` : Retourne tous les membres ayant le mÃªme parent
- Inclut le membre lui-mÃªme dans le rÃ©sultat
- RÃ©sultat : Q1 2013, Q2 2013, Q3 2013, Q4 2013

---

# PARTIE 3 : FONCTIONS SET AVANCÃ‰ES

## Exercice 26 : Union()

### ğŸ“ Objectif

Combiner deux ensembles en un seul.

### ğŸ“ Ã‰noncÃ©

Affichez les ventes pour les annÃ©es 2012 et 2013, plus tous les mois de janvier (toutes annÃ©es confondues).

### ğŸ’¡ Indice

Utilisez `Union(set1, set2)`.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  Union(
    {
      [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2012],
      [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013]
    },
    Filter(
      [Dim Date].[Calendar Hierarchy].[Month].MEMBERS,
      [Dim Date].[Calendar Hierarchy].CurrentMember.Name = "January"
    )
  ) ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `Union(set1, set2)` : Combine deux ensembles
- Par dÃ©faut, Ã©limine les doublons
- `Union(set1, set2, ALL)` : Conserve les doublons

---

## Exercice 27 : Intersect()

### ğŸ“ Objectif

Trouver les Ã©lÃ©ments communs entre deux ensembles.

### ğŸ“ Ã‰noncÃ©

Trouvez les produits qui appartiennent Ã  la fois aux catÃ©gories Bikes et qui ont des ventes supÃ©rieures Ã  500,000.

### ğŸ’¡ Indice

Utilisez `Intersect(set1, set2)` avec Filter.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  Intersect(
    Filter(
      [Dim Product].[Product].MEMBERS,
      [Measures].[Sales Amount] > 500000
    ),
    Descendants(
      [Dim Product Category].[Product Category].&[Bikes],
      [Dim Product].[Product]
    )
  ) ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `Intersect(set1, set2)` : Retourne seulement les Ã©lÃ©ments prÃ©sents dans les deux sets
- Utile pour combiner plusieurs critÃ¨res de filtrage
- RÃ©sultat : Seulement les bikes avec ventes > 500K

---

## Exercice 28 : Except()

### ğŸ“ Objectif

Exclure certains Ã©lÃ©ments d'un ensemble.

### ğŸ“ Ã‰noncÃ©

Affichez toutes les catÃ©gories de produits sauf "Accessories".

### ğŸ’¡ Indice

Utilisez `Except(set1, set2)`.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  Except(
    [Dim Product Category].[Product Category].MEMBERS,
    {[Dim Product Category].[Product Category].&[Accessories]}
  ) ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `Except(set1, set2)` : Retourne les Ã©lÃ©ments de set1 absents de set2
- Ã‰quivalent Ã  "set1 MINUS set2"
- RÃ©sultat : Bikes, Clothing, Components (pas Accessories)

---

## Exercice 29 : Distinct()

### ğŸ“ Objectif

Ã‰liminer les doublons d'un ensemble.

### ğŸ“ Ã‰noncÃ©

CrÃ©ez un ensemble contenant deux fois l'annÃ©e 2013, puis Ã©liminez le doublon.

### ğŸ’¡ Indice

Utilisez `Distinct(ensemble)`.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  Distinct(
    {
      [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013],
      [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2012],
      [Dim Date].[Calendar Hierarchy].[Calendar Year].&[2013]
    }
  ) ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `Distinct(set)` : Ã‰limine les membres dupliquÃ©s
- PrÃ©serve l'ordre de la premiÃ¨re occurrence
- RÃ©sultat : 2013, 2012 (pas de deuxiÃ¨me 2013)

---

## Exercice 30 : Generate()

### ğŸ“ Objectif

GÃ©nÃ©rer un ensemble en appliquant une expression Ã  chaque membre d'un autre ensemble.

### ğŸ“ Ã‰noncÃ©

Pour chaque annÃ©e, affichez son premier trimestre.

### ğŸ’¡ Indice

Utilisez `Generate(set, expression)`.

### âœ… Solution

```mdx
SELECT
  [Measures].[Sales Amount] ON COLUMNS,
  Generate(
    [Dim Date].[Calendar Hierarchy].[Calendar Year].MEMBERS,
    {[Dim Date].[Calendar Hierarchy].CurrentMember.FirstChild}
  ) ON ROWS
FROM [Adventure Works]
```

### ğŸ“Š Explication

- `Generate(set, expression)` : Applique l'expression Ã  chaque membre du set
- `CurrentMember` : RÃ©fÃ©rence le membre en cours d'itÃ©ration
- RÃ©sultat : Q1 2010, Q1 2011, Q1 2012, Q1 2013, Q1 2014

---

## ğŸ“ RÃ©sumÃ© - Partie 2

Vous avez appris :

- âœ… Navigation verticale (.Parent, .Children, Descendants, Ancestor)
- âœ… Navigation horizontale (.PrevMember, .NextMember, .Lag, .Lead)
- âœ… Navigation latÃ©rale (.Siblings)
- âœ… Organisation hiÃ©rarchique (Hierarchize, DrilldownMember)
- âœ… OpÃ©rations sur ensembles (Union, Intersect, Except, Distinct)
- âœ… GÃ©nÃ©ration dynamique (Generate)


